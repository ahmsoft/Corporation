(function(b,a){a(["./kendo.dom","./kendo.touch","./kendo.draganddrop","./kendo.columnsorter","./kendo.datetimepicker","./kendo.editable"],b);
})(function(){(function(){(function(a){var j=window.kendo;
var k=j.dom;
var l=k.element;
var m=k.text;
var c=j.support.browser;
var q=j.support.mobileOS;
var w=j.ui;
var x=w.Widget;
var g=a.extend;
var p=a.map;
var i=a.isFunction;
var s=c.msie&&c.version<9;
var n=j.keys;
var v={title:"Title",start:"Start Time",end:"End Time",percentComplete:"% Done",parentId:"Predecessor ID",id:"ID",orderId:"Order ID"};
var u="string";
var r=".kendoGanttList";
var d="click";
var f=".";
var t="<table style='visibility: hidden;'><tbody><tr style='height:{0}'><td>&nbsp;</td></tr></tbody></table>";
var o={wrapper:"k-treelist k-grid k-widget",header:"k-header",alt:"k-alt",editCell:"k-edit-cell",group:"k-treelist-group",gridHeader:"k-grid-header",gridHeaderWrap:"k-grid-header-wrap",gridContent:"k-grid-content",gridContentWrap:"k-grid-content",selected:"k-state-selected",icon:"k-icon",iconCollapse:"k-i-collapse",iconExpand:"k-i-expand",iconHidden:"k-i-none",iconPlaceHolder:"k-icon k-i-none",input:"k-input",link:"k-link",resizeHandle:"k-resize-handle",resizeHandleInner:"k-resize-handle-inner",dropPositions:"k-insert-top k-insert-bottom k-add k-insert-middle",dropTop:"k-insert-top",dropBottom:"k-insert-bottom",dropAdd:"k-add",dropMiddle:"k-insert-middle",dropDenied:"k-denied",dragStatus:"k-drag-status",dragClue:"k-drag-clue",dragClueText:"k-clue-text"};
function e(B){var C=[];
var y=B.className;
for(var z=0,A=B.level;
z<A;
z++){C.push(l("span",{className:y}));
}return C;
}function b(){var y=j._activeElement();
if(y.nodeName.toLowerCase()!=="body"){a(y).blur();
}}var h=w.GanttList=x.extend({init:function(y,z){x.fn.init.call(this,y,z);
if(this.options.columns.length===0){this.options.columns.push("title");
}this.dataSource=this.options.dataSource;
this._columns();
this._layout();
this._domTrees();
this._header();
this._sortable();
this._editable();
this._selectable();
this._draggable();
this._resizable();
this._attachEvents();
this._adjustHeight();
this.bind("render",function(){var A;
var B;
if(this.options.resizable){A=this.header.find("col");
B=this.content.find("col");
this.header.find("th").not(":last").each(function(C){var D=a(this).outerWidth();
A.eq(C).width(D);
B.eq(C).width(D);
});
A.last().css("width","auto");
B.last().css("width","auto");
}},true);
},_adjustHeight:function(){this.content.height(this.element.height()-this.header.parent().outerHeight());
},destroy:function(){x.fn.destroy.call(this);
if(this._reorderDraggable){this._reorderDraggable.destroy();
}if(this._tableDropArea){this._tableDropArea.destroy();
}if(this._contentDropArea){this._contentDropArea.destroy();
}if(this._columnResizable){this._columnResizable.destroy();
}if(this.touch){this.touch.destroy();
}if(this.timer){clearTimeout(this.timer);
}this.content.off(r);
this.header.find("thead").off(r);
this.header.find(f+h.link).off(r);
this.header=null;
this.content=null;
this.levels=null;
j.destroy(this.element);
},options:{name:"GanttList",selectable:true,editable:true,resizable:false},_attachEvents:function(){var z=this;
var y=h.styles;
z.content.on(d+r,"td > span."+y.icon+":not(."+y.iconHidden+")",function(A){var B=a(this);
var C=z._modelFromElement(B);
C.set("expanded",!C.get("expanded"));
A.stopPropagation();
});
},_domTrees:function(){this.headerTree=new k.Tree(this.header[0]);
this.contentTree=new k.Tree(this.content[0]);
},_columns:function(){var y=this.options.columns;
var z=function(){this.field="";
this.title="";
this.editable=false;
this.sortable=false;
};
this.columns=p(y,function(A){A=typeof A===u?{field:A,title:v[A]}:A;
return g(new z(),A);
});
},_layout:function(){var C=this;
var B=this.options;
var z=this.element;
var A=h.styles;
var y=function(){var E=typeof B.rowHeight===u?B.rowHeight:B.rowHeight+"px";
var F=a(j.format(t,E));
var D;
C.content.append(F);
D=F.find("tr").outerHeight();
F.remove();
return D;
};
z.addClass(A.wrapper).append("<div class='"+A.gridHeader+"'><div class='"+A.gridHeaderWrap+"'></div></div>").append("<div class='"+A.gridContentWrap+"'></div>");
this.header=z.find(f+A.gridHeaderWrap);
this.content=z.find(f+A.gridContent);
if(B.rowHeight){this._rowHeight=y();
}},_header:function(){var z=this.headerTree;
var y;
var B;
var A;
y=l("colgroup",null,this._cols());
B=l("thead",{role:"rowgroup"},[l("tr",{role:"row"},this._ths())]);
A=l("table",{style:{minWidth:this.options.listWidth+"px"},role:"grid"},[y,B]);
z.render([A]);
},_render:function(B){var y;
var C;
var z;
var A={style:{minWidth:this.options.listWidth+"px"},tabIndex:0,role:"treegrid"};
if(this._rowHeight){A.style.height=(B.length*this._rowHeight)+"px";
}this.levels=[{field:null,value:0}];
y=l("colgroup",null,this._cols());
C=l("tbody",{role:"rowgroup"},this._trs(B));
z=l("table",A,[y,C]);
this.contentTree.render([z]);
this.trigger("render");
},_ths:function(){var A=this.columns;
var z;
var y;
var D=[];
for(var B=0,C=A.length;
B<C;
B++){z=A[B];
y={"data-field":z.field,"data-title":z.title,className:h.styles.header,role:"columnheader"};
D.push(l("th",y,[m(z.title)]));
}if(this.options.resizable){D.push(l("th",{className:h.styles.header,role:"columnheader"}));
}return D;
},_cols:function(){var A=this.columns;
var z;
var D;
var E;
var y=[];
for(var B=0,C=A.length;
B<C;
B++){z=A[B];
E=z.width;
if(E&&parseInt(E,10)!==0){D={style:{width:typeof E===u?E:E+"px"}};
}else{D=null;
}y.push(l("col",D,[]));
}if(this.options.resizable){y.push(l("col",{style:{width:"1px"}}));
}return y;
},_trs:function(G){var F;
var E=[];
var y;
var z=[];
var C;
var D=h.styles;
for(var A=0,B=G.length;
A<B;
A++){F=G[A];
C=this._levels({idx:F.parentId,id:F.id,summary:F.summary});
y={"data-uid":F.uid,"data-level":C,role:"row"};
if(F.summary){y["aria-expanded"]=F.expanded;
}if(A%2!==0){z.push(D.alt);
}if(F.summary){z.push(D.group);
}if(z.length){y.className=z.join(" ");
}E.push(this._tds({task:F,attr:y,level:C}));
z=[];
}return E;
},_tds:function(D){var y=[];
var A=this.columns;
var z;
for(var B=0,C=A.length;
B<C;
B++){z=A[B];
y.push(this._td({task:D.task,column:z,level:D.level}));
}if(this.options.resizable){y.push(l("td",{role:"gridcell"}));
}return l("tr",D.attr,y);
},_td:function(E){var y=[];
var F=this.options.resourcesField;
var D=h.styles;
var G=E.task;
var z=E.column;
var H=G.get(z.field)||[];
var A;
var C;
if(z.field==F){A=[];
for(var B=0;
B<H.length;
B++){A.push(j.format("{0} [{1}]",H[B].get("name"),H[B].get("formatedValue")));
}A=A.join(", ");
}else{A=z.format?j.format(z.format,H):H;
}if(z.field==="title"){y=e({level:E.level,className:D.iconPlaceHolder});
y.push(l("span",{className:D.icon+" "+(G.summary?(G.expanded?D.iconCollapse:D.iconExpand):D.iconHidden)}));
C=j.format("{0}, {1:P0}",A,G.percentComplete);
}y.push(l("span",{"aria-label":C},[m(A)]));
return l("td",{role:"gridcell"},y);
},_levels:function(E){var D=this.levels;
var C;
var F=E.summary;
var A=E.idx;
var z=E.id;
for(var y=0,B=D.length;
y<B;
y++){C=D[y];
if(C.field==A){if(F){D.push({field:z,value:C.value+1});
}return C.value;
}}},_sortable:function(){var H=this;
var F=this.options.resourcesField;
var B=this.columns;
var A;
var G;
var z=this.header.find("th["+j.attr("field")+"]");
var C=function(I){if(H.editable&&H.editable.trigger("validate")){I.preventDefault();
I.stopImmediatePropagation();
}};
var y;
for(var D=0,E=z.length;
D<E;
D++){A=B[D];
if(A.sortable&&A.field!==F){y=z.eq(D);
G=y.data("kendoColumnSorter");
if(G){G.destroy();
}y.attr("data-"+j.ns+"field",A.field).kendoColumnSorter({dataSource:this.dataSource}).find(f+h.link).on("click"+r,C);
}}z=null;
},_selectable:function(){var z=this;
var y=this.options.selectable;
if(y){this.content.on(d+r,"tr",function(A){var B=a(this);
if(z.editable){z.editable.trigger("validate");
}if(!A.ctrlKey){z.select(B);
}else{z.clearSelection();
}});
}},select:function(A){var y=this.content.find(A);
var z=h.styles.selected;
if(y.length){y.siblings(f+z).removeClass(z).attr("aria-selected",false).end().addClass(z).attr("aria-selected",true);
this.trigger("change");
return;
}return this.content.find(f+z);
},clearSelection:function(){var y=this.select();
if(y.length){y.removeClass(h.styles.selected);
this.trigger("change");
}},_setDataSource:function(y){this.dataSource=y;
},_editable:function(){var C=this;
var A=h.styles;
var z="span."+A.icon+":not("+A.iconHidden+")";
var y=function(){var D=C.editable;
if(D){if(D.end()){C._closeCell();
}else{D.trigger("validate");
}}};
var B=function(E){var D=a(E.currentTarget);
if(!D.hasClass(A.editCell)){b();
}};
if(!this.options.editable){return;
}this._startEditHandler=function(E){var F=E.currentTarget?a(E.currentTarget):E;
var D=C._columnFromElement(F);
if(C.editable){return;
}if(D&&D.editable){C._editCell({cell:F,column:D});
}};
C.content.on("focusin"+r,function(){clearTimeout(C.timer);
C.timer=null;
}).on("focusout"+r,function(){C.timer=setTimeout(y,1);
}).on("keydown"+r,function(D){if(D.keyCode===n.ENTER){D.preventDefault();
}}).on("keyup"+r,function(E){var F=E.keyCode;
var D;
var G;
switch(F){case n.ENTER:b();
y();
break;
case n.ESC:if(C.editable){D=C._editableContainer;
G=C._modelFromElement(D);
if(!C.trigger("cancel",{model:G,cell:D})){C._closeCell(true);
}}break;
}});
if(!q){C.content.on("mousedown"+r,"td",function(D){B(D);
}).on("dblclick"+r,"td",function(D){if(!a(D.target).is(z)){C._startEditHandler(D);
}});
}else{C.touch=C.content.kendoTouch({filter:"td",touchstart:function(D){B(D.touch);
},doubletap:function(D){if(!a(D.touch.initialTouch).is(z)){C._startEditHandler(D.touch);
}}}).data("kendoTouch");
}},_editCell:function(J){var K=this.options.resourcesField;
var G=h.styles;
var A=J.cell;
var B=J.column;
var H=this._modelFromElement(A);
var I=this.dataSource._createNewModel(H.toJSON());
var E=I.fields[B.field]||I[B.field];
var L=E.validation;
var C=j.attr("type");
var z=j.attr("bind");
var F=j.attr("format");
var y={name:B.field,required:E.validation?E.validation.required===true:false};
var D;
if(B.field===K){B.editor(A,I);
return;
}this._editableContent=A.children().detach();
this._editableContainer=A;
A.data("modelCopy",I);
if((E.type==="date"||a.type(E)==="date")&&(!B.format||/H|m|s|F|g|u/.test(B.format))){y[z]="value:"+B.field;
y[C]="date";
if(B.format){y[F]=j._extractFormat(B.format);
}D=function(M,N){a('<input type="text"/>').attr(y).appendTo(M).kendoDateTimePicker({format:N.format});
};
}this.editable=A.addClass(G.editCell).kendoEditable({fields:{field:B.field,format:B.format,editor:B.editor||D},model:I,clearContainer:false}).data("kendoEditable");
if(L&&L.dateCompare&&i(L.dateCompare)&&L.message){a("<span "+j.attr("for")+'="'+B.field+'" class="k-invalid-msg"/>').hide().appendTo(A);
A.find("[name="+B.field+"]").attr(j.attr("dateCompare-msg"),L.message);
}if(this.trigger("edit",{model:H,cell:A})){this._closeCell(true);
}this.editable.bind("validate",function(M){var N=this.element.find(":kendoFocusable:first").focus();
if(s){N.focus();
}M.preventDefault();
});
},_closeCell:function(y){var D=h.styles;
var z=this._editableContainer;
var E=this._modelFromElement(z);
var A=this._columnFromElement(z);
var C=A.field;
var B=z.data("modelCopy");
var F={};
F[C]=B.get(C);
z.empty().removeData("modelCopy").removeClass(D.editCell).append(this._editableContent);
this.editable.unbind();
this.editable.destroy();
this.editable=null;
this._editableContainer=null;
this._editableContent=null;
if(!y){if(C==="start"){F.end=new Date(F.start.getTime()+E.duration());
}this.trigger("update",{task:E,updateInfo:F});
}},_draggable:function(){var J=this;
var D=null;
var E=true;
var F;
var G=h.styles;
var H="tr["+j.attr("level")+" = 0]:last";
var y={};
var A=function(){D=null;
F=null;
E=true;
y={};
};
var z=function(L){var K=L;
while(K){if(D.get("id")===K.get("id")){E=false;
break;
}K=J.dataSource.taskParent(K);
}};
var C=function(){var K=a(F).height();
var L=j.getOffset(F).top;
g(F,{beforeLimit:L+K*0.25,afterLimit:L+K*0.75});
};
var B=function(M){var O=M.location;
var K=G.dropAdd;
var L="add";
var N=parseInt(F.attr(j.attr("level")),10);
var P;
if(O<=F.beforeLimit){P=F.prev();
K=G.dropTop;
L="insert-before";
}else{if(O>=F.afterLimit){P=F.next();
K=G.dropBottom;
L="insert-after";
}}if(P&&parseInt(P.attr(j.attr("level")),10)===N){K=G.dropMiddle;
}y.className=K;
y.command=L;
};
var I=function(){return J._reorderDraggable.hint.children(f+G.dragStatus).removeClass(G.dropPositions);
};
if(!this.options.editable){return;
}this._reorderDraggable=this.content.kendoDraggable({distance:10,holdToDrag:q,group:"listGroup",filter:"tr[data-uid]",ignore:f+G.input,hint:function(K){return a('<div class="'+G.header+" "+G.dragClue+'"/>').css({width:300,paddingLeft:K.css("paddingLeft"),paddingRight:K.css("paddingRight"),lineHeight:K.height()+"px",paddingTop:K.css("paddingTop"),paddingBottom:K.css("paddingBottom")}).append('<span class="'+G.icon+" "+G.dragStatus+'" /><span class="'+G.dragClueText+'"/>');
},cursorOffset:{top:-20,left:0},container:this.content,dragstart:function(K){if(J.editable&&J.editable.trigger("validate")){K.preventDefault();
return;
}D=J._modelFromElement(K.currentTarget);
this.hint.children(f+G.dragClueText).text(D.get("title"));
},drag:function(K){if(E){B(K.y);
I().addClass(y.className);
}},dragend:function(){A();
},dragcancel:function(){A();
}}).data("kendoDraggable");
this._tableDropArea=this.content.kendoDropTargetArea({distance:0,group:"listGroup",filter:"tr[data-uid]",dragenter:function(K){F=K.dropTarget;
z(J._modelFromElement(F));
C();
I().toggleClass(G.dropDenied,!E);
},dragleave:function(){E=true;
I();
},drop:function(){var L=J._modelFromElement(F);
var K=L.orderId;
var M={parentId:L.parentId};
if(E){switch(y.command){case"add":M.parentId=L.id;
break;
case"insert-before":if(L.parentId===D.parentId&&L.orderId>D.orderId){M.orderId=K-1;
}else{M.orderId=K;
}break;
case"insert-after":if(L.parentId===D.parentId&&L.orderId>D.orderId){M.orderId=K;
}else{M.orderId=K+1;
}break;
}J.trigger("update",{task:D,updateInfo:M});
}}}).data("kendoDropTargetArea");
this._contentDropArea=this.element.kendoDropTargetArea({distance:0,group:"listGroup",filter:f+G.gridContent,drop:function(){var L=J._modelFromElement(J.content.find(H));
var K=L.orderId;
var M={parentId:null,orderId:D.parentId!==null?K+1:K};
J.trigger("update",{task:D,updateInfo:M});
}}).data("kendoDropTargetArea");
},_resizable:function(){var A=this;
var y=h.styles;
var z=function(F){var L=a(F.currentTarget);
var J=A.resizeHandle;
var I=L.position();
var H=I.left;
var C=L.outerWidth();
var E=L.closest("div");
var D=F.clientX+a(window).scrollLeft();
var G=A.options.columnResizeHandleWidth;
H+=E.scrollLeft();
if(!J){J=A.resizeHandle=a('<div class="'+y.resizeHandle+'"><div class="'+y.resizeHandleInner+'" /></div>');
}var B=L.offset().left+C;
var K=D>B-G&&D<B+G;
if(!K){J.hide();
return;
}E.append(J);
J.show().css({top:I.top,left:H+C-G-1,height:L.outerHeight(),width:G*3}).data("th",L);
};
if(!this.options.resizable){return;
}if(this._columnResizable){this._columnResizable.destroy();
}this.header.find("thead").on("mousemove"+r,"th",z);
this._columnResizable=this.header.kendoResizable({handle:f+y.resizeHandle,start:function(D){var F=a(D.currentTarget).data("th");
var B="col:eq("+F.index()+")";
var E=A.header.find("table");
var C=A.content.find("table");
A.element.addClass("k-grid-column-resizing");
this.col=C.children("colgroup").find(B).add(E.find(B));
this.th=F;
this.startLocation=D.x.location;
this.columnWidth=F.outerWidth();
this.table=E.add(C);
this.totalWidth=(this.table.width()-E.find("th:last").outerWidth());
},resize:function(C){var D=11;
var B=C.x.location-this.startLocation;
if(this.columnWidth+B<D){B=D-this.columnWidth;
}this.table.css({minWidth:(this.totalWidth+B)});
this.col.width(this.columnWidth+B);
},resizeend:function(){A.element.removeClass("k-grid-column-resizing");
var D=Math.floor(this.columnWidth);
var C=Math.floor(this.th.outerWidth());
var B=A.columns[this.th.index()];
A.trigger("columnResize",{column:B,oldWidth:D,newWidth:C});
this.table=this.col=this.th=null;
}}).data("kendoResizable");
},_modelFromElement:function(y){var A=y.closest("tr");
var z=this.dataSource.getByUid(A.attr(j.attr("uid")));
return z;
},_columnFromElement:function(y){var A=y.closest("td");
var B=A.parent();
var z=B.children().index(A);
return this.columns[z];
}});
g(true,w.GanttList,{styles:o});
})(window.kendo.jQuery);
})();
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b){b();
});
