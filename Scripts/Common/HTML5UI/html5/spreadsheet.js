(function(b,a){a(["./kendo.core","./kendo.binder","./kendo.window","./kendo.list","./kendo.tabstrip","./kendo.color","./kendo.sortable","./kendo.menu","./kendo.data","./kendo.dom","./kendo.toolbar","./kendo.colorpicker","./kendo.combobox","./kendo.dropdownlist","./kendo.popup","./kendo.treeview"],b);
})(function(){(function(){(function(a){var b=a.Observable.extend({init:function(c){a.Observable.fn.init.call(this,c);
this.clear();
},events:["undo","redo"],push:function(c){this.stack=this.stack.slice(0,this.currentCommandIndex+1);
this.currentCommandIndex=this.stack.push(c)-1;
},undo:function(){if(this.canUndo()){var c=this.stack[this.currentCommandIndex--];
c.undo();
this.trigger("undo",{command:c});
}},redo:function(){if(this.canRedo()){var c=this.stack[++this.currentCommandIndex];
c.redo();
this.trigger("redo",{command:c});
}},clear:function(){this.stack=[];
this.currentCommandIndex=-1;
},canUndo:function(){return this.currentCommandIndex>=0;
},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1;
}});
a.deepExtend(a,{util:{UndoRedoStack:b}});
})(kendo);
})();
(function(){(function(e){var a=e.jQuery;
var c=e.spreadsheet.Command=e.Class.extend({init:function(g){this.options=g;
this._property=g&&g.property;
this._state={};
},range:function(g){if(g!==undefined){this._range=g;
}return this._range;
},redo:function(){this.exec();
},undo:function(){this.range().setState(this._state);
},getState:function(){this._state=this.range().getState(this._property);
},_forEachCell:function(g){var h=this.range();
var i=h._ref;
i.forEach(function(j){h.sheet().forEach(j.toRangeRef(),g.bind(this));
}.bind(this));
}});
var f=e.spreadsheet.PropertyChangeCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this._value=g.value;
},exec:function(){var g=this.range();
this.getState();
g[this._property](this._value);
}});
e.spreadsheet.ClearContentCommand=c.extend({exec:function(){this.getState();
this.range().clearContent();
}});
e.spreadsheet.EditCommand=f.extend({init:function(g){g.property="input";
f.fn.init.call(this,g);
},exec:function(){try{return f.fn.exec.apply(this,arguments);
}catch(g){if(g instanceof e.spreadsheet.calc.ParseError){window.alert(g);
this.range().input("'"+this._value);
}else{throw g;
}}}});
e.spreadsheet.TextWrapCommand=f.extend({init:function(g){g.property="wrap";
f.fn.init.call(this,g);
this._value=g.value;
},getState:function(){var g={};
this.range().forEachRow(function(i){var h=i.topLeft().row;
g[h]=i.sheet().rowHeight(h);
});
this._state=this.range().getState(this._property);
this._rowHeight=g;
},undo:function(){var i=this.range().sheet();
var h=this._rowHeight;
this.range().setState(this._state);
for(var g in h){i.rowHeight(g,h[g]);
}}});
e.spreadsheet.AdjustDecimalsCommand=c.extend({init:function(g){this._decimals=g.decimals;
g.property="format";
c.fn.init.call(this,g);
},exec:function(){var i=this.range().sheet();
var g=this._decimals;
var h=e.spreadsheet.formatting;
this.getState();
i.batch(function(){this.range().forEachCell(function(m,k,j){var l=j.format;
if(l||g>0){l=h.adjustDecimals(l||"#",g);
i.range(m,k).format(l);
}});
}.bind(this));
}});
e.spreadsheet.BorderChangeCommand=c.extend({init:function(g){g.property="border";
c.fn.init.call(this,g);
this._type=g.border;
this._style=g.style;
},exec:function(){this.getState();
this[this._type](this._style);
},noBorders:function(){var g=this.range();
g.sheet().batch(function(){g.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);
}.bind(this),{});
},allBorders:function(h){var g=this.range();
g.sheet().batch(function(){g.borderLeft(h).borderTop(h).borderRight(h).borderBottom(h);
}.bind(this),{});
},leftBorder:function(g){this.range().leftColumn().borderLeft(g);
},rightBorder:function(g){this.range().rightColumn().borderRight(g);
},topBorder:function(g){this.range().topRow().borderTop(g);
},bottomBorder:function(g){this.range().bottomRow().borderBottom(g);
},outsideBorders:function(h){var g=this.range();
g.sheet().batch(function(){g.leftColumn().borderLeft(h);
g.topRow().borderTop(h);
g.rightColumn().borderRight(h);
g.bottomRow().borderBottom(h);
}.bind(this),{});
},insideBorders:function(g){this.range().sheet().batch(function(){this.allBorders(g);
this.outsideBorders(null);
}.bind(this),{});
},insideHorizontalBorders:function(h){var g=this.range();
g.sheet().batch(function(){g.borderBottom(h);
g.bottomRow().borderBottom(null);
}.bind(this),{});
},insideVerticalBorders:function(h){var g=this.range();
g.sheet().batch(function(){g.borderRight(h);
g.rightColumn().borderRight(null);
}.bind(this),{});
}});
e.spreadsheet.MergeCellCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this._type=g.value;
},exec:function(){this.getState();
this[this._type]();
},activate:function(g){this.range().sheet().activeCell(g);
},getState:function(){this._state=this.range().getState();
},undo:function(){if(this._type!=="unmerge"){this.range().unmerge();
this.activate(this.range().topLeft());
}this.range().setState(this._state);
},cells:function(){var g=this.range();
var h=g._ref;
g.merge();
this.activate(h);
},horizontally:function(){var g=this.range().topRow()._ref;
this.range().forEachRow(function(h){h.merge();
});
this.activate(g);
},vertically:function(){var g=this.range().leftColumn()._ref;
this.range().forEachColumn(function(h){h.merge();
});
this.activate(g);
},unmerge:function(){var g=this.range();
var h=g._ref.topLeft;
g.unmerge();
this.activate(h);
}});
e.spreadsheet.PasteCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this._workbook=g.workbook;
this._clipboard=this._workbook.clipboard();
},getState:function(){this._range=this._workbook.activeSheet().range(this._clipboard.pasteRef());
this._state=this._range.getState();
},exec:function(){if(this._clipboard.canPaste()){this.getState();
this._clipboard.paste();
}}});
e.spreadsheet.CopyCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this._clipboard=g.workbook.clipboard();
},undo:a.noop,exec:function(){if(this._clipboard.canCopy()){this._clipboard.copy();
}}});
e.spreadsheet.CutCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this._clipboard=g.workbook.clipboard();
},exec:function(){if(this._clipboard.canCopy()){this.getState();
this._clipboard.cut();
}}});
e.spreadsheet.FilterCommand=c.extend({undo:function(){this.range().filter(this._state);
},exec:function(){var g=this.range();
this._state=g.hasFilter();
if(g.hasFilter()){g.filter(false);
}else{g.filter(true);
}}});
e.spreadsheet.SortCommand=c.extend({undo:function(){var g=this.range().sheet();
g.setState(this._state);
},exec:function(){var j=this.range();
var k=j.sheet();
var g=k.activeCell();
var i=g.topLeft.col;
var h=this.options.asc;
this._state=k.getState();
if(this.options.sheet){this.expandRange().sort({column:i,ascending:h});
}else{j.sort({column:i,ascending:h});
}},expandRange:function(){var g=this.range().sheet();
return new e.spreadsheet.Range(g._sheetRef,g);
}});
e.spreadsheet.ApplyFilterCommand=c.extend({column:function(){return this.options.column||0;
},undo:function(){var g=this.range().sheet();
g.clearFilter(this.column());
if(this._state.length){this.range().filter(this._state);
}},exec:function(){var i=this.range();
var j=i.sheet();
var g=this.column();
var h=new e.spreadsheet.ValueFilter({values:this.options.values});
this._state=j.filter().columns.filter(function(k){return k.index==g;
});
this.range().clearFilter(g);
this.range().filter({column:g,filter:h});
}});
e.spreadsheet.HideLineCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this.axis=g.axis;
},undo:function(){var g=this.range().sheet();
g.setAxisState(this._state);
},exec:function(){var g=this.range().sheet();
this._state=g.getAxisState();
if(this.axis=="row"){g.axisManager().hideSelectedRows();
}else{g.axisManager().hideSelectedColumns();
}}});
e.spreadsheet.UnHideLineCommand=e.spreadsheet.HideLineCommand.extend({exec:function(){var g=this.range().sheet();
this._state=g.getAxisState();
if(this.axis=="row"){g.axisManager().unhideSelectedRows();
}else{g.axisManager().unhideSelectedColumns();
}}});
var d=e.spreadsheet.DeleteCommand=c.extend({undo:function(){var g=this.range().sheet();
g.setState(this._state);
}});
e.spreadsheet.DeleteRowCommand=d.extend({exec:function(){var g=this.range().sheet();
this._state=g.getState();
g.axisManager().deleteSelectedRows();
}});
e.spreadsheet.DeleteColumnCommand=d.extend({exec:function(){var g=this.range().sheet();
this._state=g.getState();
g.axisManager().deleteSelectedColumns();
}});
var b=c.extend({init:function(g){c.fn.init.call(this,g);
this._value=g.value;
},undo:function(){var g=this.range().sheet();
g.setState(this._state);
}});
e.spreadsheet.AddColumnCommand=b.extend({exec:function(){var g=this.range().sheet();
this._state=g.getState();
if(this._value==="left"){g.axisManager().addColumnLeft();
}else{g.axisManager().addColumnRight();
}}});
e.spreadsheet.AddRowCommand=b.extend({exec:function(){var g=this.range().sheet();
if(!g.axisManager().canAddRow()){return{reason:"shiftingNonblankCells"};
}this._state=g.getState();
if(this._value==="above"){g.axisManager().addRowAbove();
}else{g.axisManager().addRowBelow();
}}});
e.spreadsheet.EditValidationCommand=c.extend({init:function(g){c.fn.init.call(this,g);
this._value=g.value;
},exec:function(){this.range().validation(this._value);
}});
})(kendo);
})();
(function(){(function(d){var a=d.jQuery;
var b={wrapper:"k-spreadsheet-formula-bar"};
var c=d.ui.Widget.extend({init:function(e,f){d.ui.Widget.call(this,e,f);
e=this.element.addClass(c.classNames.wrapper);
this.formulaInput=new d.spreadsheet.FormulaInput(a("<div/>").appendTo(e));
},destroy:function(){if(this.formulaInput){this.formulaInput.destroy();
}this.formulaInput=null;
}});
d.spreadsheet.FormulaBar=c;
a.extend(true,c,{classNames:b});
})(window.kendo);
})();
(function(){(function(h,q){var a=h.jQuery;
var p=h.ui.Widget;
var l=".kendoFormulaInput";
var j=h.keys;
var b={wrapper:"k-spreadsheet-formula-input",listWrapper:"k-spreadsheet-formula-list"};
var n=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"];
var i={27:"esc",37:"left",39:"right",35:"end",36:"home",32:"spacebar"};
var m=/[a-z0-9]$/i;
var c={"=":true,"(":true,",":true," ":true};
var d=p.extend({init:function(r,s){p.call(this,r,s);
r=this.element;
r.addClass(d.classNames.wrapper).attr("contenteditable",true).attr("spellcheck",false);
if(this.options.autoScale){r.on("input",this.scale.bind(this));
}this._highlightedRefs=[];
this._formulaSource();
this._formulaList();
this._popup();
r.on("keydown",this._keydown.bind(this)).on("keyup",this._keyup.bind(this)).on("blur",this._blur.bind(this)).on("input click",this._input.bind(this)).on("focus",this._focus.bind(this));
},options:{name:"FormulaInput",autoScale:false,filterOperator:"startswith",scalePadding:30,minLength:1},events:["keyup"],getPos:function(){var t=this.element[0];
var v=q.getSelection();
var r=u(v.focusNode,v.focusOffset);
var s=u(v.anchorNode,v.anchorOffset);
if(r!=null&&s!=null){if(r>s){var w=r;
r=s;
s=w;
}return{begin:r,end:s,collapsed:r==s};
}function u(y,A){try{(function z(C){if(C===y){throw A;
}else{if(C.nodeType==1){for(var B=C.firstChild;
B;
B=B.nextSibling){z(B);
}}else{if(C.nodeType==3){A+=C.nodeValue.length;
}}}})(t);
}catch(x){return x;
}}},setPos:function(s,u){var t=this.element[0];
s=v(t,s);
if(u!=null){u=v(t,u);
}else{u=s;
}if(s&&u){var w=document.createRange();
w.setStart(s.node,s.pos);
w.setEnd(u.node,u.pos);
var x=q.getSelection();
x.removeAllRanges();
x.addRange(w);
}function v(z,A){try{(function y(D){if(D.nodeType==3){var C=D.nodeValue.length;
if(C>=A){throw D;
}A-=C;
}else{if(D.nodeType==1){for(var B=D.firstChild;
B;
B=B.nextSibling){y(B);
}}}})(z);
}catch(r){return{node:r,pos:A};
}}},end:function(){this.setPos(this.length());
},home:function(){this.setPos(0);
},length:function(){return this.value().length;
},_formulaSource:function(){var s=[];
var t;
for(var r in h.spreadsheet.calc.runtime.FUNCS){if(m.test(r)){t=r.toUpperCase();
s.push({value:t,text:t});
}}this.formulaSource=new h.data.DataSource({data:s});
},_formulaList:function(){this.list=new h.ui.StaticList(a("<ul />").addClass(d.classNames.listWrapper).insertAfter(this.element),{autoBind:false,selectable:true,change:this._formulaListChange.bind(this),dataSource:this.formulaSource,dataValueField:"value",template:"#:data.value#"});
this.list.element.on("mousedown",function(r){r.preventDefault();
});
},_formulaListChange:function(){var u=this.getPos();
if(!u||this._mute){return;
}var s=this.list.value()[0];
var v=this.value();
var r=this._startIdx(v,u.begin);
var t=this._endIdx(v,u.end);
if(v.charAt(t)!="("){s+="(";
}v=v.substr(0,r)+s+v.substr(t);
this.value(v);
this.scale();
this.popup.close();
this.setPos(r+s.length);
this._sync();
},_popup:function(){this.popup=new h.ui.Popup(this.list.element,{anchor:this.element});
},_blur:function(){this.popup.close();
clearTimeout(this._focusId);
},_isFormula:function(){return/^=/.test(this.value());
},_keydown:function(r){var s=r.keyCode;
if(i[s]){this.popup.close();
this._navigated=true;
}else{if(this._move(s)){this._navigated=true;
r.preventDefault();
}}this._keyDownTimeout=setTimeout(this._syntaxHighlight.bind(this));
},_keyup:function(){var s;
var r=this.popup;
if(this._isFormula()&&!this._navigated){s=this._searchValue();
this.filter(s);
if(!s||!this.formulaSource.view().length){r.close();
}else{r[r.visible()?"position":"open"]();
this.list.focusFirst();
}}this._navigated=false;
this._syntaxHighlight();
this.trigger("keyup");
},_input:function(){this._syntaxHighlight();
},_startIdx:function(s,r){while(r>0){if(c[s[r-1]]){break;
}r--;
}return r;
},_endIdx:function(s,r){while(r<s.length){if(c[s[r]]){break;
}r++;
}return r;
},_focus:function(){this._focusTimeout=setTimeout(this._syntaxHighlight.bind(this));
},_move:function(r){var s=this.list;
var t=false;
if(r===j.DOWN){s.focusNext();
if(!s.focus()){s.focusFirst();
}t=true;
}else{if(r===j.UP){s.focusPrev();
if(!s.focus()){s.focusLast();
}t=true;
}else{if(r===j.ENTER){s.select(s.focus());
this.popup.close();
t=true;
}else{if(r===j.TAB){s.select(s.focus());
this.popup.close();
t=true;
}else{if(r===j.PAGEUP){s.focusFirst();
t=true;
}else{if(r===j.PAGEDOWN){s.focusLast();
t=true;
}}}}}}return t;
},_searchValue:function(){var s=this.value();
var r=this.getPos();
if(!r||!r.collapsed){return;
}return s.substr(this._startIdx(s,r.begin),this._endIdx(s,r.begin)-1);
},_sync:function(){if(this._editorToSync&&this.isActive()){this._editorToSync.value(this.value());
}},_textContainer:function(){var r=h.getComputedStyles(this.element[0],n);
r.position="absolute";
r.visibility="hidden";
r.top=-3333;
r.left=-3333;
this._span=a("<span/>").css(r).insertAfter(this.element);
},isActive:function(){return this.element.is(":focus");
},filter:function(r){if(!r||r.length<this.options.minLength){return;
}this._mute=true;
this.list.select(-1);
this._mute=false;
this.formulaSource.filter({field:this.list.options.dataValueField,operator:this.options.filterOperator,value:r});
},hide:function(){this.element.hide();
},show:function(){this.element.show();
},position:function(r){if(!r){return;
}this.element.show().css({top:r.top+"px",left:r.left+"px"});
},canInsertRef:function(r){if(r){return null;
}return this._canInsertRef();
},_canInsertRef:function(){var w=this.getPos();
var y,x;
if(w&&this._isFormula()){if(w.begin===0){return null;
}y=h.spreadsheet.calc.tokenize(this.value());
for(var v=0;
v<y.length;
++v){x=y[v];
if(s(x)){return u(x);
}if(r(x)){return t(y[v-1],x);
}}return t(x,null);
}return null;
function s(z){return z.begin<=w.begin&&z.end>=w.end;
}function r(z){return z.begin>w.begin;
}function u(z){if(z){if(/^(?:num|str|bool|sym|ref)$/.test(z.type)){return{replace:true,token:z,end:z.end};
}if(/^(?:op|punc|startexp)$/.test(z.type)){if(z.end==w.end){return t(z,y[v+1]);
}return t(y[v-1],z);
}}}function t(z,A){if(z==null){return null;
}if(A==null){if(/^(?:op|startexp)$/.test(z.type)||g(z.value)){return{token:z,end:w.end};
}return null;
}if(z.type=="startexp"){return{token:z,end:w.end};
}if(/^(?:ref|op|punc)$/.test(z.type)){return{token:z,end:w.end};
}if(/^(?:punc|op)$/.test(z.type)){return(/^[,;({]$/.test(z.value)?{token:z,end:w.end}:null);
}return false;
}},refAtPoint:function(s){var w=this._canInsertRef();
if(w){s=s.simplify().toString();
var v=this.value();
var u=w.token;
var t=v.substr(w.end);
v=v.substr(0,w.replace?u.begin:w.end)+s;
var r=v.length;
v+=t;
this._value(v);
this.setPos(r);
this.scale();
this._syntaxHighlight();
this._sync();
}},resize:function(r){if(!r){return;
}this.element.css({width:r.width+1,height:r.height+1});
},syncWith:function(s){var r="input"+l;
this._editorToSync=s;
this.element.off(r).on(r,this._sync.bind(this));
},scale:function(){var r=this.element;
var s;
if(!this._span){this._textContainer();
}this._span.html(r.html());
s=this._span.width()+this.options.scalePadding;
if(s>r.width()){r.width(s);
}},_value:function(r){this.element.text(r);
},value:function(r){if(r===undefined){return this.element.text();
}this._value(r);
this._syntaxHighlight();
},highlightedRefs:function(){return this._highlightedRefs.slice();
},_syntaxHighlight:function(){var x=this.value();
var t=this.getPos();
var r=[];
if(t&&!t.collapsed){return;
}if(!(/^=/.test(x))){this.element.text(x);
this.popup.close();
}else{var w=h.spreadsheet.calc.tokenize(x);
var u=h.spreadsheet.Pane.classNames.series;
var v=0;
var s=[];
w.forEach(function(z){z.active=false;
z.cls=["k-syntax-"+z.type];
if(z.type=="ref"){z.seriesCls=u[(v++)%u.length];
z.cls.push(z.seriesCls);
r.push(z);
}if(t&&z.type=="punc"){if(g(z.value)){s.unshift(z);
}else{if(e(z.value)){var y=s.shift();
if(y){if(f(z.value,y.value)){if(o(z,t)||o(y,t)){z.cls.push("k-syntax-paren-match");
y.cls.push("k-syntax-paren-match");
}}else{z.cls.push("k-syntax-error");
y.cls.push("k-syntax-error");
}}else{z.cls.push("k-syntax-error");
}}}}if(t&&o(z,t)){z.cls.push("k-syntax-at-point");
z.active=true;
}if(z.type=="func"&&!k(z.value)&&(!t||!o(z,t))){z.cls.push("k-syntax-error");
}});
w.reverse().forEach(function(B){var y=B.begin,z=B.end;
var A=h.htmlEncode(x.substring(y,z));
x=x.substr(0,y)+"<span class='"+B.cls.join(" ")+"'>"+A+"</span>"+x.substr(z);
});
this.element.html(x);
}if(t){this.setPos(t.begin,t.end);
}this._highlightedRefs=r;
},destroy:function(){this._editorToSync=null;
this.element.off(l);
clearTimeout(this._focusTimeout);
clearTimeout(this._keyDownTimeout);
this.popup.destroy();
this.popup=null;
p.fn.destroy.call(this);
}});
function g(r){return r=="("||r=="["||r=="{";
}function e(r){return r==")"||r=="]"||r=="}";
}function f(r,s){return s=="("?r==")":s=="["?r=="]":s=="{"?r=="}":false;
}function o(r,s){return r.begin<=s.begin&&r.end>=s.end;
}function k(r){return h.spreadsheet.calc.runtime.FUNCS[r.toLowerCase()];
}h.spreadsheet.FormulaInput=d;
a.extend(true,d,{classNames:b});
})(kendo,window);
})();
(function(){(function(d){var a=d.jQuery;
var e={8:"backspace",9:"tab",13:"enter",27:"esc",37:"left",38:"up",39:"right",40:"down",35:"end",36:"home",32:"spacebar",33:"pageup",34:"pagedown",46:"delete",113:":edit"};
var g=navigator.platform.toUpperCase().indexOf("MAC")>=0;
var c=function(h){if((h>47&&h<58)||(h>64&&h<91)||(h>95&&h<112)||(h>185&&h<193)||(h>218&&h<223)){return true;
}return false;
};
var f=function(h){var i=e[h];
if(!i&&c(h)){i=":alphanum";
}return i;
};
var b=d.Class.extend({init:function(k,j,h){this._handlers={};
this.target=k;
this._observer=j||window;
this.keyDownProxy=this.keyDown.bind(this);
this.mouseProxy=this.mouse.bind(this);
this._mousePressed=false;
k.on("keydown",this.keyDownProxy);
k.on("contextmenu mousedown cut copy paste scroll wheel click dblclick focus",this.mouseProxy);
a(document.documentElement).on("mousemove mouseup",this.mouseProxy);
if(h){for(var i in h){this.on(i,h[i]);
}}},keyDown:function(h){this.handleEvent(h,f(h.keyCode));
},mouse:function(h){var i;
if(h.which){i=(h.which==3);
}else{if(h.button){i=(h.button==2);
}}var j=h.type;
if(j==="mousedown"){if(i){j="rightmousedown";
}else{this._mousePressed=true;
}}if(j==="mouseup"){if(!i){this._mousePressed=false;
}}if(j==="mousemove"&&this._mousePressed){j="mousedrag";
}this.handleEvent(h,j);
},handleEvent:function(i,l){var j="";
i.mod=g?i.metaKey:i.ctrlKey;
if(i.shiftKey){j+="shift+";
}if(i.ctrlKey){j+="ctrl+";
}j+=l;
var h=this._handlers["*+"+l];
if(h){h.call(this._observer,i,j);
}var k=this._handlers[j];
if(k){k.call(this._observer,i,j);
}},on:function(i,h){var j=this._handlers;
if(typeof h==="string"){h=this._observer[h];
}if(typeof i==="string"){i=i.split(",");
}i.forEach(function(k){j[k]=h;
});
},destroy:function(){this.target.off("keydown",this.keyDownProxy);
this.target.off("keydown",this.mouseProxy);
a(document.documentElement).off("mousemove mouseup",this.mouseProxy);
}});
d.spreadsheet.EventListener=b;
})(window.kendo);
})();
(function(){(function(d){var m=d.Class.extend({init:function h(u,w,t,v){this.level=u;
this.value=w;
this.left=t;
this.right=v;
}});
var g=new (function f(){this.left=this;
this.right=this;
this.level=0;
})();
function i(t){return t;
}function o(t){if(t.left.level===t.level){var u=t;
t=t.left;
u.left=t.right;
t.right=u;
}return t;
}function q(t){if(t.right.right.level===t.level){var u=t;
t=t.right;
u.right=t.left;
t.left=u;
t.level+=1;
}return t;
}function a(t,u){if(t===g){return new m(1,u,g,g);
}else{if(t.value.start-u.start>0){t.left=a(t.left,u);
}else{t.right=a(t.right,u);
}}return q(o(t));
}function n(v,w){if(v===g){return v;
}var t=v.value.start-w.start;
if(t===0){if(v.left!==g&&v.right!==g){var u=v.left;
while(u.right!==g){u=u.right;
}v.value=u.value;
v.left=n(v.left,v.value);
}else{if(v.left===g){v=v.right;
}else{v=v.left;
}}}else{if(t>0){v.left=n(v.left,w);
}else{v.right=n(v.right,w);
}}if(v.left.level<(v.level-1)||v.right.level<(v.level-1)){v.level-=1;
if(v.right.level>v.level){v.right.level=v.level;
}v=o(v);
v.right=o(v.right);
v.right.right=o(v.right.right);
v=q(v);
v.right=q(v.right);
}return v;
}var j=d.Class.extend({init:function r(u,t,v){this.start=u;
this.end=t;
this.value=v;
},intersects:function(t){return t.start<=this.end&&t.end>=this.start;
}});
var l=d.Class.extend({init:function(){this.root=g;
},insert:function(t){this.root=a(this.root,t);
},remove:function(t){this.root=n(this.root,t);
},findrange:function(u){var t=this.root;
while(t!=g){if(u<t.value.start){t=t.left;
}else{if(u>t.value.end){t=t.right;
}else{return t.value;
}}}return null;
},values:function(){var t=[];
s(this.root,t);
return t;
},intersecting:function(v,t){var u=[];
b(this.root,new j(v,t),u);
return u;
},map:function(t){var u=new l();
e(u,this.root,t);
return u;
},clone:function(){return this.map(i);
},first:function(){var t=this.root;
while(t.left!=g){t=t.left;
}return t;
},last:function(){var t=this.root;
while(t.right!=g){t=t.right;
}return t;
}});
function s(t,u){if(t===g){return;
}s(t.left,u);
u.push(t.value);
s(t.right,u);
}function b(t,u,v){if(t===g){return;
}var w=t.value;
if(u.start<w.start){b(t.left,u,v);
}if(w.intersects(u)){v.push(w);
}if(u.end>w.end){b(t.right,u,v);
}}function e(v,u,t){if(u===g){return;
}e(v,u.left,t);
v.insert(t(u.value));
e(v,u.right,t);
}var k=d.Class.extend({init:function(u,t,v){if(t===undefined){this.tree=u;
}else{this.tree=new l();
this.tree.insert(new j(u,t,v));
}},values:function(){return this.tree.values();
},map:function(t){return new k(this.tree.map(t));
},intersecting:function(u,t){return this.tree.intersecting(u,t);
},first:function(){return this.tree.first().value;
},last:function(){return this.tree.last().value;
},insert:function(u,t,v){return this.tree.insert(new j(u,t,v));
},value:function(D,t,E){if(E===undefined){if(t===undefined){t=D;
}return this.intersecting(D,t)[0].value;
}var A=this.tree.intersecting(D-1,t+1);
if(A.length){var u=A[0],w=A[A.length-1];
if(u.end<D){if(u.value===E){D=u.start;
}else{A.shift();
}}if(w.start>t){if(w.value===E){t=w.end;
}else{A.pop();
}}for(var v=0,x=A.length;
v<x;
v++){var y=A[v];
var C=y.value;
var B=y.start;
var z=y.end;
this.tree.remove(y);
if(B<D){if(C!==E){this.insert(B,D-1,C);
}else{D=B;
}}if(z>t){if(C!==E){this.insert(t+1,z,C);
}else{t=z;
}}}}this.insert(D,t,E);
},expandedValues:function(y,t){var w=this.intersecting(y,t);
var x=[];
var v=0;
for(var u=y;
u<=t;
u++){if(w[v].end<u){v++;
}x.push({index:u-y,value:w[v].value});
}return x;
},sortedIndices:function(x,u,y,v){var w=this.expandedValues(x,u);
var t=function(z,A){if(z.value===A.value){return z.index-A.index;
}return y(z.value,A.value);
};
if(v){t=function(z,A){var B=v[z.index];
var C=v[A.index];
if(B.value===C.value){return y(z.value,A.value);
}return z.index-A.index;
};
}w.sort(t);
return w;
},sort:function(x,t,v){if(this.intersecting(x,t).length===1){return;
}var y=this.expandedValues(x,t);
for(var u=0,w=v.length;
u<w;
u++){this.value(u+x,u+x,y[v[u].index].value);
}},copy:function(z,y,B){var C=this.intersecting(z,y);
var A=B;
var t;
for(var u=0,v=C.length;
u<v;
u++){var x=C[u].start;
if(x<z){x=z;
}var w=C[u].end;
if(w>y){w=y;
}t=A+(w-x);
this.value(A,t,C[u].value);
A=++t;
}},iterator:function(u,t){return new c(u,t,this.intersecting(u,t));
},getState:function(){return this.tree.clone();
},setState:function(t){this.tree=t;
}});
var c=d.Class.extend({init:function(v,t,u){this.start=v;
this.end=t;
this.index=0;
this.ranges=u;
},unique:function(){return this.ranges.map(function(t){return t.value;
});
},at:function(t){while(this.ranges[this.index].end<t){this.index++;
}return this.ranges[this.index].value;
},forEach:function(t){for(var u=this.start;
u<=this.end;
u++){t(this.at(u),u);
}this.index=0;
}});
var p=k.extend({init:function(u,t,v){this.tree=new l();
this.range=new j(u,t,v);
},intersecting:function(z,t){var x=this.tree.intersecting(z,t);
var y=[];
var w;
if(!x.length){return[this.range];
}for(var u=0,v=x.length;
u<v;
u++){w=x[u];
if(w.start>z){y.push(new j(z,w.start-1,this.range.value));
}y.push(w);
z=w.end+1;
}if(w.end<t){y.push(new j(w.end+1,t,this.range.value));
}return y;
},insert:function(u,t,v){if(v!==this.range.value){this.tree.insert(new j(u,t,v));
}},lastRangeStart:function(){var t=this.tree.root;
if(t===g){return this.range.start;
}while(t.right!==g){t=t.right;
}return t.value.end+1;
}});
d.spreadsheet.RangeTree=l;
d.spreadsheet.RangeList=k;
d.spreadsheet.SparseRangeList=p;
d.spreadsheet.ValueRange=j;
})(kendo);
})();
(function(){(function(c){var a=c.jQuery;
var d=c.Class.extend({init:function(g){this.list=g;
},get:function(g){return this.parse(this.list.value(g,g));
},set:function(h,g,i){if(i===undefined){i=g;
g=h;
}this.list.value(h,g,i);
},parse:function(g){return g;
},copy:function(i,h,g){this.list.copy(i,h,g);
},iterator:function(h,g){return this.list.iterator(h,g);
}});
var b=d.extend({set:function(h,g,i){this.list.value(h,g,JSON.stringify(i));
},parse:function(g){return JSON.parse(g);
}});
var f=d.extend({init:function(i,g,h){d.prototype.init.call(this,i);
this.validations=h;
this.formats=g;
},set:function(h,g,i){if(i instanceof Date){i=c.spreadsheet.dateToNumber(i);
this.formats.value(h,g,e(c.culture().calendar.patterns.d));
}this.list.value(h,g,i);
}});
function e(g){return g.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}c.spreadsheet.PropertyBag=c.Class.extend({specs:[{property:f,name:"value",value:null,sortable:true,serializable:true,depends:"format"},{property:d,name:"format",value:null,sortable:true,serializable:true},{property:d,name:"formula",value:null,sortable:true,serializable:true},{property:d,name:"background",value:null,sortable:true,serializable:true},{property:b,name:"borderBottom",value:null,sortable:false,serializable:true},{property:b,name:"borderRight",value:null,sortable:false,serializable:true},{property:b,name:"borderLeft",value:null,sortable:false,serializable:true},{property:b,name:"borderTop",value:null,sortable:false,serializable:true},{property:d,name:"color",value:null,sortable:true,serializable:true},{property:d,name:"fontFamily",value:null,sortable:true,serializable:true},{property:d,name:"underline",value:null,sortable:true,serializable:true},{property:d,name:"fontSize",value:null,sortable:true,serializable:true},{property:d,name:"italic",value:null,sortable:true,serializable:true},{property:d,name:"bold",value:null,sortable:true,serializable:true},{property:d,name:"textAlign",value:null,sortable:true,serializable:true},{property:d,name:"verticalAlign",value:null,sortable:true,serializable:true},{property:d,name:"wrap",value:null,sortable:true,serializable:true},{property:d,name:"validation",value:null,sortable:false,serializable:true}],init:function(g){this.properties={};
this.lists={};
this.specs.forEach(function(h){this.lists[h.name]=new c.spreadsheet.SparseRangeList(0,g,h.value);
},this);
this.specs.forEach(function(h){this.properties[h.name]=new h.property(this.lists[h.name],this.lists[h.depends]);
},this);
},getState:function(){var g={};
this.specs.forEach(function(h){g[h.name]=this.lists[h.name].getState();
},this);
return g;
},setState:function(g){this.specs.forEach(function(h){this.lists[h.name].setState(g[h.name]);
},this);
},get:function(h,g){if(g===undefined){return this.lists[h];
}return this.properties[h].get(g);
},set:function(h,i,g,j){this.properties[h].set(i,g,j);
},fromJSON:function(g,j){for(var h=0;
h<this.specs.length;
h++){var i=this.specs[h];
if(i.serializable){if(j[i.name]!==undefined){this.set(i.name,g,g,j[i.name],false);
}}}},copy:function(h,g,i){this.specs.forEach(function(j){this.properties[j.name].copy(h,g,i);
},this);
},iterator:function(h,i,g){return this.properties[h].iterator(i,g);
},sortable:function(){return this.specs.filter(function(g){return g.sortable;
}).map(function(g){return this.lists[g.name];
},this);
},iterators:function(i,g){var h=this.specs.filter(function(j){return j.serializable;
});
return h.map(function(k){var j=this.iterator(k.name,i,g);
return{name:k.name,value:k.value,at:function(l){return k.property.fn.parse(j.at(l));
}};
},this);
},forEach:function(n,h,g){var m=this.iterators(n,h);
for(var k=n;
k<=h;
k++){var p={};
for(var j=0;
j<m.length;
j++){var l=m[j];
var o=l.at(k);
if(o!==l.value){p[l.name]=o;
}}g(p);
}},forEachProperty:function(g){for(var h in this.properties){g(this.properties[h]);
}}});
c.spreadsheet.ALL_PROPERTIES=a.map(c.spreadsheet.PropertyBag.prototype.specs,function(g){return g.name;
});
})(window.kendo);
})();
(function(){var j=kendo.spreadsheet;
var b=kendo.Class;
function c(l){var m=Math.floor(l/26)-1;
return(m>=0?c(m):"")+String.fromCharCode(65+(l%26));
}function d(p,o,m,n){var l="";
++o;
if(!isFinite(o)){o="";
}else{if(n!=null&&!(n&2)){o="$"+o;
}}if(!isFinite(m)){m="";
}else{l=c(m);
if(n!=null&&!(n&1)){l="$"+l;
}}if(p){return p+"!"+l+o;
}else{return l+o;
}}var i=b.extend({type:"ref",hasSheet:function(){return this._hasSheet;
},simplify:function(){return this;
},setSheet:function(m,l){this.sheet=m;
if(l!=null){this._hasSheet=l;
}return this;
},absolute:function(){return this;
},relative:function(){return this;
},adjust:function(){return this;
},toString:function(){return this.relative(0,0,3,3).print(0,0);
},forEach:function(l,m){l.call(m,this);
},map:function(l,m){return l.call(m,this);
},isCell:function(){return false;
},first:function(){return this;
},lastRange:function(){return this;
},size:function(){return 1;
},rangeAt:function(){return this;
},nextRangeIndex:function(){return 0;
},previousRangeIndex:function(){return 0;
},eq:function(p){var n=this;
var o=p;
if(n===f||o===f){return n===o;
}if((o instanceof a)||(o instanceof h&&!(n instanceof a))){n=p;
o=this;
}if(n instanceof a){o=o.simplify();
return o instanceof a&&n.row==o.row&&n.col==o.col&&n.sheet==o.sheet;
}else{if(n instanceof h){if(o instanceof h){return o.topLeft.eq(n.topLeft)&&o.bottomRight.eq(n.bottomRight);
}if(o instanceof k){return o.single()&&n.eq(o.refs[0]);
}}else{if(n instanceof k&&o instanceof k){var q=n.refs;
var r=o.refs;
if(q.length!=r.length){return false;
}for(var l=0,m=q.length;
l<m;
l++){if(!q[l].eq(r[l])){return false;
}}return true;
}}}return n===o;
},concat:function(l){return new k([this,l]);
},replaceAt:function(l,m){return m;
},forEachColumnIndex:function(l){this.forEachAxisIndex("col",l);
},forEachRowIndex:function(l){this.forEachAxisIndex("row",l);
},forEachAxisIndex:function(l,m){var o=[];
var n=l==="row"?"forEachRow":"forEachColumn";
this[n](function(q){var p=q.first()[l];
if(o.indexOf(p)===-1){o.push(p);
}});
o.sort(function(p,q){return p>q?1:(p<q?-1:0);
}).forEach(m);
}});
i.display=d;
var f=new (i.extend({init:function g(){},print:function(){return"#NULL!";
},clone:function(){return this;
},eq:function(l){return l===this;
},forEach:function(){}}))();
var e=i.extend({ref:"name",init:function e(l){this.name=l;
},print:function(){var l=this.name;
if(this.hasSheet()){l=this.sheet+"!"+l;
}return l;
}});
var a=i.extend({ref:"cell",init:function a(n,l,m){this.row=n;
this.col=l;
this.rel=m||0;
},clone:function(){return new a(this.row,this.col,this.rel).setSheet(this.sheet,this.hasSheet());
},intersect:function(l){if(l instanceof a){if(this.eq(l)){return this;
}else{return f;
}}return l.intersect(this);
},print:function(p,o){var l=this.col,n=this.row,m=this.rel;
if(p==null){if(isFinite(l)){l=m&1?("C["+l+"]"):("C"+(l+1));
}else{l="";
}if(isFinite(n)){n=m&2?("R["+n+"]"):("R"+(n+1));
}else{n="";
}return n+l;
}else{if(m&1){l+=o;
}if(m&2){n+=p;
}if((isFinite(l)&&l<0)||(isFinite(n)&&n<0)){return"#REF!";
}return d(this._hasSheet&&this.sheet,n,l,m);
}},absolute:function(m,l){var n=this.clone();
if(n.rel&3===0){return n;
}if(n.rel&1){n.col+=l;
}if(n.rel&2){n.row+=m;
}n.rel=0;
return n;
},toRangeRef:function(){return new h(this,this);
},relative:function(m,l,o){if(o==null){o=this.rel;
}var p=o&2?this.row-m:this.row;
var n=o&1?this.col-l:this.col;
return new a(p,n,o).setSheet(this.sheet,this.hasSheet());
},height:function(){return 1;
},width:function(){return 1;
},toString:function(){return d(null,this.row,this.col,3);
},isCell:function(){return true;
},leftColumn:function(){return this;
},rightColumn:function(){return this;
},topRow:function(){return this;
},bottomRow:function(){return this;
},toColumn:function(){return this;
},forEachRow:function(l){l(this.toRangeRef());
},forEachColumn:function(l){l(this.toRangeRef());
},adjust:function(p,l,s,r,n,q,m){var o=this.absolute(p,l);
if(n){if(o.row>=q){if(m<0&&o.row<q-m){return f;
}o.row+=m;
}}else{if(o.col>=q){if(m<0&&o.col<q-m){return f;
}o.col+=m;
}}if(s!=null&&r!=null){o=o.relative(s,r,this.rel);
}return o;
}});
var h=i.extend({ref:"range",init:function h(m,l){if(m._hasSheet&&l._hasSheet&&m.sheet.toLowerCase()!=l.sheet.toLowerCase()){this.endSheet=l.sheet;
}this.topLeft=new a(m.row,m.col,m.rel);
this.bottomRight=new a(l.row,l.col,l.rel);
this.normalize();
},clone:function(){return new h(this.topLeft.clone(),this.bottomRight.clone()).setSheet(this.sheet,this.hasSheet());
},_containsRange:function(l){return this._containsCell(l.topLeft)&&this._containsCell(l.bottomRight);
},_containsCell:function(l){return l.sheet==this.sheet&&l.row>=this.topLeft.row&&l.col>=this.topLeft.col&&l.row<=this.bottomRight.row&&l.col<=this.bottomRight.col;
},contains:function(l){if(l instanceof Array){var m=this;
return l.some(function(n){return m.contains(n);
});
}if(l instanceof a){return this._containsCell(l);
}if(l instanceof h){return this._containsRange(l);
}return false;
},_intersectRange:function(t){if(this.sheet!=t.sheet){return f;
}var m=this.topLeft.col;
var o=this.topLeft.row;
var n=this.bottomRight.col;
var l=this.bottomRight.row;
var q=t.topLeft.col;
var s=t.topLeft.row;
var r=t.bottomRight.col;
var p=t.bottomRight.row;
if(m<=r&&q<=n&&o<=p&&s<=l){return new h(new a(Math.max(o,s),Math.max(m,q)),new a(Math.min(l,p),Math.min(n,r))).setSheet(this.sheet,this.hasSheet());
}else{return f;
}},intersect:function(l){if(l===f){return l;
}if(l instanceof a){return this._containsCell(l)?l:f;
}if(l instanceof h){return this._intersectRange(l).simplify();
}if(l instanceof k){return l.intersect(this);
}throw new Error("Unknown reference");
},intersects:function(l){return this.intersect(l)!==f;
},simplify:function(){if(this.isCell()){return new a(this.topLeft.row,this.topLeft.col,this.topLeft.rel).setSheet(this.sheet,this.hasSheet());
}return this;
},normalize:function(){var l=this.topLeft,m=this.bottomRight;
var q=l.row,n=l.col,r=m.row,o=m.col;
var u=l.rel&2,s=l.rel&1;
var v=m.rel&2,t=m.rel&1;
var w,p=false;
if(q>r){p=true;
w=q;
q=r;
r=w;
w=u;
u=v;
v=w;
}if(n>o){p=true;
w=n;
n=o;
o=w;
w=s;
s=t;
t=w;
}if(p){this.topLeft=new a(q,n,s|u);
this.bottomRight=new a(r,o,t|v);
}return this;
},print:function(n,m){var l=this.topLeft.print(n,m)+":"+this.bottomRight.print(n,m);
if(this.hasSheet()){l=this.sheet+"!"+l;
}return l;
},absolute:function(m,l){return new h(this.topLeft.absolute(m,l),this.bottomRight.absolute(m,l)).setSheet(this.sheet,this.hasSheet());
},relative:function(m,l,o,n){if(n==null){n=o;
}return new h(this.topLeft.relative(m,l,o),this.bottomRight.relative(m,l,n)).setSheet(this.sheet,this.hasSheet());
},height:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.row-this.topLeft.row+1;
},width:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.col-this.topLeft.col+1;
},collapse:function(){return this.topLeft.toRangeRef();
},leftColumn:function(){return new h(this.topLeft,new a(this.bottomRight.row,this.topLeft.col));
},rightColumn:function(){return new h(new a(this.topLeft.row,this.bottomRight.col),this.bottomRight);
},topRow:function(){return new h(this.topLeft,new a(this.topLeft.row,this.bottomRight.col));
},bottomRow:function(){return new h(new a(this.bottomRight.row,this.topLeft.col),this.bottomRight);
},toRangeRef:function(){return this;
},toColumn:function(l){return new h(new a(this.topLeft.row,this.topLeft.col+l),new a(this.bottomRight.row,this.topLeft.col+l));
},forEachRow:function(l){var q=this.topLeft.row;
var n=this.bottomRight.row;
var p=this.topLeft.col;
var m=this.bottomRight.col;
for(var o=q;
o<=n;
o++){l(new h(new a(o,p),new a(o,m)));
}},forEachColumn:function(l){var q=this.topLeft.row;
var n=this.bottomRight.row;
var p=this.topLeft.col;
var m=this.bottomRight.col;
for(var o=p;
o<=m;
o++){l(new h(new a(q,o),new a(n,o)));
}},intersecting:function(l){return l.filter(function(m){return m.toRangeRef().intersects(this);
},this);
},union:function(q,n){var o=this.intersecting(q);
var t=this.topLeft.row;
var s=this.topLeft.col;
var m=this.bottomRight.row;
var l=this.bottomRight.col;
var p=false;
o.forEach(function(u){u=u.toRangeRef();
if(u.topLeft.row<t){p=true;
t=u.topLeft.row;
}if(u.topLeft.col<s){p=true;
s=u.topLeft.col;
}if(u.bottomRight.row>m){p=true;
m=u.bottomRight.row;
}if(u.bottomRight.col>l){p=true;
l=u.bottomRight.col;
}if(n){n(u);
}});
var r=new h(new a(t,s),new a(m,l));
if(p){return r.union(q,n);
}else{return r;
}},resize:function(p){var n=Math.max.bind(Math,0);
function o(s){return s||0;
}var r=this.topLeft.row+o(p.top);
var m=this.topLeft.col+o(p.left);
var l=this.bottomRight.row+o(p.bottom);
var q=this.bottomRight.col+o(p.right);
if(m<0&&q<0||r<0&&l<0){return f;
}else{if(r<=l&&m<=q){return new h(new a(n(r),n(m)),new a(n(l),n(q)));
}else{return f;
}}},move:function(m,l){return new h(new a(this.topLeft.row+m,this.topLeft.col+l),new a(this.bottomRight.row+m,this.bottomRight.col+l));
},first:function(){return this.topLeft;
},isCell:function(){return !this.endSheet&&this.topLeft.eq(this.bottomRight);
},toString:function(){return this.topLeft+":"+this.bottomRight;
},adjust:function(o,l,t,q,n,p,m){var r=this.topLeft.adjust(o,l,t,q,n,p,m);
var s=this.bottomRight.adjust(o,l,t,q,n,p,m);
if(r===f&&s===f){return f;
}if(r===f){r=this.topLeft.absolute(o,l);
if(n){r.row=p;
}else{r.col=p;
}if(t!=null&&q!=null){r=r.relative(t,q,this.topLeft.rel);
}}else{if(s===f){s=this.bottomRight.absolute(o,l);
if(n){s.row=p-1;
}else{s.col=p-1;
}if(t!=null&&q!=null){s=s.relative(t,q,this.bottomRight.rel);
}}}return new h(r,s).setSheet(this.sheet,this.hasSheet()).simplify();
}});
var k=i.extend({init:function k(l){this.refs=l;
this.length=this.refs.length;
},intersect:function(n){var l=[];
for(var m=0;
m<this.length;
++m){var o=n.intersect(this.refs[m]);
if(o!==f){l.push(o);
}}if(l.length>0){return new k(l).simplify();
}return f;
},simplify:function(){var l=new k(this.refs.reduce(function(m,n){n=n.simplify();
if(n!==f){m.push(n);
}return m;
},[]));
if(l.empty()){return f;
}if(l.single()){return l.refs[0];
}return l;
},absolute:function(m,l){return new k(this.refs.map(function(n){return n.absolute(m,l);
}));
},forEach:function(l,m){this.refs.forEach(l,m);
},toRangeRef:function(){return this.refs[0].toRangeRef();
},contains:function(l){return this.refs.some(function(m){return m.contains(l);
});
},map:function(l,m){return new k(this.refs.map(l,m));
},first:function(){return this.refs[0].first();
},lastRange:function(){return this.refs[this.length-1];
},size:function(){return this.length;
},single:function(){return this.length==1;
},empty:function(){return this.length===0;
},isCell:function(){return this.single()&&this.refs[0].isCell();
},rangeAt:function(l){return this.refs[l];
},nextRangeIndex:function(l){if(l===this.length-1){return 0;
}else{return l+1;
}},previousRangeIndex:function(l){if(l===0){return this.length-1;
}else{return l-1;
}},concat:function(l){return new k(this.refs.concat([l]));
},print:function(){return this.refs.map(function(l){return l.print();
}).join(",");
},replaceAt:function(l,n){var m=this.refs.slice();
m.splice(l,1,n);
return new k(m);
},leftColumn:function(){return this.map(function(l){return l.leftColumn();
});
},rightColumn:function(){return this.map(function(l){return l.rightColumn();
});
},topRow:function(){return this.map(function(l){return l.topRow();
});
},bottomRow:function(){return this.map(function(l){return l.bottomRow();
});
},forEachRow:function(l){this.forEach(function(m){m.forEachRow(l);
});
},forEachColumn:function(l){this.forEach(function(m){m.forEachColumn(l);
});
},adjust:function(o,l,r,q,n,p,m){return this.map(function(s){return s.adjust(o,l,r,q,n,p,m);
}).simplify();
},toString:function(){return this.refs.map(function(l){return l.toString();
}).join(", ");
}});
j.NULLREF=f;
j.SHEETREF=new h(new a(0,0),new a(Infinity,Infinity));
j.FIRSTREF=new a(0,0);
j.Ref=i;
j.NameRef=e;
j.CellRef=a;
j.RangeRef=h;
j.UnionRef=k;
j.SHEETREF.print=function(){return"#SHEET";
};
})();
(function(){(function(c){var d=c.spreadsheet.RangeRef;
var a=c.spreadsheet.CellRef;
var b=c.Class.extend({init:function(g,f,h,i){this.rangeGetter=h;
this.prevLeft=function(k){var j=i(this.range(k));
var l=this.range(f.prevVisible(j.topLeft[g]));
return i(l).topLeft[g];
};
this.nextRight=function(k){var j=i(this.range(k));
var l=this.range(f.nextVisible(j.bottomRight[g]));
return i(l).bottomRight[g];
};
this.nextLeft=function(j){var k=i(this.range(j));
return f.nextVisible(k.bottomRight[g]);
};
this.prevRight=function(j){var k=i(this.range(j));
return f.prevVisible(k.topLeft[g]);
};
},boundary:function(g,f){this.top=g;
this.bottom=f;
},range:function(f){return this.rangeGetter(f,this.top,this.bottom);
}});
var e=c.Class.extend({init:function(f){this._sheet=f;
this.columns=this._sheet._grid._columns;
this.colEdge=new b("col",this._sheet._grid._columns,this.columnRange.bind(this),this.union.bind(this));
this.rowEdge=new b("row",this._sheet._grid._rows,this.rowRange.bind(this),this.union.bind(this));
},height:function(f){this._viewPortHeight=f;
},union:function(f){return this._sheet.unionWithMerged(f);
},columnRange:function(g,h,f){return this._sheet._ref(h,g,f-h,1);
},rowRange:function(h,f,g){return this._sheet._ref(h,f,1,g-f);
},selectionIncludesMergedCells:function(){return this._sheet.select().contains(this._sheet._mergedCells);
},setSelectionValue:function(g){var f=this._sheet.selection();
setTimeout(function(){f.value(g());
});
},selectAll:function(){this._sheet.select(this._sheet._sheetRef);
},select:function(h,g,f){h=this.refForMode(h,g);
if(f){h=this._sheet.select().concat(h);
}this._sheet.select(h);
},refForMode:function(h,g){var f=this._sheet._grid;
switch(g){case"range":h=f.normalize(h);
break;
case"row":h=f.rowRef(h.row);
break;
case"column":h=f.colRef(h.col);
break;
case"sheet":h=this._sheet._sheetRef;
break;
}return h;
},startSelection:function(h,g,f){this._sheet.startSelection();
this.select(h,g,f);
},completeSelection:function(){this._sheet.completeSelection();
},selectForContextMenu:function(g,f){var h=this._sheet;
if(!h.select().contains(this.refForMode(g,f))){this.select(g,f);
}},modifySelection:function(f){var j=this.determineDirection(f);
var p=this._sheet;
var r=this._viewPortHeight;
var m=p._grid._rows;
var i=p._grid._columns;
var l=p.currentOriginalSelectionRange();
var o=p.currentSelectionRange();
var g=p.activeCell();
var q=l.topLeft.clone();
var h=l.bottomRight.clone();
var n;
this.colEdge.boundary(o.topLeft.row,o.bottomRight.row);
this.rowEdge.boundary(o.topLeft.col,o.bottomRight.col);
switch(j){case"expand-left":q.col=this.colEdge.prevLeft(q.col);
n=q;
break;
case"shrink-right":q.col=this.colEdge.nextLeft(q.col);
n=q;
break;
case"expand-right":h.col=this.colEdge.nextRight(h.col);
n=h;
break;
case"shrink-left":h.col=this.colEdge.prevRight(h.col);
n=h;
break;
case"expand-up":q.row=this.rowEdge.prevLeft(q.row);
n=q;
break;
case"shrink-down":q.row=this.rowEdge.nextLeft(q.row);
n=q;
break;
case"expand-down":h.row=this.rowEdge.nextRight(h.row);
n=h;
break;
case"shrink-up":h.row=this.rowEdge.prevRight(h.row);
n=h;
break;
case"expand-page-up":q.row=m.prevPage(q.row,r);
break;
case"shrink-page-up":h.row=m.prevPage(h.row,r);
break;
case"expand-page-down":h.row=m.nextPage(h.row,r);
break;
case"shrink-page-down":q.row=m.nextPage(q.row,r);
break;
case"first-col":q.col=i.firstVisible();
h.col=g.bottomRight.col;
n=q;
break;
case"last-col":h.col=i.lastVisible();
q.col=g.topLeft.col;
n=h;
break;
case"first-row":q.row=m.firstVisible();
h.row=g.bottomRight.row;
n=q;
break;
case"last-row":h.col=m.lastVisible();
q.row=g.topLeft.row;
n=h;
break;
case"last":h.row=m.lastVisible();
h.col=i.lastVisible();
q=g.topLeft;
n=h;
break;
case"first":q.row=m.firstVisible();
q.col=i.firstVisible();
h=g.bottomRight;
n=q;
break;
}var k=new d(q,h);
if(!this.union(k).intersects(g)){this.modifySelection(j.replace("shrink","expand"));
return;
}if(n){p.focus(n);
}this.updateCurrentSelectionRange(k);
},moveActiveCell:function(k){var n=this._sheet;
var f=n.activeCell();
var o=f.topLeft;
var g=f.bottomRight;
var h=n.originalActiveCell();
var m=n._grid._rows;
var j=n._grid._columns;
var l=h.row;
var i=h.col;
switch(k){case"left":i=j.prevVisible(o.col);
break;
case"up":l=m.prevVisible(o.row);
break;
case"right":i=j.nextVisible(g.col);
break;
case"down":l=m.nextVisible(g.row);
break;
case"first-col":i=j.firstVisible();
break;
case"last-col":i=j.lastVisible();
break;
case"first-row":l=m.firstVisible();
break;
case"last-row":l=m.lastVisible();
break;
case"last":l=m.lastVisible();
i=j.lastVisible();
break;
case"first":l=m.firstVisible();
i=j.firstVisible();
break;
case"next-page":l=m.nextPage(g.row,this._viewPortHeight);
break;
case"prev-page":l=m.prevPage(g.row,this._viewPortHeight);
break;
}n.select(new a(l,i));
},navigateInSelection:function(k){var r=this._sheet;
var f=r.activeCell();
var s=f.topLeft;
var g=r.originalActiveCell();
var n=r._grid._rows;
var i=r._grid._columns;
var m=g.row;
var h=g.col;
var p=r.currentSelectionRange();
var q=p.topLeft;
var o=p.bottomRight;
var l=false;
var t=s.col;
var u=s.row;
while(!l){var j=new a(m,h);
switch(k){case"next":if(o.eq(j)){p=r.nextSelectionRange();
m=p.topLeft.row;
h=p.topLeft.col;
}else{h=i.nextVisible(t,true);
if(h>o.col){h=q.col;
m=n.nextVisible(m,true);
}}break;
case"previous":if(q.eq(j)){p=r.previousSelectionRange();
m=p.bottomRight.row;
h=p.bottomRight.col;
}else{h=i.prevVisible(t,true);
if(h<q.col){h=o.col;
m=n.prevVisible(m,true);
}}break;
case"lower":if(o.eq(j)){p=r.nextSelectionRange();
m=p.topLeft.row;
h=p.topLeft.col;
}else{m=n.nextVisible(u,true);
if(m>o.row){m=q.row;
h=i.nextVisible(h,true);
}}break;
case"upper":if(q.eq(j)){p=r.previousSelectionRange();
m=p.bottomRight.row;
h=p.bottomRight.col;
}else{m=n.prevVisible(u,true);
if(m<q.row){m=o.row;
h=i.prevVisible(h,true);
}}break;
default:throw new Error("Unknown entry navigation: "+k);
}l=!this.shouldSkip(m,h);
t=h;
u=m;
}if(r.singleCellSelection()){r.select(new a(m,h));
}else{r.activeCell(new a(m,h));
}},extendSelection:function(i,h){var j=this._sheet;
var g=j._grid;
if(h==="range"){i=g.normalize(i);
}if(h==="row"){i=g.rowRef(i.row).bottomRight;
}else{if(h==="column"){i=g.colRef(i.col).bottomRight;
}}var f=j.originalActiveCell().toRangeRef();
this.updateCurrentSelectionRange(new d(f.topLeft,i));
},shouldSkip:function(i,f){var h=new a(i,f);
var g=false;
this._sheet.forEachMergedCell(function(j){if(j.intersects(h)&&!j.collapse().eq(h)){g=true;
}});
return g;
},determineDirection:function(f){var k=this._sheet.currentSelectionRange();
var g=this._sheet.activeCell();
var i=g.topLeft.col==k.topLeft.col;
var j=g.bottomRight.col==k.bottomRight.col;
var l=g.topLeft.row==k.topLeft.row;
var h=g.bottomRight.row==k.bottomRight.row;
switch(f){case"left":f=j?"expand-left":"shrink-left";
break;
case"right":f=i?"expand-right":"shrink-right";
break;
case"up":f=h?"expand-up":"shrink-up";
break;
case"down":f=l?"expand-down":"shrink-down";
break;
case"prev-page":f=h?"expand-page-up":"shrink-page-up";
break;
case"next-page":f=l?"expand-page-down":"shrink-page-down";
break;
}return f;
},updateCurrentSelectionRange:function(f){var g=this._sheet;
g.select(g.originalSelect().replaceAt(g.selectionRangeIndex(),f),false);
}});
c.spreadsheet.SheetNavigator=e;
})(kendo);
})();
(function(){(function(b){var a=b.Class.extend({init:function(c){this._sheet=c;
},forEachSelectedColumn:function(c){var d=this._sheet;
d.batch(function(){d.select().forEachColumnIndex(function(f,e){c(d,f,e);
});
},{layout:true,recalc:true});
},forEachSelectedRow:function(c){var d=this._sheet;
d.batch(function(){d.select().forEachRowIndex(function(f,e){c(d,f,e);
});
},{layout:true,recalc:true});
},includesHiddenColumns:function(c){return this._sheet._grid._columns.includesHidden(c.topLeft.col,c.bottomRight.col);
},includesHiddenRows:function(c){return this._sheet._grid._rows.includesHidden(c.topLeft.row,c.bottomRight.row);
},selectionIncludesHiddenColumns:function(){return this.includesHiddenColumns(this._sheet.select());
},selectionIncludesHiddenRows:function(){return this.includesHiddenRows(this._sheet.select());
},deleteSelectedColumns:function(){this.forEachSelectedColumn(function(e,d,c){e.deleteColumn(d-c);
});
},deleteSelectedRows:function(){this.forEachSelectedRow(function(e,d,c){e.deleteRow(d-c);
});
},hideSelectedColumns:function(){this.forEachSelectedColumn(function(d,c){d.hideColumn(c);
});
},hideSelectedRows:function(){this.forEachSelectedRow(function(d,c){d.hideRow(c);
});
},unhideSelectedColumns:function(){this.forEachSelectedColumn(function(d,c){d.unhideColumn(c);
});
},unhideSelectedRows:function(){this.forEachSelectedRow(function(d,c){d.unhideRow(c);
});
},addColumnLeft:function(){this.forEachSelectedColumn(function(e,d,c){e.insertColumn(d-c);
});
},addColumnRight:function(){this.forEachSelectedColumn(function(e,d,c){e.insertColumn(d+(c+1));
});
},canAddRow:function(){var c=this._sheet.select().toRangeRef();
var d=c.height();
return this._sheet.canInsertRow(0,d);
},addRowAbove:function(){this.forEachSelectedRow(function(e,d,c){e.insertRow(d-c);
});
},addRowBelow:function(){this.forEachSelectedRow(function(e,d,c){e.insertRow(d+(c+1));
});
}});
b.spreadsheet.AxisManager=a;
})(kendo);
})();
(function(){(function(d){var a=d.jQuery;
var e=d.spreadsheet.RangeRef;
var b=d.spreadsheet.CellRef;
var c=d.Class.extend({init:function(f){this.workbook=f;
this.origin=d.spreadsheet.NULLREF;
this.iframe=document.createElement("iframe");
this.iframe.className="k-spreadsheet-clipboard-paste";
this._external={};
this._uid=d.guid();
document.body.appendChild(this.iframe);
},canCopy:function(){var f=this.workbook.activeSheet().select();
if(f===d.spreadsheet.NULLREF){return false;
}if(f instanceof d.spreadsheet.UnionRef){return false;
}return true;
},canPaste:function(){var g=this.workbook.activeSheet();
var f=this.pasteRef();
if(f===d.spreadsheet.NULLREF){return this._external.hasOwnProperty("html")||this._external.hasOwnProperty("plain");
}return f.eq(g.unionWithMerged(f));
},copy:function(){var f=this.workbook.activeSheet();
this.origin=f.select();
this.contents=f.selection().getState();
},cut:function(){var f=this.workbook.activeSheet();
this.copy();
f.range(f.select()).clear();
},pasteRef:function(){var j=this.workbook.activeSheet();
var g=j.activeCell().first();
var h=this.origin.first();
var i=h.row-g.row;
var f=h.col-g.col;
return this.origin.relative(i,f,3);
},destroy:function(){document.body.removeChild(this.iframe);
},paste:function(){var i={};
var m=this.workbook.activeSheet();
if(this._isInternal()){i=this.contents;
}else{var l=[];
var h=[];
i=this.parse(this._external);
for(var j in i){if(j==="mergedCells"||j==="ref"){continue;
}var f=j.split(",");
l.push(f[0]);
h.push(f[1]);
}var n=new b(Math.min.apply(null,l),Math.min.apply(null,h));
var g=new b(Math.max.apply(null,l),Math.max.apply(null,h));
this.origin=new e(n,g,0);
}var k=this.pasteRef();
m.range(k).clear().setState(i);
m.triggerChange({recalc:true});
},external:function(f){if(f.html||f.plain){this._external=f;
}else{return this._external;
}},parse:function(f){var i={ref:new b(0,0,0),mergedCells:[]};
if(f.html){var g=this.iframe.contentWindow.document;
g.open();
g.write(f.html);
g.close();
var j=a(g).find("table:first");
if(j.length){i=this._parseHTML(j.find("tbody:first"));
}else{if(!f.plain){var h=a(g.body).find(":not(style)");
i["0,0"]=this._cellState(h.text());
}else{i=this._parseTSV(f.plain);
}}}else{i=this._parseTSV(f.plain);
}return i;
},_parseHTML:function(g){var h=this;
var f={ref:new b(0,0,0),mergedCells:[]};
g.find("tr").each(function(i,j){a(j).find("td").each(function(m,t){var s=parseInt(a(t).attr("rowspan"),10)-1||0;
var n=parseInt(a(t).attr("colspan"),10)-1||0;
var k="<td/>";
var l;
if(s){var o=i+s;
for(var q=i;
q<=o;
q++){var r=g.find("tr").eq(q);
if(q>i){k="<td class='rowspan'></td>";
if(m===0){r.find("td").eq(m).after(k);
}else{var p=Math.min(r.find("td").length,m);
r.find("td").eq(p-1).after(k);
}}if(n){for(l=m;
l<n+m;
l++){k="<td class='rowspan colspan'></td>";
r.find("td").eq(l).after(k);
}}}}else{if(n){for(l=m;
l<n+m;
l++){k="<td class='colspan'></td>";
a(j).find("td").eq(l).after(k);
}}}});
});
g.find("tr").each(function(i,j){a(j).find("td").each(function(m,s){var p=i+","+m;
var q=parseInt(a(s).attr("rowspan"),10)-1||0;
var n=parseInt(a(s).attr("colspan"),10)-1||0;
var l=h._cellState(a(s));
f[p]=l;
if(q||n){var r=String.fromCharCode(65+m);
var o=String.fromCharCode(65+m+n);
var k=r+(i+1)+":"+o+(i+1+q);
f.mergedCells.push(k);
}});
});
return f;
},_parseTSV:function(h){var k={ref:new b(0,0,0),mergedCells:[]};
if(h.indexOf("\t")===-1&&h.indexOf("\n")==-1){k["0,0"]={value:h};
}else{var j=h.split("\n");
for(var i=0;
i<j.length;
i++){var g=j[i].split("\t");
for(var f=0;
f<g.length;
f++){k[i+","+f]={value:g[f]};
}}}return k;
},_isInternal:function(){if(this._external.html===undefined){return true;
}return a("<div/>").html(this._external.html).find("table.kendo-clipboard-"+this._uid).length?true:false;
},_cellState:function(g){var i=window.getComputedStyle(g[0]);
var j=g.text();
var f=this._borderObject(i);
var h={value:j===""?null:j,borderBottom:f.borderBottom,borderRight:f.borderRight,borderLeft:f.borderLeft,borderTop:f.borderTop,fontSize:parseInt(i["font-size"],10)};
if(i["background-color"]!=="rgb(0, 0, 0)"&&i["background-color"]!=="rgba(0, 0, 0, 0)"){h.background=i["background-color"];
}if(i.color!=="rgb(0, 0, 0)"&&i.color!=="rgba(0, 0, 0, 0)"){h.color=i.color;
}if(i["text-decoration"]=="underline"){h.underline=true;
}if(i["font-style"]=="italic"){h.italic=true;
}if(i["font-weight"]=="bold"){h.bold=true;
}if(this._strippedStyle(i["text-align"])!=="right"){h.textAlign=this._strippedStyle(i["text-align"]);
}if(i["vertical-align"]!=="middle"){h.verticalAlign=i["vertical-align"];
}if(i["word-wrap"]!=="normal"){h.wrap=true;
}return h;
},_strippedStyle:function(g){var f=["-ms-","-moz-","-webkit-"];
f.forEach(function(h){g=g.replace(h,"");
});
return g;
},_borderObject:function(h){var f={};
var g=["borderBottom","borderRight","borderLeft","borderTop"];
g.forEach(function(i){if(h[i+"Style"]=="none"){f[i]=null;
return;
}f[i]={size:"1px",color:h[i+"Color"]};
});
return f;
}});
d.spreadsheet.Clipboard=c;
})(kendo);
})();
(function(){(function(a){var t=Math,q=window.kendo,h=q.deepExtend,g=q.dataviz;
var k=t.PI/180,u=Number.MAX_VALUE,w=-Number.MAX_VALUE,S="undefined",n=a.inArray,B=[].push,z=[].pop,Q=[].splice,L=[].shift,M=[].slice,T=[].unshift;
function i(V){return typeof V!==S;
}function K(X,W){var V=A(W);
return t.round(X*V)/V;
}function A(V){if(V){return t.pow(10,V);
}else{return 1;
}}function s(X,W,V){return t.max(t.min(X,V),W);
}function C(V){return V*k;
}function j(V){return V/k;
}function o(V){return typeof V==="number"&&!isNaN(V);
}function U(W,V){return i(W)?W:V;
}function R(V){return V*V;
}function y(W){var X=[];
for(var V in W){X.push(V+W[V]);
}return X.sort().join("");
}function l(X){var V=2166136261;
for(var W=0;
W<X.length;
++W){V+=(V<<1)+(V<<4)+(V<<7)+(V<<8)+(V<<24);
V^=X.charCodeAt(W);
}return V>>>0;
}function m(V){return l(y(V));
}var x=Date.now;
if(!x){x=function(){return new Date().getTime();
};
}function d(V){var X=V.length,W,Z=u,Y=w;
for(W=0;
W<X;
W++){Y=t.max(Y,V[W]);
Z=t.min(Z,V[W]);
}return{min:Z,max:Y};
}function f(V){return d(V).min;
}function e(V){return d(V).max;
}function P(V){return N(V).min;
}function O(V){return N(V).max;
}function N(V){var Z=u,Y=w;
for(var W=0,X=V.length;
W<X;
W++){var aa=V[W];
if(aa!==null&&isFinite(aa)){Z=t.min(Z,aa);
Y=t.max(Y,aa);
}}return{min:Z===u?undefined:Z,max:Y===w?undefined:Y};
}function r(V){if(V){return V[V.length-1];
}}function b(V,W){V.push.apply(V,W);
return V;
}function I(V){return q.template(V,{useWithBlock:false,paramName:"d"});
}function E(V,W){return(i(W)&&W!==null)?" "+V+"='"+W+"' ":"";
}function D(V){var X="";
for(var W=0;
W<V.length;
W++){X+=E(V[W][0],V[W][1]);
}return X;
}function H(V){var X="";
for(var W=0;
W<V.length;
W++){var Y=V[W][1];
if(i(Y)){X+=V[W][0]+":"+Y+";";
}}if(X!==""){return X;
}}function G(V){if(typeof V!=="string"){V+="px";
}return V;
}function F(X){var Y=[];
if(X){var W=q.toHyphens(X).split("-");
for(var V=0;
V<W.length;
V++){Y.push("k-pos-"+W[V]);
}}return Y.join(" ");
}function p(V){return V===""||V===null||V==="none"||V==="transparent"||!i(V);
}function c(W){var V={1:"i",10:"x",100:"c",2:"ii",20:"xx",200:"cc",3:"iii",30:"xxx",300:"ccc",4:"iv",40:"xl",400:"cd",5:"v",50:"l",500:"d",6:"vi",60:"lx",600:"dc",7:"vii",70:"lxx",700:"dcc",8:"viii",80:"lxxx",800:"dccc",9:"ix",90:"xc",900:"cm",1000:"m"};
var Y=[1000,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1];
var X="";
while(W>0){if(W<Y[0]){Y.shift();
}else{X+=V[Y[0]];
W-=Y[0];
}}return X;
}function J(Y){Y=Y.toLowerCase();
var V={i:1,v:5,x:10,l:50,c:100,d:500,m:1000};
var aa=0,X=0;
for(var W=0;
W<Y.length;
++W){var Z=V[Y.charAt(W)];
if(!Z){return null;
}aa+=Z;
if(Z>X){aa-=2*X;
}X=Z;
}return aa;
}function v(W){var V=Object.create(null);
return function(){var Y="";
for(var X=arguments.length;
--X>=0;
){Y+=":"+arguments[X];
}if(Y in V){return V[Y];
}return W.apply(this,arguments);
};
}h(q,{util:{MAX_NUM:u,MIN_NUM:w,append:b,arrayLimits:d,arrayMin:f,arrayMax:e,defined:i,deg:j,hashKey:l,hashObject:m,isNumber:o,isTransparent:p,last:r,limitValue:s,now:x,objectKey:y,round:K,rad:C,renderAttr:E,renderAllAttr:D,renderPos:F,renderSize:G,renderStyle:H,renderTemplate:I,sparseArrayLimits:N,sparseArrayMin:P,sparseArrayMax:O,sqr:R,valueOrDefault:U,romanToArabic:J,arabicToRoman:c,memoize:v}});
q.dataviz.util=q.util;
})(window.kendo.jQuery);
})();
(function(){(function(a){var e=Math,d=window.kendo,b=d.deepExtend,c=a.inArray;
var f={observers:function(){this._observers=this._observers||[];
return this._observers;
},addObserver:function(g){if(!this._observers){this._observers=[g];
}else{this._observers.push(g);
}return this;
},removeObserver:function(g){var i=this.observers();
var h=c(g,i);
if(h!=-1){i.splice(h,1);
}return this;
},trigger:function(i,g){var k=this._observers;
var j;
var h;
if(k&&!this._suspended){for(h=0;
h<k.length;
h++){j=k[h];
if(j[i]){j[i](g);
}}}return this;
},optionsChange:function(g){this.trigger("optionsChange",g);
},geometryChange:function(g){this.trigger("geometryChange",g);
},suspend:function(){this._suspended=(this._suspended||0)+1;
return this;
},resume:function(){this._suspended=e.max((this._suspended||0)-1,0);
return this;
},_observerField:function(g,h){if(this[g]){this[g].removeObserver(this);
}this[g]=h;
h.addObserver(this);
}};
b(d,{mixins:{ObserversMixin:f}});
})(window.kendo.jQuery);
})();
(function(){(function(a){var p=Math,x=p.pow,n=a.inArray,o=window.kendo,f=o.Class,g=o.deepExtend,u=o.mixins.ObserversMixin,G=o.util,i=G.defined,y=G.rad,j=G.deg,A=G.round;
var v=p.PI/2,s=G.MIN_NUM,r=G.MAX_NUM;
var w=f.extend({init:function(H,I){this.x=H||0;
this.y=I||0;
},equals:function(H){return H&&H.x===this.x&&H.y===this.y;
},clone:function(){return new w(this.x,this.y);
},rotate:function(H,I){return this.transform(E().rotate(H,I));
},translate:function(H,I){this.x+=H;
this.y+=I;
this.geometryChange();
return this;
},translateWith:function(H){return this.translate(H.x,H.y);
},move:function(H,I){this.x=this.y=0;
return this.translate(H,I);
},scale:function(H,I){if(!i(I)){I=H;
}this.x*=H;
this.y*=I;
this.geometryChange();
return this;
},scaleCopy:function(H,I){return this.clone().scale(H,I);
},transform:function(I){var H=D(I),J=this.x,K=this.y;
this.x=H.a*J+H.c*K+H.e;
this.y=H.b*J+H.d*K+H.f;
this.geometryChange();
return this;
},transformCopy:function(I){var H=this.clone();
if(I){H.transform(I);
}return H;
},distanceTo:function(J){var H=this.x-J.x;
var I=this.y-J.y;
return p.sqrt(H*H+I*I);
},round:function(H){this.x=A(this.x,H);
this.y=A(this.y,H);
this.geometryChange();
return this;
},toArray:function(H){var I=i(H);
var J=I?A(this.x,H):this.x;
var K=I?A(this.y,H):this.y;
return[J,K];
}});
h(w.fn,["x","y"]);
g(w.fn,u);
w.fn.toString=function(H,I){var J=this.x,K=this.y;
if(i(H)){J=A(J,H);
K=A(K,H);
}I=I||" ";
return J+I+K;
};
w.create=function(H,I){if(i(H)){if(H instanceof w){return H;
}else{if(arguments.length===1&&H.length===2){return new w(H[0],H[1]);
}else{return new w(H,I);
}}}};
w.min=function(){var I=G.MAX_NUM;
var J=G.MAX_NUM;
for(var H=0;
H<arguments.length;
H++){var K=arguments[H];
I=p.min(K.x,I);
J=p.min(K.y,J);
}return new w(I,J);
};
w.max=function(K,L){var I=G.MIN_NUM;
var J=G.MIN_NUM;
for(var H=0;
H<arguments.length;
H++){var M=arguments[H];
I=p.max(M.x,I);
J=p.max(M.y,J);
}return new w(I,J);
};
w.minPoint=function(){return new w(s,s);
};
w.maxPoint=function(){return new w(r,r);
};
w.ZERO=new w(0,0);
var C=f.extend({init:function(I,H){this.width=I||0;
this.height=H||0;
},equals:function(H){return H&&H.width===this.width&&H.height===this.height;
},clone:function(){return new C(this.width,this.height);
},toArray:function(H){var I=i(H);
var K=I?A(this.width,H):this.width;
var J=I?A(this.height,H):this.height;
return[K,J];
}});
h(C.fn,["width","height"]);
g(C.fn,u);
C.create=function(H,I){if(i(H)){if(H instanceof C){return H;
}else{if(arguments.length===1&&H.length===2){return new C(H[0],H[1]);
}else{return new C(H,I);
}}}};
C.ZERO=new C(0,0);
var z=f.extend({init:function(H,I){this.setOrigin(H||new w());
this.setSize(I||new C());
},clone:function(){return new z(this.origin.clone(),this.size.clone());
},equals:function(H){return H&&H.origin.equals(this.origin)&&H.size.equals(this.size);
},setOrigin:function(H){this._observerField("origin",w.create(H));
this.geometryChange();
return this;
},getOrigin:function(){return this.origin;
},setSize:function(H){this._observerField("size",C.create(H));
this.geometryChange();
return this;
},getSize:function(){return this.size;
},width:function(){return this.size.width;
},height:function(){return this.size.height;
},topLeft:function(){return this.origin.clone();
},bottomRight:function(){return this.origin.clone().translate(this.width(),this.height());
},topRight:function(){return this.origin.clone().translate(this.width(),0);
},bottomLeft:function(){return this.origin.clone().translate(0,this.height());
},center:function(){return this.origin.clone().translate(this.width()/2,this.height()/2);
},bbox:function(J){var K=this.topLeft().transformCopy(J);
var L=this.topRight().transformCopy(J);
var I=this.bottomRight().transformCopy(J);
var H=this.bottomLeft().transformCopy(J);
return z.fromPoints(K,L,I,H);
},transformCopy:function(H){return z.fromPoints(this.topLeft().transform(H),this.bottomRight().transform(H));
}});
g(z.fn,u);
z.fromPoints=function(){var J=w.min.apply(this,arguments);
var H=w.max.apply(this,arguments);
var I=new C(H.x-J.x,H.y-J.y);
return new z(J,I);
};
z.union=function(H,I){return z.fromPoints(w.min(H.topLeft(),I.topLeft()),w.max(H.bottomRight(),I.bottomRight()));
};
z.intersect=function(H,I){H={left:H.topLeft().x,top:H.topLeft().y,right:H.bottomRight().x,bottom:H.bottomRight().y};
I={left:I.topLeft().x,top:I.topLeft().y,right:I.bottomRight().x,bottom:I.bottomRight().y};
if(H.left<=I.right&&I.left<=H.right&&H.top<=I.bottom&&I.top<=H.bottom){return z.fromPoints(new w(p.max(H.left,I.left),p.max(H.top,I.top)),new w(p.min(H.right,I.right),p.min(H.bottom,I.bottom)));
}};
var e=f.extend({init:function(H,I){this.setCenter(H||new w());
this.setRadius(I||0);
},setCenter:function(H){this._observerField("center",w.create(H));
this.geometryChange();
return this;
},getCenter:function(){return this.center;
},equals:function(H){return H&&H.center.equals(this.center)&&H.radius===this.radius;
},clone:function(){return new e(this.center.clone(),this.radius);
},pointAt:function(H){return this._pointAt(y(H));
},bbox:function(M){var O=w.maxPoint();
var N=w.minPoint();
var K=l(this.center,this.radius,this.radius,M);
for(var L=0;
L<4;
L++){var I=this._pointAt(K.x+L*v).transformCopy(M);
var J=this._pointAt(K.y+L*v).transformCopy(M);
var H=new w(I.x,J.y);
O=w.min(O,H);
N=w.max(N,H);
}return z.fromPoints(O,N);
},_pointAt:function(H){var I=this.center;
var J=this.radius;
return new w(I.x-J*p.cos(H),I.y-J*p.sin(H));
}});
h(e.fn,["radius"]);
g(e.fn,u);
var b=f.extend({init:function(H,I){this.setCenter(H||new w());
I=I||{};
this.radiusX=I.radiusX;
this.radiusY=I.radiusY||I.radiusX;
this.startAngle=I.startAngle;
this.endAngle=I.endAngle;
this.anticlockwise=I.anticlockwise||false;
},clone:function(){return new b(this.center,{radiusX:this.radiusX,radiusY:this.radiusY,startAngle:this.startAngle,endAngle:this.endAngle,anticlockwise:this.anticlockwise});
},setCenter:function(H){this._observerField("center",w.create(H));
this.geometryChange();
return this;
},getCenter:function(){return this.center;
},MAX_INTERVAL:45,pointAt:function(H){var I=this.center;
var J=y(H);
return new w(I.x+this.radiusX*p.cos(J),I.y+this.radiusY*p.sin(J));
},curvePoints:function(){var Q=this.startAngle;
var K=this.endAngle;
var J=this.anticlockwise?-1:1;
var I=[this.pointAt(Q)];
var H=Q;
var M=this._arcInterval();
var N=M.endAngle-M.startAngle;
var S=p.ceil(N/this.MAX_INTERVAL);
var R=N/S;
for(var L=1;
L<=S;
L++){var O=H+J*R;
var P=this._intervalCurvePoints(H,O);
I.push(P.cp1,P.cp2,P.p2);
H=O;
}return I;
},bbox:function(T){var H=this;
var S=H._arcInterval();
var W=S.startAngle;
var N=S.endAngle;
var P=l(this.center,this.radiusX,this.radiusY,T);
var Q=j(P.x);
var R=j(P.y);
var K=H.pointAt(W).transformCopy(T);
var O=H.pointAt(N).transformCopy(T);
var V=w.min(K,O);
var U=w.max(K,O);
var I=c(Q,W);
var J=c(R,W);
while(I<N||J<N){var L;
if(I<N){L=H.pointAt(I).transformCopy(T);
I+=90;
}var M;
if(J<N){M=H.pointAt(J).transformCopy(T);
J+=90;
}K=new w(L.x,M.y);
V=w.min(V,K);
U=w.max(U,K);
}return z.fromPoints(V,U);
},_arcInterval:function(){var K=this.startAngle;
var I=this.endAngle;
var H=this.anticlockwise;
if(H){var J=K;
K=I;
I=J;
}if(K>I||(H&&K===I)){I+=360;
}return{startAngle:K,endAngle:I};
},_intervalCurvePoints:function(P,K){var H=this;
var L=H.pointAt(P);
var N=H.pointAt(K);
var M=H._derivativeAt(P);
var O=H._derivativeAt(K);
var Q=(y(K)-y(P))/3;
var I=new w(L.x+Q*M.x,L.y+Q*M.y);
var J=new w(N.x-Q*O.x,N.y-Q*O.y);
return{p1:L,cp1:I,cp2:J,p2:N};
},_derivativeAt:function(H){var I=this;
var J=y(H);
return new w(-I.radiusX*p.sin(J),I.radiusY*p.cos(J));
}});
h(b.fn,["radiusX","radiusY","startAngle","endAngle","anticlockwise"]);
g(b.fn,u);
b.fromPoints=function(M,I,K,L,J,N){var H=t(M.x,M.y,I.x,I.y,K,L,J,N);
return new b(H.center,{startAngle:H.startAngle,endAngle:H.endAngle,radiusX:K,radiusY:L,anticlockwise:N===0});
};
var q=f.extend({init:function(H,I,J,K,L,M){this.a=H||0;
this.b=I||0;
this.c=J||0;
this.d=K||0;
this.e=L||0;
this.f=M||0;
},multiplyCopy:function(H){return new q(this.a*H.a+this.c*H.b,this.b*H.a+this.d*H.b,this.a*H.c+this.c*H.d,this.b*H.c+this.d*H.d,this.a*H.e+this.c*H.f+this.e,this.b*H.e+this.d*H.f+this.f);
},invert:function(){var H=this.a,I=this.b;
var J=this.c,L=this.d;
var M=this.e,N=this.f;
var K=H*L-I*J;
if(K===0){return null;
}return new q(L/K,-I/K,-J/K,H/K,(J*N-L*M)/K,(I*M-H*N)/K);
},clone:function(){return new q(this.a,this.b,this.c,this.d,this.e,this.f);
},equals:function(H){if(!H){return false;
}return this.a===H.a&&this.b===H.b&&this.c===H.c&&this.d===H.d&&this.e===H.e&&this.f===H.f;
},round:function(H){this.a=A(this.a,H);
this.b=A(this.b,H);
this.c=A(this.c,H);
this.d=A(this.d,H);
this.e=A(this.e,H);
this.f=A(this.f,H);
return this;
},toArray:function(J){var H=[this.a,this.b,this.c,this.d,this.e,this.f];
if(i(J)){for(var I=0;
I<H.length;
I++){H[I]=A(H[I],J);
}}return H;
}});
q.fn.toString=function(H,I){return this.toArray(H).join(I||",");
};
q.translate=function(H,I){return new q(1,0,0,1,H,I);
};
q.unit=function(){return new q(1,0,0,1,0,0);
};
q.rotate=function(H,J,K){var I=new q();
I.a=p.cos(y(H));
I.b=p.sin(y(H));
I.c=-I.b;
I.d=I.a;
I.e=(J-J*I.a+K*I.b)||0;
I.f=(K-K*I.a-J*I.b)||0;
return I;
};
q.scale=function(H,I){return new q(H,0,0,I,0,0);
};
q.IDENTITY=q.unit();
var F=f.extend({init:function(H){this._matrix=H||q.unit();
},clone:function(){return new F(this._matrix.clone());
},equals:function(H){return H&&H._matrix.equals(this._matrix);
},_optionsChange:function(){this.optionsChange({field:"transform",value:this});
},translate:function(H,I){this._matrix=this._matrix.multiplyCopy(q.translate(H,I));
this._optionsChange();
return this;
},scale:function(I,J,H){if(!i(J)){J=I;
}if(H){H=w.create(H);
this._matrix=this._matrix.multiplyCopy(q.translate(H.x,H.y));
}this._matrix=this._matrix.multiplyCopy(q.scale(I,J));
if(H){this._matrix=this._matrix.multiplyCopy(q.translate(-H.x,-H.y));
}this._optionsChange();
return this;
},rotate:function(H,I){I=w.create(I)||w.ZERO;
this._matrix=this._matrix.multiplyCopy(q.rotate(H,I.x,I.y));
this._optionsChange();
return this;
},multiply:function(I){var H=D(I);
this._matrix=this._matrix.multiplyCopy(H);
this._optionsChange();
return this;
},matrix:function(){return this._matrix;
}});
g(F.fn,u);
function E(H){if(H===null){return null;
}if(H instanceof F){return H;
}return new F(H);
}function D(H){if(H&&o.isFunction(H.matrix)){return H.matrix();
}return H;
}function l(H,L,M,K){var I=0,J=0;
if(K){I=p.atan2(K.c*M,K.a*L);
if(K.b!==0){J=p.atan2(K.d*M,K.b*L);
}}return{x:I,y:J};
}function c(H,I){while(H<I){H+=90;
}return H;
}function h(J,I){for(var K=0;
K<I.length;
K++){var L=I[K];
var H=L.charAt(0).toUpperCase()+L.substring(1,L.length);
J["set"+H]=B(L);
J["get"+H]=m(L);
}}function B(H){return function(I){if(this[H]!==I){this[H]=I;
this.geometryChange();
}return this;
};
}function m(H){return function(){return this[H];
};
}function k(J,I,K){if(J>I){I+=360;
}var H=p.abs(I-J);
if(!K){H=360-H;
}return H;
}function d(I,J,K,L,N,O){var H=A((N-I)/K,3);
var M=A((O-J)/L,3);
return A(j(p.atan2(M,H)));
}function t(aa,ad,ab,ae,T,V,S,Z){var L,N;
var M,O;
var H,J,K,X;
if(ad!==ae){var ac=ab-aa;
var af=ae-ad;
var U=x(T,2),W=x(V,2);
var Q=(W*ac*(aa+ab)+U*af*(ad+ae))/(2*U*af);
var ag=Q-ae;
var R=-(ac*W)/(U*af);
H=1/U+x(R,2)/W;
J=2*((R*ag)/W-ab/U);
K=x(ab,2)/U+x(ag,2)/W-1;
X=p.sqrt(x(J,2)-4*H*K);
L=(-J-X)/(2*H);
N=Q+R*L;
M=(-J+X)/(2*H);
O=Q+R*M;
}else{if(aa!==ab){J=-2*ae;
K=x(((ab-aa)*V)/(2*T),2)+x(ae,2)-x(V,2);
X=p.sqrt(x(J,2)-4*K);
L=M=(aa+ab)/2;
N=(-J-X)/2;
O=(-J+X)/2;
}else{return false;
}}var Y=d(L,N,T,V,aa,ad);
var P=d(L,N,T,V,ab,ae);
var I=k(Y,P,Z);
if((S&&I<=180)||(!S&&I>180)){L=M;
N=O;
Y=d(L,N,T,V,aa,ad);
P=d(L,N,T,V,ab,ae);
}return{center:new w(L,N),startAngle:Y,endAngle:P};
}g(o,{geometry:{Arc:b,Circle:e,Matrix:q,Point:w,Rect:z,Size:C,Transformation:F,transform:E,toMatrix:D}});
o.dataviz.geometry=o.geometry;
})(window.kendo.jQuery);
})();
(function(){(function(a){var f=document,h=a.noop,l=Object.prototype.toString,g=window.kendo,c=g.Class,n=g.ui.Widget,d=g.deepExtend,m=g.util,e=m.defined;
var j=n.extend({init:function(o,p){this.options=d({},this.options,p);
n.fn.init.call(this,o,this.options);
this._click=this._handler("click");
this._mouseenter=this._handler("mouseenter");
this._mouseleave=this._handler("mouseleave");
this._visual=new g.drawing.Group();
if(this.options.width){this.element.css("width",this.options.width);
}if(this.options.height){this.element.css("height",this.options.height);
}},options:{name:"Surface"},events:["click","mouseenter","mouseleave","resize"],draw:function(o){this._visual.children.push(o);
},clear:function(){this._visual.children=[];
},destroy:function(){this._visual=null;
n.fn.destroy.call(this);
},exportVisual:function(){return this._visual;
},getSize:function(){return{width:this.element.width(),height:this.element.height()};
},setSize:function(o){this.element.css({width:o.width,height:o.height});
this._size=o;
this._resize();
},eventTarget:function(p){var o=a(p.touch?p.touch.initialTouch:p.target);
var q;
while(!q&&o.length>0){q=o[0]._kendoNode;
if(o.is(this.element)||o.length===0){break;
}o=o.parent();
}if(q){return q.srcElement;
}},_resize:h,_handler:function(o){var p=this;
return function(q){var r=p.eventTarget(q);
if(r){p.trigger(o,{element:r,originalEvent:q});
}};
}});
g.ui.plugin(j);
j.create=function(o,p){return k.current.create(o,p);
};
var b=c.extend({init:function(o){this.childNodes=[];
this.parent=null;
if(o){this.srcElement=o;
this.observe();
}},destroy:function(){if(this.srcElement){this.srcElement.removeObserver(this);
}var o=this.childNodes;
for(var p=0;
p<o.length;
p++){this.childNodes[p].destroy();
}this.parent=null;
},load:h,observe:function(){if(this.srcElement){this.srcElement.addObserver(this);
}},append:function(o){this.childNodes.push(o);
o.parent=this;
},insertAt:function(o,p){this.childNodes.splice(p,0,o);
o.parent=this;
},remove:function(r,o){var p=r+o;
for(var q=r;
q<p;
q++){this.childNodes[q].removeSelf();
}this.childNodes.splice(r,o);
},removeSelf:function(){this.clear();
this.destroy();
},clear:function(){this.remove(0,this.childNodes.length);
},invalidate:function(){if(this.parent){this.parent.invalidate();
}},geometryChange:function(){this.invalidate();
},optionsChange:function(){this.invalidate();
},childrenChange:function(o){if(o.action==="add"){this.load(o.items,o.index);
}else{if(o.action==="remove"){this.remove(o.index,o.items.length);
}}this.invalidate();
}});
var i=c.extend({init:function(q,r){var o,p;
this.prefix=r||"";
for(o in q){p=q[o];
p=this._wrap(p,o);
this[o]=p;
}},get:function(o){return g.getter(o,true)(this);
},set:function(q,r){var p=g.getter(q,true)(this);
if(p!==r){var o=this._set(q,this._wrap(r,q));
if(!o){this.optionsChange({field:this.prefix+q,value:r});
}}},_set:function(p,t){var o=p.indexOf(".")>=0;
if(o){var r=p.split("."),s="",q;
while(r.length>1){s+=r.shift();
q=g.getter(s,true)(this);
if(!q){q=new i({},s+".");
q.addObserver(this);
this[s]=q;
}if(q instanceof i){q.set(r.join("."),t);
return o;
}s+=".";
}}this._clear(p);
g.setter(p)(this,t);
return o;
},_clear:function(p){var o=g.getter(p,true)(this);
if(o&&o.removeObserver){o.removeObserver(this);
}},_wrap:function(p,o){var q=l.call(p);
if(p!==null&&e(p)&&q==="[object Object]"){if(!(p instanceof i)&&!(p instanceof c)){p=new i(p,this.prefix+o+".");
}p.addObserver(this);
}return p;
}});
d(i.fn,g.mixins.ObserversMixin);
var k=function(){this._items=[];
};
k.prototype={register:function(r,t,s){var q=this._items,p=q[0],o={name:r,type:t,order:s};
if(!p||s<p.order){q.unshift(o);
}else{q.push(o);
}},create:function(o,s){var q=this._items,r=q[0];
if(s&&s.type){var t=s.type.toLowerCase();
for(var p=0;
p<q.length;
p++){if(q[p].name===t){r=q[p];
break;
}}}if(r){return new r.type(o,s);
}g.logToConsole("Warning: Unable to create Kendo UI Drawing Surface. Possible causes:\n- The browser does not support SVG, VML and Canvas. User agent: "+navigator.userAgent+"\n- The Kendo UI scripts are not fully loaded");
}};
k.current=new k();
d(g,{drawing:{DASH_ARRAYS:{dot:[1.5,3.5],dash:[4,3.5],longdash:[8,3.5],dashdot:[3.5,3.5,1.5,3.5],longdashdot:[8,3.5,1.5,3.5],longdashdotdot:[8,3.5,1.5,3.5,1.5,3.5]},Color:g.Color,BaseNode:b,OptionsStore:i,Surface:j,SurfaceFactory:k}});
g.dataviz.drawing=g.drawing;
})(window.kendo.jQuery);
})();
(function(){(function(a){var f=document,g=window.kendo,b=g.Class,c=g.deepExtend,k=g.util,e=k.defined;
var h=b.extend({init:function(l){this._size=l;
this._length=0;
this._map={};
},put:function(m,p){var n=this,o=n._map,l={key:m,value:p};
o[m]=l;
if(!n._head){n._head=n._tail=l;
}else{n._tail.newer=l;
l.older=n._tail;
n._tail=l;
}if(n._length>=n._size){o[n._head.key]=null;
n._head=n._head.newer;
n._head.older=null;
}else{n._length++;
}},get:function(m){var n=this,l=n._map[m];
if(l){if(l===n._head&&l!==n._tail){n._head=l.newer;
n._head.older=null;
}if(l!==n._tail){if(l.older){l.older.newer=l.newer;
l.newer.older=l.older;
}l.older=n._tail;
l.newer=null;
n._tail.newer=l;
n._tail=l;
}return l.value;
}}});
var d=a("<div style='position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;padding: 0 !important; margin: 0 !important; border: 0 !important;line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;' />")[0];
var j=b.extend({init:function(l){this._cache=new h(1000);
this._initOptions(l);
},options:{baselineMarkerSize:1},measure:function(u,s,m){var t=k.objectKey(s),o=k.hashKey(u+t),n=this._cache.get(o);
if(n){return n;
}var r={width:0,height:0,baseline:0};
var q=m?m:d;
var l=this._baselineMarker().cloneNode(false);
for(var p in s){var v=s[p];
if(e(v)){q.style[p]=v;
}}a(q).text(u);
q.appendChild(l);
f.body.appendChild(q);
if((u+"").length){r.width=q.offsetWidth-this.options.baselineMarkerSize;
r.height=q.offsetHeight;
r.baseline=l.offsetTop+this.options.baselineMarkerSize;
}if(r.width>0&&r.height>0){this._cache.put(o,r);
}q.parentNode.removeChild(q);
return r;
},_baselineMarker:function(){return a("<div class='k-baseline-marker' style='display: inline-block; vertical-align: baseline;width: "+this.options.baselineMarkerSize+"px; height: "+this.options.baselineMarkerSize+"px;overflow: hidden;' />")[0];
}});
j.current=new j();
function i(n,m,l){return j.current.measure(n,m,l);
}c(g.drawing,{util:{TextMetrics:j,LRUCache:h,measureText:i}});
})(window.kendo.jQuery);
})();
(function(){(function(d){var a=d.jQuery;
var j=d.spreadsheet.UnionRef;
var h=["color","fontFamily","underline","fontSize","italic","bold","textAlign","verticalAlign","background"];
var b={borderTop:{complement:"borderBottom",direction:{top:-1,bottom:-1}},borderLeft:{complement:"borderRight",direction:{left:-1,right:-1}},borderRight:{complement:"borderLeft",direction:{left:1,right:1}},borderBottom:{complement:"borderTop",direction:{top:1,bottom:1}}};
var g=d.Class.extend({init:function(k,l){this._sheet=l;
this._ref=k;
},_normalize:function(k){return this._sheet._grid.normalize(k);
},_set:function(k,n,l){var m=this._sheet;
this._ref.forEach(function(o){m._set(o.toRangeRef(),k,n);
});
if(!l){m.triggerChange({recalc:k=="formula"||k=="value"||k=="validation",value:n,ref:this._ref});
}return this;
},_get:function(k){return this._sheet._get(this._ref.toRangeRef(),k);
},_property:function(k,l){if(l===undefined){return this._get(k);
}else{return this._set(k,l);
}},value:function(k){if(k!==undefined){this._set("formula",null,true);
}return this._property("value",k);
},resize:function(k){var l=this._resizedRef(k);
return new g(l,this._sheet);
},_resizedRef:function(k){return this._ref.map(function(l){return l.toRangeRef().resize(k);
});
},_border:function(m,p){var n;
var k=b[m].complement;
var l=b[m].direction;
var o=this._sheet;
o.batch(function(){n=this._property(m,p);
if(p!==undefined){this._resizedRef(l).forEach(function(q){if(q!==d.spreadsheet.NULLREF){new g(q,o)._property(k,null);
}});
}}.bind(this),{});
return n;
},_collapsedBorder:function(m){var n=this._property(m);
var k=b[m].complement;
var l=b[m].direction;
this._resizedRef(l).forEach(function(p){if(!n&&p!==d.spreadsheet.NULLREF){var o=new g(p,this._sheet);
n=o._property(k);
}}.bind(this));
return n;
},borderTop:function(k){return this._border("borderTop",k);
},borderRight:function(k){return this._border("borderRight",k);
},borderBottom:function(k){return this._border("borderBottom",k);
},borderLeft:function(k){return this._border("borderLeft",k);
},collapsedBorderTop:function(){return this._collapsedBorder("borderTop");
},collapsedBorderRight:function(){return this._collapsedBorder("borderRight");
},collapsedBorderBottom:function(){return this._collapsedBorder("borderBottom");
},collapsedBorderLeft:function(){return this._collapsedBorder("borderLeft");
},input:function(n){if(n!==undefined){var m=this._ref.toRangeRef().topLeft;
var o=d.spreadsheet.calc.parse(this._sheet.name(),m.row,m.col,n);
this._sheet.batch(function(){var p=null;
if(o.type=="exp"){p=d.spreadsheet.calc.compile(o);
}else{if(o.type=="date"){this.format(i(d.culture().calendar.patterns.d));
}}this.formula(p);
if(!p){this.value(o.value);
}}.bind(this),{recalc:true,value:n,ref:this._ref});
return this;
}else{n=this._get("value");
var k=this._get("format");
var l=this._get("formula");
if(l){n="="+l;
}else{if(k&&d.spreadsheet.formatting.type(n,k)==="date"){n=d.toString(d.spreadsheet.numberToDate(n),d.culture().calendar.patterns.d);
}else{if(typeof n=="string"&&(/^[=']/.test(n)||(/^(?:true|false)$/i).test(n)||e(n))){n="'"+n;
}}}return n;
}},format:function(k){return this._property("format",k);
},formula:function(l){if(l===undefined){var k=this._get("formula");
return k?""+k:null;
}return this._property("formula",l);
},validation:function(l){if(l===undefined){var k=this._get("validation");
return k?k.toJSON():null;
}return this._property("validation",l);
},merge:function(){this._ref=this._sheet._merge(this._ref);
return this;
},unmerge:function(){var k=this._sheet._mergedCells;
this._ref.forEach(function(l){l.toRangeRef().intersecting(k).forEach(function(m){k.splice(k.indexOf(m),1);
});
});
this._sheet.triggerChange({});
return this;
},select:function(){this._sheet.select(this._ref);
return this;
},values:function(t){if(this._ref instanceof j){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===d.spreadsheet.NULLREF){if(t!==undefined){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var n=this._ref.toRangeRef();
var r=n.topLeft.row;
var q=n.topLeft.col;
var l=n.bottomRight.row;
var k=n.bottomRight.col;
var m,o;
if(t===undefined){t=new Array(n.height());
for(var u=0;
u<t.length;
u++){t[u]=new Array(n.width());
}for(m=q;
m<=k;
m++){for(o=r;
o<=l;
o++){t[o-r][m-q]=this._sheet._value(o,m);
}}return t;
}else{for(m=q;
m<=k;
m++){for(o=r;
o<=l;
o++){var p=t[o-r];
if(p){var s=p[m-q];
if(s!==undefined){this._sheet._value(o,m,s);
}}}}this._sheet.triggerChange({recalc:true});
return this;
}},clear:function(l){var k=!l||!Object.keys(l).length;
var n=this._sheet;
var m={recalc:k||(l&&l.contentsOnly===true)};
n.batch(function(){if(m.recalc){this.formula(null);
this.validation(null);
}if(k||(l&&l.formatOnly===true)){h.forEach(function(o){this[o](null);
}.bind(this));
this.format(null);
this.unmerge();
}}.bind(this),m);
return this;
},clearContent:function(){return this.clear({contentsOnly:true});
},clearFormat:function(){return this.clear({formatOnly:true});
},sort:function(k){if(this._ref instanceof j){throw new Error("Unsupported for multiple ranges.");
}if(k===undefined){k={column:0};
}k=k instanceof Array?k:[k];
this._sheet._sortBy(this._ref.toRangeRef(),k.map(function(m,l){if(typeof m==="number"){m={column:m};
}return{index:m.column===undefined?l:m.column,ascending:m.ascending===undefined?true:m.ascending};
}));
return this;
},filter:function(k){if(this._ref instanceof j){throw new Error("Unsupported for multiple ranges.");
}if(k===false){this.clearFilters();
}else{k=k===true?[]:k instanceof Array?k:[k];
this._sheet._filterBy(this._ref.toRangeRef(),k.map(function(m,l){return{index:m.column===undefined?l:m.column,filter:m.filter};
}));
}return this;
},clearFilter:function(k){this._sheet.clearFilter(k);
},clearFilters:function(){var k=this._sheet.filter();
var m=[];
if(k){for(var l=0;
l<k.columns.length;
l++){m.push(l);
}this._sheet.batch(function(){this.clearFilter(m);
this._filter=null;
},{layout:true,filter:true});
}},hasFilter:function(){var k=this._sheet.filter();
return !!k;
},leftColumn:function(){return new g(this._ref.leftColumn(),this._sheet);
},rightColumn:function(){return new g(this._ref.rightColumn(),this._sheet);
},topRow:function(){return new g(this._ref.topRow(),this._sheet);
},bottomRow:function(){return new g(this._ref.bottomRow(),this._sheet);
},column:function(k){return new g(this._ref.toColumn(k),this._sheet);
},forEachRow:function(k){this._ref.forEachRow(function(l){k(new g(l,this._sheet));
}.bind(this));
},forEachColumn:function(k){this._ref.forEachColumn(function(l){k(new g(l,this._sheet));
}.bind(this));
},sheet:function(){return this._sheet;
},topLeft:function(){return this._ref.toRangeRef().topLeft;
},intersectingMerged:function(){var l=this._sheet;
var k=[];
l._mergedCells.forEach(function(m){if(m.intersects(this._ref)){k.push(m.toString());
}}.bind(this));
return k;
},getState:function(l){var m={ref:this._ref.first()};
var k=[l];
if(!l){k=d.spreadsheet.ALL_PROPERTIES;
m.mergedCells=this.intersectingMerged();
}if(l==="border"){k=["borderLeft","borderTop","borderRight","borderBottom"];
}this.forEachCell(function(q,p,n){var o=m[q+","+p]={};
k.forEach(function(r){if(r==="input"){r="value";
}o[r]=n[r]||null;
});
});
return m;
},setState:function(o){var n=this._sheet;
var l=this._ref.first();
var m=o.ref.row-l.row;
var k=o.ref.col-l.col;
n.batch(function(){if(o.mergedCells){this.unmerge();
}this.forEachCell(function(t,q){var p=o[(t+m)+","+(q+k)];
var s=n.range(t,q);
for(var r in p){if(r!="value"){s._set(r,p[r]);
}}if(!p.formula){s._set("value",p.value);
}});
if(o.mergedCells){o.mergedCells.forEach(function(p){p=n._ref(p).relative(m,k,3);
n.range(p).merge();
},this);
}}.bind(this),{recalc:true});
},forEachCell:function(k){this._ref.forEach(function(l){this._sheet.forEach(l.toRangeRef(),k.bind(this));
}.bind(this));
},hasValue:function(){var k=false;
this.forEachCell(function(n,m,l){if(Object.keys(l).length!==0){k=true;
}});
return k;
},wrap:function(k){if(k===undefined){return !!this._property("wrap");
}this.forEachRow(function(m){var l=m.sheet().rowHeight(m.topLeft().row);
m.forEachCell(function(p,o,n){var q=this._sheet.columnWidth(o);
l=Math.max(l,d.spreadsheet.util.getTextHeight(n.value,q));
});
m.sheet().rowHeight(m.topLeft().row,l);
}.bind(this));
this._property("wrap",k);
return this;
}});
a.each(h,function(k,l){g.prototype[l]=function(m){return this._property(l,m);
};
});
function i(k){return k.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}function e(k){return !(/^=/.test(k))&&d.spreadsheet.calc.parse(null,0,0,k).type=="number";
}var f=a('<div style="position: absolute !important; top: -4000px !important; height: auto !important;padding: 1px !important; margin: 0 !important; border: 1px solid black !important;line-height: normal !important; visibility: hidden !important;white-space: normal !important; word-break: break-all !important;" />')[0];
function c(k,l){return d.drawing.util.measureText(k,{baselineMarkerSize:0,width:l+"px"},f).height;
}d.spreadsheet.util={getTextHeight:c};
d.spreadsheet.Range=g;
})(window.kendo);
})();
(function(){var g={};
var I=kendo.spreadsheet;
I.calc=g;
var r=g.runtime={};
var j=kendo.Class;
var G=I.Ref;
var i=I.CellRef;
var F=I.RangeRef;
var J=I.UnionRef;
var B=I.NULLREF;
function h(M){if(M instanceof h){return M;
}this.code=M;
}h.prototype.toString=function(){return"#"+this.code+(this.code=="NAME"?"?":"!");
};
var l=j.extend({init:function l(M,N,P,O){this.callback=M;
this.formula=N;
this.ss=P;
this.parent=O;
},resolve:function(N){var M=this;
if(N instanceof G){M.resolveCells([N],function(){N=M.ss.getData(N);
if(Array.isArray(N)){N=N[0];
}M._resolve(N);
});
}else{M._resolve(N);
}},_resolve:function(N){var M=this.formula;
M.value=N;
if(this.ss.onFormula(M)&&this.callback){this.callback.call(M,N);
}},resolveCells:function(M,P){var O=this,R=[];
(function T(V){for(var W=0;
W<V.length;
++W){var X=V[W];
if(X instanceof G){N(O.ss.getRefCells(X));
}if(Array.isArray(X)){T(X);
}}})(M);
if(!R.length){return P.call(O);
}for(var U=R.length,S=0;
S<R.length;
++S){Q(R[S]);
}function Q(V){V.formula.exec(O.ss,function(){if(!--U){P.call(O);
}},O);
}function N(V){for(var X=0;
X<V.length;
++X){var W=V[X];
if(W.formula){R.push(W);
}}return true;
}},cellValues:function(M,N){var P=[];
for(var O=0;
O<M.length;
++O){var Q=M[O];
if(Q instanceof G){Q=this.ss.getData(Q);
P=P.concat(Q);
}else{if(Array.isArray(Q)){P=P.concat(this.cellValues(Q));
}else{if(Q instanceof x){P=P.concat(this.cellValues(Q.data));
}else{P.push(Q);
}}}}if(N){return N.apply(this,P);
}return P;
},force:function(M){if(M instanceof G){return this.ss.getData(M);
}return M;
},func:function(O,N,M){O=O.toLowerCase();
if(Object.prototype.hasOwnProperty.call(t,O)){return t[O].call(this,N,M);
}N(new h("NAME"));
},bool:function(M){if(M instanceof G){M=this.ss.getData(M);
}if(typeof M=="string"){return M.toLowerCase()=="true";
}if(typeof M=="number"){return M!==0;
}if(typeof M=="boolean"){return M;
}return M!=null;
},asMatrix:function(P){if(P instanceof x){return P;
}var R=this;
if(P instanceof F){var S=P.topLeft;
var T=S.row,N=S.col;
var M=R.ss.getRefCells(P);
var O=new x(R);
if(isFinite(P.width())){O.width=P.width();
}if(isFinite(P.height())){O.height=P.height();
}if(!isFinite(T)){T=0;
}if(!isFinite(N)){N=0;
}M.forEach(function(U){O.set(U.row-T,U.col-N,U.value);
});
return O;
}if(Array.isArray(P)&&P.length>0){var O=new x(R),Q=0;
P.forEach(function(W){var U=0;
var V=1;
W.forEach(function(X){var Y=X instanceof F;
if(X instanceof G&&!Y){X=R.ss.getData(X);
}if(Y||Array.isArray(X)){X=R.asMatrix(X);
}if(X instanceof x){X.each(function(aa,ab,Z){O.set(Q+ab,U+Z,aa);
});
V=Math.max(V,X.height);
U+=X.width;
}else{O.set(Q,U++,X);
}});
Q+=V;
});
return O;
}}});
var x=j.extend({init:function x(M){this.context=M;
this.height=0;
this.width=0;
this.data=[];
},clone:function(){var M=new x(this.context);
M.height=this.height;
M.width=this.width;
M.data=this.data.map(function(N){return N.slice();
});
return M;
},get:function(O,M){var N=this.data[O];
var P=N?N[M]:null;
return P instanceof G?this.context.ss.getData(P):P;
},set:function(P,M,N){var O=this.data[P];
if(O==null){O=this.data[P]=[];
}O[M]=N;
if(P>=this.height){this.height=P+1;
}if(M>=this.width){this.width=M+1;
}},each:function(N,O){for(var P=0;
P<this.height;
++P){for(var M=0;
M<this.width;
++M){var Q=this.get(P,M);
if(O||Q!=null){Q=N.call(this.context,Q,P,M);
if(Q!==undefined){return Q;
}}}}},map:function(M,N){var O=new x(this.context);
this.each(function(Q,R,P){O.set(R,P,M.call(this,Q,R,P));
},N);
return O;
},eachRow:function(M){for(var N=0;
N<this.height;
++N){var O=M.call(this.context,N);
if(O!==undefined){return O;
}}},eachCol:function(N){for(var M=0;
M<this.width;
++M){var O=N.call(this.context,M);
if(O!==undefined){return O;
}}},mapRow:function(M){var N=new x(this.context);
this.eachRow(function(O){N.set(O,0,M.call(this.context,O));
});
return N;
},mapCol:function(M){var N=new x(this.context);
this.eachCol(function(O){N.set(0,O,M.call(this.context,O));
});
return N;
},toString:function(){return JSON.stringify(this.data);
},transpose:function(){var M=new x(this.context);
this.each(function(O,P,N){M.set(N,P,O);
});
return M;
},unit:function(P){this.width=this.height=P;
var M=this.data=new Array(P);
for(var N=P;
--N>=0;
){var Q=M[N]=new Array(P);
for(var O=P;
--O>=0;
){Q[O]=N==O?1:0;
}}return this;
},multiply:function(N){var M=this,Q=new x(M.context);
for(var R=0;
R<M.height;
++R){for(var O=0;
O<N.width;
++O){var S=0;
for(var P=0;
P<M.width;
++P){var T=M.get(R,P);
var U=N.get(P,O);
if(typeof T!="number"||typeof U!="number"){throw new h("VALUE");
}S+=T*U;
}Q.set(R,O,S);
}}return Q;
},determinant:function(){var M=this.clone().data;
var S=M.length;
var O=1,N,R,P,Q;
for(N=0;
N<S;
N++){for(R=N;
(R<S)&&(!M[R][N]);
R++){}if(R==S){return 0;
}if(R!=N){O=-O;
for(Q=N;
Q<S;
Q++){var T=M[N][Q];
M[N][Q]=M[R][Q];
M[R][Q]=T;
}}for(P=N+1;
P<S;
P++){for(Q=N+1;
Q<S;
Q++){M[P][Q]-=M[N][Q]*M[P][N]/M[N][N];
}}O*=M[N][N];
}return O;
},inverse:function(){var T=this.width;
var S=this.augment(new x(this.context).unit(T));
var M=S.data;
var U;
for(var R=0;
R<T;
++R){var P=c(R,T,function(V){return M[V][R];
});
if(!M[P][R]){return null;
}if(R!=P){U=M[R];
M[R]=M[P];
M[P]=U;
}for(var O=R+1;
O<T;
++O){for(var Q=R+1;
Q<2*T;
++Q){M[O][Q]-=M[R][Q]*M[O][R]/M[R][R];
}M[O][R]=0;
}}for(var O=0;
O<T;
++O){for(var N=M[O][O],Q=0;
Q<2*T;
++Q){M[O][Q]/=N;
}}for(var R=T;
--R>=0;
){for(var O=R;
--O>=0;
){if(M[O][R]){for(var Q=2*T;
--Q>=T;
){M[O][Q]-=M[R][Q]*M[O][R];
}}}}return S.slice(0,T,T,T);
},augment:function(M){var O=this.clone(),N=O.width;
M.each(function(R,Q,P){O.set(Q,P+N,R);
});
return O;
},slice:function(R,M,N,S){var Q=new x(this.context);
for(var O=0;
O<N;
++O){for(var P=0;
P<S;
++P){Q.set(O,P,this.get(R+O,M+P));
}}return Q;
}});
function c(O,M,N){var P=N(O),Q=O;
while(++O<M){var R=N(O);
if(R>P){P=R;
Q=O;
}}return Q;
}var s=j.extend({init:function s(P,N,O,R,Q,M){this.refs=P;
this.handler=N;
this.print=O;
this.absrefs=null;
this.sheet=R;
this.row=Q;
this.col=M;
this.onReady=[];
this.pending=false;
},clone:function(O,N,M){return new s(this.refs,this.handler,this.print,O,N,M);
},resolve:function(M){this.pending=false;
this.onReady.forEach(function(N){N(M);
});
},exec:function(P,M,O){if("value" in this){if(M){M(this.value);
}}else{if(M){this.onReady.push(M);
}var N=new l(this.resolve,this,P,O);
while(O){if(O.formula===this){this.pending=false;
N.resolve(new h("CIRCULAR"));
return;
}O=O.parent;
}if(this.pending){return;
}this.pending=true;
if(!this.absrefs){this.absrefs=this.refs.map(function(Q){return Q.absolute(this.row,this.col);
},this);
}this.handler.call(N);
}},reset:function(){this.onReady=[];
this.pending=false;
delete this.value;
},adjust:function(M,U,V,N){M=M.toLowerCase();
var Q=this.row;
var O=this.col;
var R=this.sheet.toLowerCase();
var P=false;
if(R==M){if(U=="row"&&Q>=V){this.row+=N;
P=true;
}if(U=="col"&&O>=V){this.col+=N;
P=true;
}}var T=this.row;
var S=this.col;
this.absrefs=null;
this.refs=this.refs.map(function(W){if(W===B){return W;
}if(W.sheet.toLowerCase()!=M){if(P){if(U=="row"&&Q>=V){W=W.relative(N,0);
}if(U=="col"&&O>=V){W=W.relative(0,N);
}}return W;
}return W.adjust(Q,O,T,S,U=="row",V,N);
},this);
},toString:function(){return this.print(this.row,this.col);
}});
var t={"if":function(N,M){var Q=this;
var O=M[0],R=M[1],P=M[2];
this.resolveCells([O],function(){var S=Q.asMatrix(O);
if(S){R(function(T){P(function(U){var W=Q.asMatrix(T);
var V=Q.asMatrix(U);
N(S.map(function(Z,Y,X){if(Q.bool(Z)){return W?W.get(Y,X):T;
}else{return V?V.get(Y,X):U;
}}));
});
});
}else{if(Q.bool(O)){R(N);
}else{P(N);
}}});
},"φ":function(M){M((1+Math.sqrt(5))/2);
}};
function k(M){var N="function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ";
var Y="function resolve(args, callback) { var toResolve = [], i = 0; ";
var X,T,W="'use strict'; function check(args) { var xargs = [], i = 0, m, err = 'VALUE'; ",V=false;
var O=false,U=false;
W+=M.map(P).join("");
W+="if (i < args.length) return new CalcError('N/A'); ";
W+="return xargs; } ";
N+="return { args: xargs, width: width, height: height, arrays: arrays }; } ";
var R;
if(V){Y+="this.resolveCells(toResolve, callback); } ";
R=new Function("CalcError",W+Y+N+" return { resolve: resolve, check: check, arrayArgs: arrayArgs };");
}else{R=new Function("CalcError",W+" return { check: check };");
}R=R(h);
if(!U){delete R.arrayArgs;
}return R;
function P(ae){X=ae[0];
var ab="{ ";
if(Array.isArray(X)){N+="while (i < args.length) { ";
Y+="while (i < args.length) { ";
ab+="while (i < args.length) { ";
ab+=ae.map(P).join("");
ab+="} ";
Y+="} ";
N+="} ";
}else{if(X=="+"){N+="while (i < args.length) { ";
Y+="while (i < args.length) { ";
ab+="do { ";
ab+=ae.slice(1).map(P).join("");
ab+="} while (i < args.length); ";
Y+="} ";
N+="} ";
}else{if(X=="?"){ab+="if (!("+Q(ae[1])+")) return new CalcError(err); ";
}else{var ad=ae[1];
if(Array.isArray(ad)&&/^#?collect/.test(ad[0])){var ac=ad[2];
S();
ab+="try {var $"+X+" = this.cellValues(args.slice(i";
if(ac){ab+=", i + "+ac;
}ab+=")).filter(function($"+X+"){ ";
if(ad[0]=="collect"){ab+="if ($"+X+" instanceof CalcError) throw $"+X+"; ";
}ab+="return "+Q(ad[1])+"; }, this); ";
if(ac){ab+="i += "+ac+"; ";
}else{ab+="i = args.length; ";
}ab+="xargs.push($"+X+")} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ";
Y+="toResolve.push(args.slice(i)); ";
}else{if(ad=="rest"){ab+="xargs.push(args.slice(i)); i = args.length; ";
}else{ab+="var $"+X+" = args[i++]; ";
var aa=false;
if(/!$/.test(ad)){ad=ad.substr(0,ad.length-1);
aa=true;
}else{ab+="if ($"+X+" instanceof CalcError) return $"+X+"; ";
}ab+=Z(ad,aa)+"xargs.push($"+X+"); ";
}}}}}ab+="} ";
return ab;
}function S(){if(T){return"$"+X+"";
}V=true;
T=true;
Y+="toResolve.push(args[i++]); ";
return"($"+X+" = this.force($"+X+"))";
}function Z(ac,aa){O=false;
T=false;
var ab="if (!("+Q(ac)+")) { ";
if(T&&!aa){ab+=" if ($"+X+" instanceof CalcError) return $"+X+"; ";
}ab+="return new CalcError(err); } ";
if(!T){Y+="i++; ";
}if(O){N+="var $"+X+" = this.asMatrix(args[i]); if ($"+X+") { xargs.push($"+X+"); width = Math.max(width, $"+X+".width); height = Math.max(height, $"+X+".height); arrays.push(true) } else { xargs.push(args[i]); arrays.push(false); } i++; ";
}else{N+="xargs.push(args[i++]); arrays.push(false); ";
}return ab;
}function Q(ab){if(Array.isArray(ab)){if(ab[0]=="or"){return"("+ab.slice(1).map(Q).join(") || (")+")";
}if(ab[0]=="and"){return"("+ab.slice(1).map(Q).join(") && (")+")";
}if(ab[0]=="values"){return"("+ab.slice(1).map(function(ac){return S()+" === "+ac;
}).join(") || (")+")";
}if(ab[0]=="null"){return"("+Q("null")+" ? (($"+X+" = "+ab[1]+"), true) : false)";
}if(ab[0]=="between"||ab[0]=="[between]"){return"("+S()+" >= "+ab[1]+" && $"+X+" <= "+ab[2]+" ? true : ((err = 'NUM'), false))";
}if(ab[0]=="(between)"){return"("+S()+" > "+ab[1]+" && $"+X+" < "+ab[2]+" ? true : ((err = 'NUM'), false))";
}if(ab[0]=="(between]"){return"("+S()+" > "+ab[1]+" && $"+X+" <= "+ab[2]+" ? true : ((err = 'NUM'), false))";
}if(ab[0]=="[between)"){return"("+S()+" >= "+ab[1]+" && $"+X+" < "+ab[2]+" ? true : ((err = 'NUM'), false))";
}if(ab[0]=="assert"){var aa=ab[2]||"N/A";
return"(("+ab[1]+") ? true : (err = "+JSON.stringify(aa)+", false))";
}if(ab[0]=="not"){return"!("+Q(ab[1])+")";
}throw new Error("Unknown array type condition: "+ab[0]);
}if(/^\*/.test(ab)){O=U=true;
ab=ab.substr(1);
}if(ab=="number"){return"(typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean')";
}if(ab=="integer"){return"((typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean') ? ($"+X+" |= 0, true) : false)";
}if(ab=="date"){return"((typeof "+S()+" == 'number') ? ($"+X+" |= 0, true) : false)";
}if(ab=="datetime"){return"(typeof "+S()+" == 'number')";
}if(ab=="divisor"){return"((typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean') && ($"+X+" == 0 ? ((err = 'DIV/0'), false) : true))";
}if(ab=="number+"){return"((typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean') && ($"+X+" >= 0 ? true : ((err = 'NUM'), false)))";
}if(ab=="integer+"){return"(((typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean') && ($"+X+" >= 0 ? true : ((err = 'NUM'), false))) ? ($"+X+" |= 0, true) : false)";
}if(ab=="number++"){return"((typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean') && ($"+X+" > 0 ? true : ((err = 'NUM'), false)))";
}if(ab=="integer++"){return"(((typeof "+S()+" == 'number' || typeof $"+X+" == 'boolean') && ($"+X+" > 0) ? true : ((err = 'NUM'), false)) ? ($"+X+" |= 0, true) : false)";
}if(ab=="string"){return"(typeof "+S()+" == 'string')";
}if(ab=="boolean"){return"(typeof "+S()+" == 'boolean')";
}if(ab=="logical"){return"(typeof "+S()+" == 'boolean' || (typeof $"+X+" == 'number' ? ($"+X+" = !!$"+X+", true) : false))";
}if(ab=="matrix"){S();
return"((m = this.asMatrix($"+X+")) ? ($"+X+" = m) : false)";
}if(ab=="#matrix"){return"((m = this.asMatrix($"+X+")) ? ($"+X+" = m) : false)";
}if(ab=="ref"){return"($"+X+" instanceof kendo.spreadsheet.Ref)";
}if(ab=="area"){return"($"+X+" instanceof kendo.spreadsheet.CellRef || $"+X+" instanceof kendo.spreadsheet.RangeRef)";
}if(ab=="cell"){return"($"+X+" instanceof kendo.spreadsheet.CellRef)";
}if(ab=="null"){return"("+S()+" == null)";
}if(ab=="anyvalue"){return"("+S()+" != null && i <= args.length)";
}if(ab=="forced"){return"("+S()+", i <= args.length)";
}if(ab=="anything"){return"(i <= args.length)";
}if(ab=="blank"){return"("+S()+" == null || $"+X+" === '')";
}throw new Error("Can't check for type: "+ab);
}}function w(O,P,N,M){return function(R,Q){function S(){if(M){var Z=M.call(this,Q);
Q=Z.args;
if(Z.width>0&&Z.height>0){var W=new x(this);
for(var X=0;
X<Z.height;
++X){for(var T=0;
T<Z.width;
++T){var aa=[];
for(var V=0;
V<Q.length;
++V){if(Z.arrays[V]){aa[V]=Q[V].get(X,T);
}else{aa[V]=Q[V];
}}aa=N.call(this,aa);
if(aa instanceof h){W.set(X,T,aa);
}else{try{W.set(X,T,O.apply(this,aa));
}catch(U){if(U instanceof h){W.set(X,T,U);
}else{throw U;
}}}}}return R(W);
}}var aa=N.call(this,Q);
if(aa instanceof h){R(aa);
}else{var Y;
try{Y=O.apply(this,aa);
}catch(U){if(U instanceof h){Y=U;
}else{throw U;
}}R(Y);
}}if(P){P.call(this,Q,S);
}else{S.call(this);
}};
}function v(O,P,N,M){return function(R,Q){function S(){if(M){var Z=M.call(this,Q);
Q=Z.args;
if(Z.width>0&&Z.height>0){var X=new x(this);
var U=Z.width*Z.height;
var W=function(ac,ab){return function(ad){X.set(ac,ab,ad);
--U;
if(U===0){return R(X);
}};
};
for(var Y=0;
Y<Z.height&&U>0;
++Y){for(var T=0;
T<Z.width&&U>0;
++T){var aa=[];
for(var V=0;
V<Q.length;
++V){if(Z.arrays[V]){aa[V]=Q[V].get(Y,T);
}else{aa[V]=Q[V];
}}aa=N.call(this,aa);
if(aa instanceof h){X.set(Y,T,aa);
--U;
if(U===0){return R(X);
}}else{aa.unshift(W(Y,T));
O.apply(this,aa);
}}}return;
}}var Z=N.call(this,Q);
if(Z instanceof h){R(Z);
}else{Z.unshift(R);
O.apply(this,Z);
}}if(P){P.call(this,Q,S);
}else{S.call(this);
}};
}function q(N,M){N=N.toLowerCase();
t[N]=M;
return{args:function(O,Q){var P=k(O);
if(Q){if(P.arrayArgs){console.log(P.arrayArgs.toString());
}if(P.resolve){console.log(P.resolve.toString());
}if(P.check){console.log(P.check.toString());
}}t[N]=w(M,P.resolve,P.check,P.arrayArgs);
return this;
},argsAsync:function(O,Q){var P=k(O);
if(Q){if(P.arrayArgs){console.log(P.arrayArgs.toString());
}if(P.resolve){console.log(P.resolve.toString());
}if(P.check){console.log(P.check.toString());
}}t[N]=v(M,P.resolve,P.check,P.arrayArgs);
return this;
}};
}var n=[31,28,31,30,31,30,31,31,30,31,30,31];
var C=[[0,31,59,90,120,151,181,212,243,273,304,334],[0,31,60,91,121,152,182,213,244,274,305,335]];
function u(M){if(M%4){return 0;
}if(M%100){return 1;
}if(M%400){return 0;
}return 1;
}function p(M){return u(M)?366:365;
}function o(N,M){return(u(N)&&M==1)?29:n[M];
}function K(M){return b(M-1);
}function D(M,N,O){return a(M,N,O)+1;
}var A=60*1000;
var z=60*A;
var y=24*z;
function L(R){var M=R-(R|0);
if(M<0){M++;
}var P=Math.round(y*M);
var N=Math.floor(P/z);
P-=N*z;
var O=Math.floor(P/A);
P-=O*A;
var Q=Math.floor(P/1000);
P-=Q*1000;
return{hours:N,minutes:O,seconds:Q,milliseconds:P};
}function H(N){var M=K(N),O=L(N);
return new Date(M.year,M.month,M.date,O.hours,O.minutes,O.seconds,O.milliseconds);
}function b(P){P|=0;
var O,Q;
var M=P<=0;
var R=1900;
var N=P%7;
if(M){P=-P;
R--;
N=(N+7)%7;
}while(P>(Q=p(R))){P-=Q;
R+=M?-1:1;
}if(M){O=11;
while(P>=(Q=o(R,O))){P-=Q;
O--;
}P=Q-P;
}else{O=0;
while(P>(Q=o(R,O))){P-=Q;
O++;
}}return{year:R,month:O,date:P,day:N,ord:C[u(R)][O]+P};
}function a(Q,O,M){var P=0;
Q+=Math.floor(O/12);
O%=12;
if(O<0){O+=12;
}if(Q>=1900){for(var N=1900;
N<Q;
++N){P+=p(N);
}}else{for(var N=1899;
N>=Q;
--N){P-=p(N);
}}for(var N=0;
N<O;
++N){P+=o(Q,N);
}P+=M;
return P;
}function E(M,N,P,O){return(M+N/60+P/3600+O/3600000)/24;
}function m(M){var N=E(M.getHours(),M.getMinutes(),M.getSeconds(),M.getMilliseconds());
M=D(M.getFullYear(),M.getMonth(),M.getDate());
if(M<0){return M-1+N;
}else{return M+N;
}}r.CalcError=h;
r.Formula=s;
r.Matrix=x;
r.packDate=D;
r.unpackDate=K;
r.packTime=E;
r.unpackTime=L;
r.serialToDate=H;
r.dateToSerial=m;
r.daysInMonth=o;
r.isLeapYear=u;
r.daysInYear=p;
I.dateToNumber=m;
I.numberToDate=H;
r.defineFunction=q;
r.defineAlias=function(M,N){t[M]=t[N];
};
r.FUNCS=t;
var e=[["a","*number"],["b","*number"]];
var d=[["a","*anyvalue"],["b","*anyvalue"]];
q("binary+",function(M,N){return M+N;
}).args(e);
q("binary-",function(M,N){return M-N;
}).args(e);
q("binary*",function(M,N){return M*N;
}).args(e);
q("binary/",function(M,N){return M/N;
}).args([["a","*number"],["b","*divisor"]]);
q("binary^",function(M,N){return Math.pow(M,N);
}).args(e);
q("binary&",function(M,N){if(M==null){M="";
}if(N==null){N="";
}return""+M+N;
}).args([["a",["or","*number","*string","*boolean","*null"]],["b",["or","*number","*string","*boolean","*null"]]]);
q("binary=",function(M,N){return M===N;
}).args(d);
q("binary<>",function(M,N){return M!==N;
}).args(d);
q("binary<",f(function(M,N){return M<N;
})).args(d);
q("binary<=",f(function(M,N){return M<=N;
})).args(d);
q("binary>",f(function(M,N){return M>N;
})).args(d);
q("binary>=",f(function(M,N){return M>=N;
})).args(d);
q("unary+",function(M){return M;
}).args([["a","*number"]]);
q("unary-",function(M){return -M;
}).args([["a","*number"]]);
q("unary%",function(M){return M/100;
}).args([["a","*number"]]);
q("binary:",function(M,N){return new F(M,N).setSheet(M.sheet||this.formula.sheet,M.hasSheet());
}).args([["a","cell"],["b","cell"]]);
q("binary,",function(M,N){return new J([M,N]);
}).args([["a","ref"],["b","ref"]]);
q("binary ",function(M,N){return M.intersect(N);
}).args([["a","ref"],["b","ref"]]);
q("not",function(M){return !this.bool(M);
}).args([["a","*anyvalue"]]);
q("isblank",function(M){if(M instanceof i){M=this.ss.getData(M);
return M==null;
}return false;
}).args([["value","*anything!"]]);
q("iserror",function(M){return M instanceof h;
}).args([["value","*forced!"]]);
q("iserr",function(M){return M instanceof h&&M.code!="N/A";
}).args([["value","*forced!"]]);
q("isna",function(M){return M instanceof h&&M.code=="N/A";
}).args([["value","*forced!"]]);
q("islogical",function(M){return typeof M=="boolean";
}).args([["value","*forced!"]]);
q("isnontext",function(M){return typeof M!="string";
}).args([["value","*forced!"]]);
q("istext",function(M){return typeof M=="string";
}).args([["value","*forced!"]]);
q("isnumber",function(M){return typeof M=="number";
}).args([["value","*forced!"]]);
q("isref",function(M){return M instanceof i||M instanceof F;
}).args([["value","*anything!"]]);
function f(M){return function(N,O){if(typeof N=="string"&&typeof O!="string"){O=O==null?"":O+"";
}if(typeof N!="string"&&typeof O=="string"){N=N==null?"":N+"";
}if(typeof N=="number"&&O==null){O=0;
}if(typeof O=="number"&&N==null){N=0;
}if(typeof N=="string"&&typeof O=="string"){N=N.toLowerCase();
O=O.toLowerCase();
}if(typeof O==typeof N){return M(N,O);
}else{return new h("VALUE");
}};
}})();
(function(){var e=kendo.spreadsheet;
var d={};
e.validation=d;
var a=e.calc;
var b=kendo.Class;
var h="Please enter a valid #=dataType# value {0}.";
var i="Validation #=type#";
var g={greaterThan:{type:"greaterThan",text:"greater than #=from#"},lessThan:{type:"lessThan",text:"less than #=from#"},between:{type:"between",text:"between #=from# and #=to#"},equalTo:{type:"equalTo",text:"equal to #=from#"},notEqualTo:{type:"notEqualTo",text:"not equal to #=from#"},greaterThanOrEqualTo:{type:"greaterThanOrEqualTo",text:"greater than or equal to #=from#"},lessThanOrEqualTo:{type:"lessThanOrEqualTo",text:"less than or equal to #=from#"},notBetween:{type:"notBetween",text:"not between #=from# and #=to#"},custom:{type:"custom",text:"that satisfies the formula: #=fromFormula#"}};
function c(m,l,j,n){var o;
if(typeof n==="string"){n=JSON.parse(n);
}if(n.from){n.from=a.compile(a.parseFormula(m,l,j,n.from));
}if(n.to){n.to=a.compile(a.parseFormula(m,l,j,n.to));
}var k=d.validationComparers[n.comparerType];
if(!k){throw kendo.format("'{0}' comparer is not implemented.",n.comparerType);
}o=function(s,r){if(this.allowNulls&&s===null){this.value=true;
}else{var q=r?e.formatting.type(s,r):"";
var p=this.to&&this.to.value?this.to.value:undefined;
this.value=!q||q==this.dataType?k(s,this.from.value,p):"type error";
}return this.value;
};
return new kendo.spreadsheet.validation.Validation($.extend(n,{handler:o,sheet:m,row:l,col:j}));
}var f=b.extend({init:function f(j){this.handler=j.handler;
this.from=j.from;
this.to=j.to;
this.dataType=j.dataType;
this.comparerType=j.comparerType;
this.type=j.type?j.type:"warning";
this.allowNulls=j.allowNulls?true:false;
this.sheet=j.sheet;
this.row=j.row;
this.col=j.col;
this.tooltipMessageTemplate=j.tooltipMessageTemplate?j.tooltipMessageTemplate:"";
this.tooltipTitleTemplate=j.tooltipTitleTemplate?j.tooltipTitleTemplate:"";
this.messageTemplate=j.messageTemplate?j.messageTemplate:this._validationMessage();
this.titleTemplate=j.titleTemplate?j.titleTemplate:this._validationTitle();
},_setMessages:function(){var j={from:this.from?this.from.value:"",to:this.to?this.to.value:"",fromFormula:this.from?this.from.toString():"",toFormula:this.from?this.from.toString():"",dataType:this.dataType,type:this.type,comparerType:this.comparerType};
if(this.tooltipMessageTemplate&&this.tooltipTitleTemplate){this.tooltipMessage=kendo.template(this.tooltipMessageTemplate)(j);
this.tooltipTitle=kendo.template(this.tooltipTitleTemplate)(j);
}this.message=kendo.template(this.messageTemplate)(j);
this.title=kendo.template(this.titleTemplate)(j);
},_validationTitle:function(){return kendo.format(i);
},_validationMessage:function(){var j=kendo.format(g[this.comparerType].text);
return kendo.format(h,j);
},clone:function(m,l,j){var k=this._getOptions();
if(k.from){k.from=k.from.clone(m,l,j);
}if(k.to){k.to=k.to.clone(m,l,j);
}return new f($.extend(k,{handler:this.handler},{sheet:m,row:l,col:j}));
},exec:function(o,m,l,k){var n=this;
var j=function(){n.value=n.handler.call(n,m,l);
n._setMessages();
if(k){k(n.value);
}};
if(n.to){n.to.exec(o,function(){n.from.exec(o,j);
});
}else{n.from.exec(o,j);
}},reset:function(){if(this.from){this.from.reset();
}if(this.to){this.to.reset();
}delete this.value;
},adjust:function(j,n,o,k){if(this.from){this.from.adjust(j,n,o,k);
}if(this.to){this.to.adjust(j,n,o,k);
}if(this.sheet.toLowerCase()==j.toLowerCase()){var m=this.row;
var l=this.col;
switch(n){case"row":if(m>=o){this.row+=k;
}break;
case"col":if(l>=o){this.col+=k;
}break;
}}},toJSON:function(){var j=this._getOptions();
if(j.from){j.from=j.from.toString();
}if(j.to){j.to=j.to.toString();
}return j;
},_getOptions:function(){return{from:this.from,to:this.to,dataType:this.dataType,type:this.type,comparerType:this.comparerType,row:this.row,col:this.col,sheet:this.sheet,allowNulls:this.allowNulls,tooltipMessageTemplate:this.tooltipMessageTemplate,tooltipTitleTemplate:this.tooltipTitleTemplate,messageTemplate:this.messageTemplate,titleTemplate:this.titleTemplate};
}});
d.compile=c;
d.validationComparers={greaterThan:function(k,j){return k>j;
},lessThan:function(k,j){return k<j;
},between:function(l,j,k){return l>j&&l<k;
},equalTo:function(k,j){return k==j;
},notEqualTo:function(k,j){return k!=j;
},greaterThanOrEqualTo:function(k,j){return k>=j;
},lessThanOrEqualTo:function(k,j){return k<=j;
},notBetween:function(l,j,k){return l<j||l>k;
},custom:function(k,j){return j;
}};
d.Validation=f;
})();
(function(){(function(c){var e=c.spreadsheet.RangeRef;
var a=c.spreadsheet.CellRef;
var d=c.spreadsheet.Range;
var b=c.Color;
var f=c.Observable.extend({init:function(l,h,m,i,j,k){c.Observable.prototype.init.call(this);
var g=l*h-1;
this._rows=new c.spreadsheet.Axis(l,m);
this._columns=new c.spreadsheet.Axis(h,i);
this._mergedCells=[];
this._frozenRows=0;
this._frozenColumns=0;
this._suspendChanges=false;
this._filter=null;
this._grid=new c.spreadsheet.Grid(this._rows,this._columns,l,h,j,k);
this._sheetRef=this._grid.normalize(c.spreadsheet.SHEETREF);
this._properties=new c.spreadsheet.PropertyBag(g);
this._sorter=new c.spreadsheet.Sorter(this._grid,this._properties.sortable());
this._viewSelection={selection:c.spreadsheet.FIRSTREF.toRangeRef(),originalSelection:c.spreadsheet.FIRSTREF.toRangeRef(),activeCell:c.spreadsheet.FIRSTREF.toRangeRef(),originalActiveCell:c.spreadsheet.FIRSTREF};
this._editSelection={selection:c.spreadsheet.FIRSTREF.toRangeRef(),originalSelection:c.spreadsheet.FIRSTREF.toRangeRef(),activeCell:c.spreadsheet.FIRSTREF.toRangeRef(),originalActiveCell:c.spreadsheet.FIRSTREF};
this._formulaSelections=[];
},_selectionState:function(){return this._inEdit?this._editSelection:this._viewSelection;
},navigator:function(){if(!this._navigator){this._navigator=new c.spreadsheet.SheetNavigator(this);
}return this._navigator;
},axisManager:function(){if(!this._axisManager){this._axisManager=new c.spreadsheet.AxisManager(this);
}return this._axisManager;
},name:function(g){if(!g){return this._name;
}this._name=g;
return this;
},_property:function(g,i,h){if(i===undefined){return g();
}else{g(i);
return this.triggerChange(h);
}},_field:function(g,i,h){if(i===undefined){return this[g];
}else{this[g]=i;
return this.triggerChange(h);
}},suspendChanges:function(g){if(g===undefined){return this._suspendChanges;
}this._suspendChanges=g;
return this;
},triggerChange:function(g){if(!this._suspendChanges){this.trigger("change",g);
}return this;
},setDataSource:function(h,g){if(this.dataSourceBinder){this.dataSourceBinder.destroy();
}this.dataSourceBinder=new c.spreadsheet.SheetDataSourceBinder({dataSource:h,sheet:this,columns:g});
},hideColumn:function(g){return this._property(this._columns.hide.bind(this._columns),g,{layout:true});
},unhideColumn:function(g){return this._property(this._columns.unhide.bind(this._columns),g,{layout:true});
},_copyRange:function(m,o){var g=this._grid;
var l=g.rowCount;
var k=g.normalize(m.topLeft);
var j=g.normalize(m.bottomRight);
var i=k.col*l+k.row;
var h=j.col*l+j.row;
var n=o.col*l+o.row;
this._properties.copy(i,h,n);
},_adjustReferences:function(j,l,h,i){this._mergedCells=i.reduce(function(m,n){n=n.adjust(null,null,null,null,j=="row",l,h);
if(n!==c.spreadsheet.NULLREF){m.push(n);
}return m;
},[]);
if(this._workbook){var g=this._name;
this._workbook._sheets.forEach(function(m){m._forFormulas(function(n){n.adjust(g,j,l,h);
});
m._forValidations(function(n){n.adjust(g,j,l,h);
});
});
}var k=this.select();
k=k.adjust(null,null,null,null,j=="row",l,h);
if(k!==c.spreadsheet.NULLREF){this.select(k);
}},_forFormulas:function(g){var h=this._properties;
h.get("formula").values().forEach(function(i){g.call(this,i.value);
},this);
},_forValidations:function(g){var h=this._properties;
h.get("validation").values().forEach(function(i){g.call(this,i.value);
},this);
},canInsertRow:function(j,g){g=g||1;
var h=this._grid;
var i=this.range(h.rowCount-g,0,g,h.columnCount);
return !i.hasValue();
},insertRow:function(g){if(!this.canInsertRow(g)){throw new Error("Shifting nonblank cells off the worksheet is not supported!");
}this.batch(function(){var l=this._grid;
var j=l.columnCount;
var p=l.rowCount;
var k=this.frozenRows();
if(g<k){this.frozenRows(k+1);
}var m=this._mergedCells.slice();
for(var i=0;
i<j;
i++){var o=new e(new a(g,i),new a(g,i));
var q=l.normalize(o.topLeft);
var h=l.normalize(o.bottomRight);
var n=new e(new a(q.row,q.col),new a(p-2,h.col));
this._copyRange(n,new a(q.row+1,q.col));
new d(o,this).clear();
}this._adjustReferences("row",g,1,m);
},{recalc:true,layout:true});
this.trigger("insertRow",{index:g});
return this;
},deleteRow:function(g){this.batch(function(){var l=this._grid;
var j=l.columnCount;
var k=this.frozenRows();
if(g<k){this.frozenRows(k-1);
}var m=this._mergedCells.slice();
for(var i=0;
i<j;
i++){var p=new e(new a(g,i),new a(g,i));
new d(p,this).clear();
var q=l.normalize(p.topLeft);
var h=l.normalize(p.bottomRight);
var n=new e(new a(q.row+1,q.col),new a(Infinity,h.col));
this._copyRange(n,q);
var o=l.normalize(n.bottomRight);
new d(new e(o,o),this).clear();
}this._adjustReferences("row",g,-1,m);
},{recalc:true,layout:true});
this.trigger("deleteRow",{index:g});
return this;
},insertColumn:function(g){this.batch(function(){var l=this._grid;
var j=l.columnCount;
var k=this.frozenColumns();
if(g<k){this.frozenColumns(k+1);
}var m=this._mergedCells.slice();
for(var i=j;
i>=g;
i--){var o=new e(new a(0,i),new a(Infinity,i));
new d(o,this).clear();
if(i==g){break;
}var p=l.normalize(o.topLeft);
var h=l.normalize(o.bottomRight);
var n=new e(new a(p.row,p.col-1),new a(h.row,h.col-1));
this._copyRange(n,p);
}this._adjustReferences("col",g,1,m);
},{recalc:true,layout:true});
return this;
},deleteColumn:function(g){this.batch(function(){var l=this._grid;
var j=l.columnCount;
var k=this.frozenColumns();
if(g<k){this.frozenColumns(k-1);
}var m=this._mergedCells.slice();
for(var i=g;
i<j;
i++){var o=new e(new a(0,i),new a(Infinity,i));
new d(o,this).clear();
if(i==j-1){break;
}var p=l.normalize(o.topLeft);
var h=l.normalize(o.bottomRight);
var n=new e(new a(p.row,p.col+1),new a(h.row,h.col+1));
this._copyRange(n,p);
}this._adjustReferences("col",g,-1,m);
},{recalc:true,layout:true});
return this;
},hideRow:function(g){return this._property(this._rows.hide.bind(this._rows),g,{layout:true});
},unhideRow:function(g){return this._property(this._rows.unhide.bind(this._rows),g,{layout:true});
},columnWidth:function(g,h){return this._property(this._columns.value.bind(this._columns,g,g),h,{layout:true});
},rowHeight:function(h,g){return this._property(this._rows.value.bind(this._rows,h,h),g,{layout:true});
},frozenRows:function(g){return this._field("_frozenRows",g,{layout:true});
},frozenColumns:function(g){return this._field("_frozenColumns",g,{layout:true});
},_ref:function(k,g,i,h){var j=null;
if(k instanceof c.spreadsheet.Ref){return k;
}if(typeof k==="string"){j=c.spreadsheet.calc.parseReference(k);
}else{if(!i){i=1;
}if(!h){h=1;
}j=new e(new a(k,g),new a(k+i-1,g+h-1));
}return j;
},range:function(j,g,i,h){return new d(this._ref(j,g,i,h),this);
},forEachMergedCell:function(h,g){var i=false;
if(typeof g==="undefined"){g=h;
i=true;
}this._mergedCells.forEach(function(j){if(i||j.intersects(h)){g(j);
}});
},forEachFilterHeader:function(h,g){var i=false;
if(typeof g==="undefined"){g=h;
i=true;
}if(this._filter){this._filter.ref.forEachColumn(function(j){if(i||j.intersects(h)){g(j.topLeft);
}});
}},forEach:function(k,h){var n=this._grid.normalize(k.topLeft);
var g=this._grid.normalize(k.bottomRight);
for(var i=n.col;
i<=g.col;
i++){var l=n.row;
var m=this._grid.index(l,i);
var j=this._grid.index(g.row,i);
this._properties.forEach(m,j,function(o){h(l++,i,o);
});
}},startResizing:function(g){this._initialPosition=g;
this._resizeInProgress=true;
},resizingInProgress:function(){return this._resizeInProgress;
},completeResizing:function(){if(this._resizeInProgress){this._resizeInProgress=false;
var h=this.resizeHintPosition();
if(this._initialPosition&&h){var g=this.resizeHandlePosition();
if(g.col!==-Infinity){this.columnWidth(g.col,this.columnWidth(g.col)-(this._initialPosition.x-h.x));
}else{this.rowHeight(g.row,this.rowHeight(g.row)-(this._initialPosition.y-h.y));
}}else{this.trigger("change",{resize:true});
}}},resizeHandlePosition:function(){return this._resizeHandlePosition;
},resizeHintPosition:function(g){if(g!==undefined){this._resizeHintPosition=g;
this.trigger("change",{resize:true});
}return this._resizeHintPosition;
},removeResizeHandle:function(){if(this._resizeHandlePosition){this._resizeHintPosition=undefined;
this._resizeHandlePosition=undefined;
this._initialPosition=undefined;
this.trigger("change",{resize:true});
}},positionResizeHandle:function(g){this._resizeHandlePosition=g;
this.trigger("change",{resize:true});
},startSelection:function(){this._selectionInProgress=true;
},completeSelection:function(){if(this._selectionInProgress){this._selectionInProgress=false;
this._resizeHintPosition=undefined;
this.trigger("change",{selection:true});
}},selectionInProgress:function(){return this._selectionInProgress;
},select:function(h,g){var i=this._selectionState();
if(h){h=this._ref(h);
if(h.eq(i.originalSelection)){return;
}i.originalSelection=h;
i.selection=this._grid.isAxis(h)?h:this.unionWithMerged(h);
if(g!==false){if(h.isCell()){this.activeCell(h);
}else{this.activeCell(i.selection.lastRange().first());
}i.selectionRangeIndex=i.selection.size()-1;
}else{this.triggerChange({selection:true});
}}return i.selection;
},originalSelect:function(){return this._selectionState().originalSelection;
},currentSelectionRange:function(){var g=this._selectionState();
if(this.singleCellSelection()){return this._sheetRef;
}else{return g.selection.rangeAt(g.selectionRangeIndex).toRangeRef();
}},currentOriginalSelectionRange:function(){var g=this._selectionState();
return g.originalSelection.rangeAt(g.selectionRangeIndex).toRangeRef();
},nextSelectionRange:function(){var g=this._selectionState();
if(!this.singleCellSelection()){g.selectionRangeIndex=g.selection.nextRangeIndex(g.selectionRangeIndex);
}return this.currentSelectionRange();
},selectionRangeIndex:function(){return this._selectionState().selectionRangeIndex;
},previousSelectionRange:function(){var g=this._selectionState();
if(!this.singleCellSelection()){g.selectionRangeIndex=g.selection.previousRangeIndex(g.selectionRangeIndex);
}return this.currentSelectionRange();
},unionWithMerged:function(h){var g=this._mergedCells;
return h.map(function(i){return i.toRangeRef().union(g);
});
},trim:function(h){var i=[];
var g=this._grid;
this._properties.forEachProperty(function(j){i.push(g.trim(h,j.list));
});
return this.unionWithMerged(h.topLeft.toRangeRef().union(i));
},activeCell:function(g){var h=this._selectionState();
if(g){h.originalActiveCell=g;
h.activeCell=this.unionWithMerged(g.toRangeRef());
this.focus(h.activeCell);
this.triggerChange({activeCell:true,selection:true});
}return h.activeCell;
},originalActiveCell:function(){return this._selectionState().originalActiveCell;
},focus:function(h){if(h){this._focus=h.toRangeRef();
}else{var g=this._focus;
this._focus=null;
return g;
}},selection:function(){return new d(this._grid.normalize(this._selectionState().selection),this);
},singleCellSelection:function(){var g=this._selectionState();
return g.activeCell.eq(g.selection);
},selectedHeaders:function(){var k=this.select();
var j={};
var i={};
var g=false;
var h=false;
k.forEach(function(p){var o;
var r="partial";
var n="partial";
p=p.toRangeRef();
var l=p.bottomRight;
var q=l.col===Infinity;
var m=l.row===Infinity;
if(m){h=true;
n="full";
}if(q){g=true;
r="full";
}if(!m){for(o=p.topLeft.row;
o<=l.row;
o++){if(j[o]!=="full"){j[o]=r;
}}}if(!q){for(o=p.topLeft.col;
o<=l.col;
o++){if(i[o]!=="full"){i[o]=n;
}}}});
return{rows:j,cols:i,allRows:h,allCols:g,all:h&&g};
},_edit:function(g){if(g===undefined){return this._inEdit;
}this._inEdit=g;
if(g){this._editSelection.selection=this._viewSelection.selection.clone();
this._editSelection.originalSelection=this._viewSelection.originalSelection.clone();
this._editSelection.activeCell=this._viewSelection.activeCell.clone();
this._editSelection.originalActiveCell=this._viewSelection.originalActiveCell.clone();
}},_setFormulaSelections:function(g){this._formulaSelections=(g||[]).slice();
this.triggerChange({selection:true});
},_viewActiveCell:function(){return this._viewSelection.activeCell.toRangeRef();
},toJSON:function(){var i={};
var j=this._rows.toJSON("height",i);
var g=this._columns.toJSON("width",{});
var k=this._viewSelection;
this.forEach(c.spreadsheet.SHEETREF,function(o,m,l){if(Object.keys(l).length===0){return;
}var n=i[o];
if(n===undefined){n=j.length;
j.push({index:o});
i[o]=n;
}o=j[n];
l.index=m;
if(o.cells===undefined){o.cells=[];
}if(l.formula){l.formula=l.formula.toString();
}if(l.validation){l.validation=l.validation.toJSON();
}if(l.color){l.color=new b(l.color).toHex();
}if(l.background){l.background=new b(l.background).toHex();
}if(l.borderTop&&l.borderTop.color){l.borderTop.color=new b(l.borderTop.color).toHex();
}if(l.borderBottom&&l.borderBottom.color){l.borderBottom.color=new b(l.borderBottom.color).toHex();
}if(l.borderRight&&l.borderRight.color){l.borderRight.color=new b(l.borderRight.color).toHex();
}if(l.borderLeft&&l.borderLeft.color){l.borderLeft.color=new b(l.borderLeft.color).toHex();
}o.cells.push(l);
});
var h={name:this._name,rows:j,columns:g,selection:k.selection.toString(),originalSelection:k.originalSelection.toString(),activeCell:k.activeCell.toString(),originalActiveCell:k.originalActiveCell.toString(),frozenRows:this.frozenRows(),frozenColumns:this.frozenColumns(),mergedCells:this._mergedCells.map(function(l){return l.toString();
})};
if(this._sort){h.sort={ref:this._sort.ref.toString(),columns:this._sort.columns.map(function(l){return{index:l.index,ascending:l.ascending};
})};
}if(this._filter){h.filter={ref:this._filter.ref.toString(),columns:this._filter.columns.map(function(l){var m=l.filter.toJSON();
m.index=l.index;
return m;
})};
}return h;
},fromJSON:function(g){this.batch(function(){if(g.name!==undefined){this._name=g.name;
}if(g.frozenColumns!==undefined){this.frozenColumns(g.frozenColumns);
}if(g.frozenRows!==undefined){this.frozenRows(g.frozenRows);
}if(g.columns!==undefined){this._columns.fromJSON("width",g.columns);
}if(g.rows!==undefined){this._rows.fromJSON("height",g.rows);
for(var k=0;
k<g.rows.length;
k++){var l=g.rows[k];
var m=l.index;
if(m===undefined){m=k;
}if(l.cells){for(var i=0;
i<l.cells.length;
i++){var h=l.cells[i];
var j=h.index;
if(j===undefined){j=i;
}if(h.formula){h.formula=this._compileFormula(m,j,h.formula);
}if(h.validation){h.validation=this._compileValidation(m,j,h.validation);
}this._properties.fromJSON(this._grid.index(m,j),h);
}}}}if(g.selection){this._viewSelection.selection=this._ref(g.selection);
}if(g.originalSelection){this._viewSelection.originalSelection=this._ref(g.originalSelection);
}if(g.activeCell){this._viewSelection.activeCell=this._ref(g.activeCell);
}if(g.originalactiveCell){this._viewSelection.originalActiveCell=this._ref(g.originalActiveCell);
}if(g.mergedCells){g.mergedCells.forEach(function(n){this.range(n).merge();
},this);
}if(g.sort){this._sort={ref:this._ref(g.sort.ref),columns:g.sort.columns.slice(0)};
}if(g.filter){this._filter={ref:this._ref(g.filter.ref),columns:g.filter.columns.map(function(n){return{index:n.index,filter:c.spreadsheet.Filter.create(n)};
})};
}});
},formula:function(g){return this._properties.get("formula",this._grid.cellRefIndex(g));
},validation:function(g){return this._properties.get("validation",this._grid.cellRefIndex(g));
},resetFormulas:function(){this._forFormulas(function(g){g.reset();
});
},resetValidations:function(){this._forValidations(function(g){g.reset();
});
},recalc:function(g){var h=this;
this._forFormulas(function(i){i.exec(g);
});
this._forValidations(function(k){var i=new a(k.row,k.col);
var j=new e(i,i);
k.exec(g,h._get(j,"value"),h._get(j,"format"));
});
},_value:function(i,g,j){var h=this._grid.index(i,g);
if(j!==undefined){this._properties.set("value",h,h,j);
}else{return this._properties.get("value",h);
}},_compileValidation:function(h,g,i){if(i.from){i.from=i.from.replace(/^=/,"");
}if(i.to){i.to=i.from.replace(/^=/,"");
}return c.spreadsheet.validation.compile(this._name,h,g,i);
},_compileFormula:function(i,g,h){h=h.replace(/^=/,"");
h=c.spreadsheet.calc.parseFormula(this._name,i,g,h);
return c.spreadsheet.calc.compile(h);
},_copyValuesInRange:function(n,g,o,k){var h,m,i;
for(h=n.col;
h<=g.col;
h++){m=this._grid.index(n.row,h);
i=this._grid.index(g.row,h);
for(var j=m,l=n.row;
j<=i;
++j,++l){o=o.clone(this._name,l,h);
this._properties.set(k,j,j,o);
}}return o;
},_set:function(k,j,n){var m=this._grid.normalize(k.topLeft);
var g=this._grid.normalize(k.bottomRight);
var h,l,i;
if(n&&j=="formula"){if(typeof n=="string"){n=this._compileFormula(m.row,m.col,n);
}n=this._copyValuesInRange(m,g,n,"formula");
}else{if(n&&j=="validation"){if(typeof n.from=="string"||typeof n.to=="string"){n=this._compileValidation(m.row,m.col,n);
}n=this._copyValuesInRange(m,g,n,"validation");
}else{for(h=m.col;
h<=g.col;
h++){l=this._grid.index(m.row,h);
i=this._grid.index(g.row,h);
this._properties.set(j,l,i,n);
if(j=="formula"){this._properties.set("value",l,i,null);
}}}}},_get:function(i,h){var j=this._grid.normalize(i.topLeft);
var g=this._grid.index(j.row,j.col);
return this._properties.get(h,g);
},batch:function(g,h){var i=this.suspendChanges();
this.suspendChanges(true);
g.call(this);
return this.suspendChanges(i).triggerChange(h);
},_sortBy:function(i,g){var h=null;
g.forEach(function(j){h=this._sorter.sortBy(i,j.index,this._properties.get("value"),j.ascending,h);
},this);
this._sort={ref:i,columns:g};
this.triggerChange({recalc:true});
},_filterBy:function(h,g){this.batch(function(){for(var i=h.topLeft.row;
i<=h.bottomRight.row;
i++){if(this._rows.hidden(i)){this._rows.unhide(i);
}}g.forEach(function(m){var n=h.toColumn(m.index).resize({top:1});
var k=[];
if(n===c.spreadsheet.NULLREF){return;
}this.forEach(n,function(r,q,p){p.row=r;
k.push(p);
});
m.filter.prepare(k);
for(var l=0;
l<k.length;
l++){var j=k[l];
var o=m.filter.value(j);
if(m.filter.matches(o)===false){this.hideRow(j.row);
}}},this);
this._filter={ref:h,columns:g};
},{layout:true,filter:true});
},filter:function(){return this._filter;
},clearFilter:function(g){this._clearFilter(g instanceof Array?g:[g]);
},_clearFilter:function(g){if(this._filter){this.batch(function(){var h=this._filter.columns.filter(function(i){return g.indexOf(i.index)<0;
});
this._filterBy(this._filter.ref,h);
},{layout:true});
}},getAxisState:function(){return{rows:this._rows.getState(),columns:this._columns.getState()};
},setAxisState:function(g){this._rows.setState(g.rows);
this._columns.setState(g.columns);
this.triggerChange({layout:true});
},getState:function(){return{rows:this._rows.getState(),columns:this._columns.getState(),mergedCells:this._mergedCells.map(function(g){return g.clone();
}),properties:this._properties.getState()};
},setState:function(g){this._rows.setState(g.rows);
this._columns.setState(g.columns);
this._mergedCells=g.mergedCells;
this._properties.setState(g.properties);
this.triggerChange(c.spreadsheet.ALL_REASONS);
},_merge:function(i){var g=this._mergedCells;
var j=this;
var h;
this.batch(function(){h=i.map(function(p){if(p instanceof c.spreadsheet.CellRef){return p;
}var m=p.toRangeRef().union(g,function(s){g.splice(g.indexOf(s),1);
});
var o=new d(m,j);
var r=o.value();
var n=o.format();
var l=o.background();
o.value(null);
o.format(null);
o.background(null);
var q=new d(m.collapse(),j);
q.value(r);
q.format(n);
q.background(l);
g.push(m);
return m;
});
var k=j._viewSelection;
k.selection=j.unionWithMerged(k.originalSelection);
k.activeCell=j.unionWithMerged(k.originalActiveCell);
},{activeCell:true,selection:true});
return h;
}});
c.spreadsheet.Sheet=f;
})(kendo);
})();
(function(){(function(d){var a=d.jQuery;
var b=".";
var c=" ";
var f={sheetsBarWrapper:"k-widget k-header",sheetsBarSheetsWrapper:"k-tabstrip k-floatwrap k-tabstrip-bottom",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",sheetsBarAdd:"k-spreadsheet-sheets-bar-add",sheetsBarRemove:"k-spreadsheet-sheets-remove",sheetsBarItems:"k-spreadsheet-sheets-items",sheetsBarEditor:"k-spreadsheet-sheets-editor",sheetsBarScrollable:"k-spreadsheet-sheets-scrollable",sheetsBarNext:"k-spreadsheet-sheets-next",sheetsBarPrev:"k-spreadsheet-sheets-prev",sheetsBarKItem:"k-item k-state-default",sheetsBarKActive:"k-state-active k-state-tab-on-top",sheetsBarKTextbox:"k-textbox",sheetsBarKLink:"k-link",sheetsBarKIcon:"k-icon",sheetsBarKFontIcon:"k-font-icon",sheetsBarKButton:"k-button k-button-icon",sheetsBarKButtonBare:"k-button-bare",sheetsBarKArrowW:"k-i-arrow-w",sheetsBarKArrowE:"k-i-arrow-e",sheetsBarKReset:"k-reset k-tabstrip-items",sheetsBarKIconX:"k-i-x",sheetsBarKSprite:"k-sprite",sheetsBarKIconPlus:"k-i-plus",sheetsBarHintWrapper:"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint",sheetsBarKResetItems:"k-reset k-tabstrip-items"};
var e=d.ui.Widget.extend({init:function(h,i){var g=e.classNames;
d.ui.Widget.call(this,h,i);
h=this.element;
h.addClass(g.sheetsBarWrapper);
this._tree=new d.dom.Tree(h[0]);
this._tree.render([this._addButton(),this._createSheetsWrapper([])]);
this._createSortable();
this._sortable.bind("start",this._onSheetReorderStart.bind(this));
this._sortable.bind("end",this._onSheetReorderEnd.bind(this));
h.on("click",b+g.sheetsBarRemove,this._onSheetRemove.bind(this));
h.on("click","li",this._onSheetSelect.bind(this));
h.on("dblclick","li"+b+g.sheetsBarActive,this._createEditor.bind(this));
h.on("click",b+g.sheetsBarAdd,this._onAddSelect.bind(this));
},options:{name:"SheetsBar",scrollable:{distance:200}},events:["select","reorder","rename"],_createEditor:function(){if(this._editor){return;
}this._renderSheets(this._sheets,this._selectedIndex,true);
this._editor=this.element.find(d.format("input{0}{1}",b,e.classNames.sheetsBarEditor)).focus().on("keydown",this._onEditorKeydown.bind(this)).on("blur",this._onEditorBlur.bind(this));
},_destroyEditor:function(){this._editor.off();
this._editor=null;
this._renderSheets(this._sheets,this._selectedIndex,false);
},renderSheets:function(h,g){if(!h||g<0){return;
}this._renderSheets(h,g,false);
},_renderSheets:function(m,l,h){var q=this;
var r;
var o;
var k;
var j;
var p=q._sheetsWrapper();
var n=q._sheetsGroup();
var i=q.options;
var g=e.classNames;
q._sheets=m;
q._selectedIndex=l;
if(!q._scrollableAllowed()){q._renderHtml(h,false);
return;
}p.addClass(g.sheetsBarScrollable+c+g.sheetsBarSheetsWrapper);
r=p[0].offsetWidth;
o=n[0].scrollWidth;
if(o>r&&!q._scrollableModeActive){q._nowScrollingSheets=false;
q._isRtl=d.support.isRtl(q.element);
q._renderHtml(h,true);
k=p.children(b+g.sheetsBarPrev);
j=p.children(b+g.sheetsBarNext);
n.css({marginLeft:k.outerWidth()+9,marginRight:j.outerWidth()+12});
k.on("mousedown",function(){q._nowScrollingSheets=true;
q._scrollSheetsByDelta(i.scrollable.distance*(q._isRtl?1:-1));
});
j.on("mousedown",function(){q._nowScrollingSheets=true;
q._scrollSheetsByDelta(i.scrollable.distance*(q._isRtl?-1:1));
});
k.add(j).on("mouseup",function(){q._nowScrollingSheets=false;
});
q._scrollableModeActive=true;
q._toggleScrollButtons();
}else{if(q._scrollableModeActive&&o<=r){q._scrollableModeActive=false;
p.children(b+g.sheetsBarPrev).off();
p.children(b+g.sheetsBarNext).off();
q._renderHtml(h,false);
q._sheetsGroup().css({marginLeft:"",marginRight:""});
}else{q._renderHtml(h,false);
}}},_renderHtml:function(n,p){var m;
var s=[];
var j=d.dom;
var k=j.element;
var t=this._sheets;
var q=this._selectedIndex;
var h=e.classNames;
for(m=0;
m<t.length;
m++){var r=t[m];
var o=(m===q);
var g={className:h.sheetsBarKItem+c};
var l=[];
if(o){g.className+=h.sheetsBarKActive+c+h.sheetsBarActive;
}else{g.className+=h.sheetsBarInactive;
}if(o&&n){l.push(k("input",{type:"text",value:r.name(),className:h.sheetsBarKTextbox+c+h.sheetsBarEditor,maxlength:50},[]));
}else{l.push(k("span",{className:h.sheetsBarKLink,title:r.name()},[j.text(r.name())]));
var i=k("span",{className:h.sheetsBarKIcon+c+h.sheetsBarKFontIcon+c+h.sheetsBarKIconX},[]);
l.push(k("span",{className:h.sheetsBarKLink+c+h.sheetsBarRemove},[i]));
}s.push(k("li",g,l));
}this._tree.render([this._addButton(),this._createSheetsWrapper(s,p)]);
},_createSheetsWrapper:function(l,k){var j=d.dom.element;
var i=e.classNames;
var h=[j("ul",{className:i.sheetsBarKReset},l)];
if(k){var g=i.sheetsBarKButton+c+i.sheetsBarKButtonBare+c;
h.push(j("span",{className:g+i.sheetsBarPrev},[j("span",{className:i.sheetsBarKIcon+c+i.sheetsBarKArrowW},[])]));
h.push(j("span",{className:g+i.sheetsBarNext},[j("span",{className:i.sheetsBarKIcon+c+i.sheetsBarKArrowE},[])]));
}return j("div",{className:i.sheetsBarItems},h);
},_createSortable:function(){var g=e.classNames;
this._sortable=new d.ui.Sortable(this.element,{filter:d.format("ul li.{0},ul li.{1}",g.sheetsBarActive,g.sheetsBarInactive),container:b+g.sheetsBarItems,axis:"x",animation:false,ignore:"input",hint:function(h){var i=a(h).clone();
return i.wrap("<div class='"+g.sheetsBarHintWrapper+"'><ul class='"+g.sheetsBarKResetItems+"'></ul></div>").closest("div");
}});
},_onEditorKeydown:function(g){if(this._editor){if(g.which===13){this._destroyEditor();
this._onSheetRename(a(g.target).val());
}if(g.which===27){this._destroyEditor();
this._onSheetRename();
}}},_onEditorBlur:function(g){if(this._editor){this._destroyEditor();
this._onSheetRename(a(g.target).val());
}},_onSheetReorderEnd:function(g){g.preventDefault();
this.trigger("reorder",{oldIndex:g.oldIndex,newIndex:g.newIndex});
},_onSheetReorderStart:function(g){if(this._editor){g.preventDefault();
}},_onSheetRemove:function(g){var h=a(g.target).closest("li").text();
if(this._editor){this._destroyEditor();
this._onSheetRename(this._editor.val());
}this.trigger("remove",{name:h});
},_onSheetSelect:function(g){var i=a(g.target).text();
if(a(g.target).is(b+e.classNames.sheetsBarEditor)||!i){g.preventDefault();
return;
}if(this._editor){var h=this._editor.val();
this._destroyEditor();
this._onSheetRename(h);
}this.trigger("select",{name:i,isAddButton:false});
},_onSheetRename:function(g){this.trigger("rename",{name:g,sheetIndex:this._selectedIndex});
},_onAddSelect:function(){this.trigger("select",{isAddButton:true});
},_addButton:function(){var h=d.dom.element;
var g=e.classNames;
return h("a",{className:g.sheetsBarAdd+c+g.sheetsBarKButton},[h("span",{className:g.sheetsBarKSprite+c+g.sheetsBarKIcon+c+g.sheetsBarKFontIcon+c+g.sheetsBarKIconPlus},[])]);
},destroy:function(){this._sortable.destroy();
},_scrollableAllowed:function(){var g=this.options;
return g.scrollable&&!isNaN(g.scrollable.distance);
},_scrollSheetsToItem:function(h){var o=this;
var l=o._sheetsGroup();
var g=l.scrollLeft();
var k=h.outerWidth();
var i=o._isRtl?h.position().left:h.position().left-l.children().first().position().left;
var n=l[0].offsetWidth;
var m=Math.ceil(parseFloat(l.css("padding-left")));
var j;
if(o._isRtl){if(i<0){j=g+i-(n-g)-m;
}else{if(i+k>n){j=g+i-k+m*2;
}}}else{if(g+n<i+k){j=i+k-n+m*2;
}else{if(g>i){j=i-m;
}}}l.finish().animate({scrollLeft:j},"fast","linear",function(){o._toggleScrollButtons();
});
},_sheetsGroup:function(){return this._sheetsWrapper().children("ul");
},_sheetsWrapper:function(){return this.element.find(b+e.classNames.sheetsBarItems);
},_scrollSheetsByDelta:function(g){var j=this;
var i=j._sheetsGroup();
var h=i.scrollLeft();
i.finish().animate({scrollLeft:h+g},"fast","linear",function(){if(j._nowScrollingSheets){j._scrollSheetsByDelta(g);
}else{j._toggleScrollButtons();
}});
},_toggleScrollButtons:function(){var h=this;
var i=h._sheetsGroup();
var j=h._sheetsWrapper();
var g=i.scrollLeft();
j.find(b+e.classNames.sheetsBarPrev).toggle(h._isRtl?g<i[0].scrollWidth-i[0].offsetWidth-1:g!==0);
j.find(b+e.classNames.sheetsBarNext).toggle(h._isRtl?g!==0:g<i[0].scrollWidth-i[0].offsetWidth-1);
}});
d.spreadsheet.SheetsBar=e;
a.extend(true,e,{classNames:f});
})(window.kendo);
})();
(function(){(function(b){var a=b.jQuery;
var c=b.Observable.extend({init:function(d){b.Observable.fn.init.call(this);
this.options=d;
this._sheets=[];
this._sheetsSearchCache={};
this._sheet=this.insertSheet({rows:this.options.rows,columns:this.options.columns,rowHeight:this.options.rowHeight,columnWidth:this.options.columnWidth,headerHeight:this.options.headerHeight,headerWidth:this.options.headerWidth,dataSource:this.options.dataSource});
this.undoRedoStack=new b.util.UndoRedoStack();
this.undoRedoStack.bind(["undo","redo"],this._onUndoRedo.bind(this));
this._context=new b.spreadsheet.FormulaContext(this);
this.fromJSON(this.options);
},clipboard:function(){if(!this._clipboard){this._clipboard=new b.spreadsheet.Clipboard(this);
}return this._clipboard;
},destroy:function(){this.unbind();
if(this._clipboard){this._clipboard.destroy();
}},events:["change"],_sheetChange:function(d){this.trigger("change",d);
},_inputForRef:function(d){return new b.spreadsheet.Range(d,this._sheet).input();
},_onUndoRedo:function(d){d.command.range().select();
},execute:function(f){var e=a.extend({workbook:this},f.options);
var d=new b.spreadsheet[f.command](e);
if(e.operatingRange){d.range(e.operatingRange);
}else{d.range(this._sheet.selection());
}var g=d.exec();
if(!g){this.undoRedoStack.push(d);
}else{return g;
}},resetFormulas:function(){this._sheets.forEach(function(d){d.resetFormulas();
});
},resetValidations:function(){this._sheets.forEach(function(d){d.resetValidations();
});
},refresh:function(d){if(d.recalc){this.resetFormulas();
this.resetValidations();
this._sheet.recalc(this._context);
}},activeSheet:function(d){if(d===undefined){return this._sheet;
}if(!this.sheetByName(d.name())){return;
}this._sheet=d;
d.triggerChange(b.spreadsheet.ALL_REASONS);
},moveSheetToIndex:function(e,g){var d=this.sheetIndex(e);
var f=this._sheets;
if(d===-1){return;
}this._sheetsSearchCache={};
f.splice(g,0,f.splice(d,1)[0]);
this.trigger("change",{sheetSelection:true});
},insertSheet:function(f){f=f||{};
var j=this;
var e=typeof f.index==="number"?f.index:j._sheets.length;
var h;
var i=j._sheets;
var d=function(l){l=l?l:1;
var k="Sheet"+l;
if(!j.sheetByName(k)){return k;
}return d(l+1);
};
if(f.name&&j.sheetByName(f.name)){return;
}this._sheetsSearchCache={};
h=f.name||d();
var g=new b.spreadsheet.Sheet(f.rows||this.options.rows,f.columns||this.options.columns,f.rowHeight||this.options.rowHeight,f.columnWidth||this.options.columnWidth,f.headerHeight||this.options.headerHeight,f.headerWidth||this.options.headerWidth);
g._workbook=this;
g.name(h);
g.bind("change",this._sheetChange.bind(this));
i.splice(e,0,g);
if(f.dataSource){g.setDataSource(f.dataSource);
}this.trigger("change",{sheetSelection:true});
return g;
},sheets:function(){return this._sheets.slice();
},sheetByName:function(d){return this._sheets[this.sheetIndex(d)];
},sheetByIndex:function(d){return this._sheets[d];
},sheetIndex:function(f){var h=this._sheets;
var g=(typeof f=="string"?f:f.name()).toLowerCase();
var d=this._sheetsSearchCache[g];
if(d>=0){return d;
}for(d=0;
d<h.length;
d++){var e=h[d].name().toLowerCase();
this._sheetsSearchCache[e]=d;
if(e===g){return d;
}}return -1;
},renameSheet:function(f,d){var e=f.name();
if(!d||e===d){return;
}f=this.sheetByName(e);
if(!f){return;
}this._sheetsSearchCache={};
f.name(d);
this.trigger("change",{sheetSelection:true});
return f;
},removeSheet:function(g){var i=this;
var h=i._sheets;
var e=g.name();
var d=i.sheetIndex(g);
if(h.length===1){return;
}this._sheetsSearchCache={};
if(d>-1){g.unbind();
h.splice(d,1);
if(i.activeSheet().name()===e){var f=h[d===h.length?d-1:d];
i.activeSheet(f);
}else{this.trigger("change",{recalc:true,sheetSelection:true});
}}},fromJSON:function(f){if(f.sheets){for(var e=0;
e<f.sheets.length;
e++){var g=this.sheetByIndex(e);
if(!g){g=this.insertSheet();
}g.fromJSON(f.sheets[e]);
var d=f.sheets[e].dataSource;
if(d){g.setDataSource(d);
}}}if(f.activeSheet){this.activeSheet(this.sheetByName(f.activeSheet));
}},toJSON:function(){this.resetFormulas();
this.resetValidations();
return{activeSheet:this.activeSheet().name(),sheets:this._sheets.map(function(d){d.recalc(this._context);
return d.toJSON();
},this)};
}});
b.spreadsheet.Workbook=c;
})(kendo);
})();
(function(){var e=kendo.spreadsheet;
var a=kendo.spreadsheet.CellRef;
var d=kendo.spreadsheet.RangeRef;
var f=kendo.spreadsheet.UnionRef;
var c=kendo.spreadsheet.NameRef;
var b=kendo.Class.extend({init:function(g){this.workbook=g;
},getRefCells:function(r,m){var t,l,y,o;
if(r instanceof a){t=this.workbook.sheetByName(r.sheet);
if(!t){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("SHEET")}];
}l=t.formula(r);
y=t.range(r.row,r.col).value();
if(l!=null||y!=null){return[{formula:l,value:y,row:r.row,col:r.col,sheet:r.sheet,hidden:m?(t.columnWidth(r.col)===0||t.rowHeight(r.row)===0):false}];
}else{return[];
}}if(r instanceof d){o=this.workbook.sheetIndex(r.sheet);
var v=[],q=o;
if(r.endSheet){q=this.workbook.sheetIndex(r.endSheet);
if(o>q){var x=o;
o=q;
q=x;
}}if(o<0||q<0){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("SHEET")}];
}while(o<=q){t=this.workbook.sheetByIndex(o++);
var w=t._grid.normalize(r.topLeft);
var h=t._grid.normalize(r.bottomRight);
var u=t._grid.cellRefIndex(w);
var k=t._grid.cellRefIndex(h);
var z=t._properties.iterator("value",u,k);
for(var j=w.col;
j<=h.col;
++j){for(var s=w.row;
s<=h.row;
++s){var p=t._grid.index(s,j);
l=t._properties.get("formula",p);
y=z.at(p);
if(l!=null||y!=null){v.push({formula:l,value:y,row:s,col:j,sheet:t.name(),hidden:m?(t.columnWidth(j)===0||t.rowHeight(s)===0):false});
}}}}return v;
}if(r instanceof f){var g=[];
for(o=0;
o<r.refs.length;
++o){g=g.concat(this.getRefCells(r.refs[o],m));
}return g;
}if(r instanceof c){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("NAME")}];
}return[];
},getData:function(h){var g=this.getRefCells(h).map(function(i){return i.value;
});
return h instanceof a?g[0]:g;
},onFormula:function(i){var k=this.workbook.sheetByName(i.sheet);
var j=i.row,g=i.col,l=i.value;
var h=k.formula({row:j,col:g});
if(h!==i){return false;
}if(l instanceof kendo.spreadsheet.calc.runtime.Matrix){l.each(function(o,n,m){k._value(j+n,g+m,o);
});
}else{k._value(j,g,l);
}return true;
}});
e.FormulaContext=b;
})();
(function(){(function(m){var a=m.jQuery;
var c={up:"up",down:"down",left:"left",right:"right",home:"first-col","ctrl+left":"first-col",end:"last-col","ctrl+right":"last-col","ctrl+up":"first-row","ctrl+down":"last-row","ctrl+home":"first","ctrl+end":"last",pageup:"prev-page",pagedown:"next-page"};
var j={tab:"next","shift+tab":"previous",enter:"lower","shift+enter":"upper","delete":"clearContents",backspace:"clearContents","shift+:alphanum":"edit",":alphanum":"edit","ctrl+:alphanum":"ctrl",":edit":"edit"};
var f={wheel:"onWheel","*+mousedown":"onMouseDown",contextmenu:"onContextMenu","*+mousedrag":"onMouseDrag","*+mouseup":"onMouseUp","*+dblclick":"onDblClick",mousemove:"onMouseMove"};
var d={"*+pageup":"onPageUp","*+pagedown":"onPageDown",mouseup:"onMouseUp","*+cut":"onCut","*+paste":"onPaste","*+copy":"onCopy"};
var h={esc:"onEditorEsc",enter:"onEditorBlur","shift+enter":"onEditorBlur",tab:"onEditorBlur","shift+tab":"oonEditorBlur"};
var k=a.extend({focus:"onEditorBarFocus"},h);
var l=a.extend({focus:"onEditorCellFocus"},h);
var o={cell:"range",rowheader:"row",columnheader:"column",topcorner:"sheet"};
function q(s){return s.map(function(t){return'[data-action="'+t+'"]';
}).join(",");
}var e=q(["cut","copy","paste","insert-left","insert-right","insert-above","insert-below"]);
var r=q(["unhide-row","unhide-column"]);
var b=[];
var p=[];
var i=[];
for(var n in c){b.push(n);
p.push("shift+"+n);
}for(n in j){i.push(n);
}d[b]="onAction";
d[p]="onShiftAction";
d[i]="onEntryAction";
l[b]="onEditorAction";
l[p]="onEditorShiftAction";
var g=m.Class.extend({init:function(s,t){this.view=s;
this.workbook(t);
this.container=a(s.container);
this.clipboardElement=a(s.clipboard);
this.cellContextMenu=s.cellContextMenu;
this.rowHeaderContextMenu=s.rowHeaderContextMenu;
this.colHeaderContextMenu=s.colHeaderContextMenu;
this.scroller=s.scroller;
this.tabstrip=s.tabstrip;
this.editor=s.editor;
this.editor.bind("change",this.onEditorChange.bind(this));
this.editor.bind("activate",this.onEditorActivate.bind(this));
this.editor.bind("deactivate",this.onEditorDeactivate.bind(this));
this.editor.bind("update",this.onEditorUpdate.bind(this));
a(s.scroller).on("scroll",this.onScroll.bind(this));
this.listener=new m.spreadsheet.EventListener(this.container,this,f);
this.keyListener=new m.spreadsheet.EventListener(this.clipboardElement,this,d);
this.barKeyListener=new m.spreadsheet.EventListener(this.editor.barElement(),this,k);
this.inputKeyListener=new m.spreadsheet.EventListener(this.editor.cellElement(),this,l);
s.sheetsbar.bind("select",this.onSheetBarSelect.bind(this));
s.sheetsbar.bind("reorder",this.onSheetBarReorder.bind(this));
s.sheetsbar.bind("rename",this.onSheetBarRename.bind(this));
s.sheetsbar.bind("remove",this.onSheetBarRemove.bind(this));
this.cellContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.rowHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.colHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on("contextmenu",false);
if(this.tabstrip){this.tabstrip.bind("action",this.onCommandRequest.bind(this));
this.tabstrip.bind("dialog",this.onDialogRequest.bind(this));
}a(this.view.container).on("click",".k-spreadsheet-filter",this.onFilterHeaderClick.bind(this));
},_execute:function(s){var t=this._workbook.execute(s);
if(t){this.view.showError(t);
}},onContextMenuSelect:function(u){var s=a(u.item).data("action");
var t;
switch(s){case"cut":this.onCut();
break;
case"copy":this.onCopy();
break;
case"paste":this.onPaste();
break;
case"unmerge":t={command:"MergeCellCommand",options:{value:"unmerge"}};
break;
case"merge":this.view.openDialog("merge");
break;
case"hide-row":t={command:"HideLineCommand",options:{axis:"row"}};
break;
case"hide-column":t={command:"HideLineCommand",options:{axis:"column"}};
break;
case"unhide-row":t={command:"UnHideLineCommand",options:{axis:"row"}};
break;
case"unhide-column":t={command:"UnHideLineCommand",options:{axis:"column"}};
break;
case"delete-row":t={command:"DeleteRowCommand"};
break;
case"delete-column":t={command:"DeleteColumnCommand"};
break;
}if(t){this._execute(t);
}},onSheetBarRemove:function(s){var t=this._workbook.sheetByName(s.name);
if(!t){return;
}this._workbook.removeSheet(t);
},destroy:function(){this.listener.destroy();
this.keyListener.destroy();
this.inputKeyListener.destroy();
},onSheetBarSelect:function(s){var t;
var u=this._workbook;
if(s.isAddButton){t=u.insertSheet();
}else{t=u.sheetByName(s.name);
}if(u.activeSheet().name()!==t.name()){u.activeSheet(t);
}},onSheetBarReorder:function(s){var t=this._workbook.sheetByIndex(s.oldIndex);
this._workbook.moveSheetToIndex(t,s.newIndex);
this._workbook.activeSheet(t);
},onSheetBarRename:function(s){var t=this._workbook.sheetByIndex(s.sheetIndex);
this._workbook.renameSheet(t,s.name);
this.clipboardElement.focus();
},sheet:function(s){this.navigator=s.navigator();
this.axisManager=s.axisManager();
},workbook:function(s){this._workbook=s;
this.clipboard=s.clipboard();
},refresh:function(){var s=this._workbook;
this._viewPortHeight=this.view.scroller.clientHeight;
this.navigator.height(this._viewPortHeight);
if(!this.editor.isActive()){this.editor.value(s._inputForRef(s.activeSheet().activeCell()));
}},onScroll:function(){this.view.render();
},onWheel:function(u){var s=u.originalEvent.deltaX;
var t=u.originalEvent.deltaY;
if(u.originalEvent.deltaMode===1){s*=10;
t*=10;
}this.scrollWith(s,t);
u.preventDefault();
},onAction:function(t,s){this.navigator.moveActiveCell(c[s]);
t.preventDefault();
},onPageUp:function(){this.scrollDown(-this._viewPortHeight);
},onPageDown:function(){this.scrollDown(this._viewPortHeight);
},onEntryAction:function(t,s){if(t.mod){var v=true;
var u=String.fromCharCode(t.keyCode);
switch(u){case"A":this.navigator.selectAll();
break;
case"Y":this._workbook.undoRedoStack.redo();
break;
case"Z":this._workbook.undoRedoStack.undo();
break;
default:v=false;
break;
}if(v){t.preventDefault();
}}else{if(s=="delete"||s=="backspace"){this._execute({command:"ClearContentCommand"});
t.preventDefault();
}else{if(s===":alphanum"||s===":edit"){if(s===":alphanum"){this.editor.value("");
}this.editor.activate({rect:this.view.activeCellRectangle()}).focus();
}else{this.navigator.navigateInSelection(j[s]);
t.preventDefault();
}}}},onShiftAction:function(t,s){this.navigator.modifySelection(c[s.replace("shift+","")],this.appendSelection);
t.preventDefault();
},onMouseMove:function(s){var u=this._workbook.activeSheet();
if(u.resizingInProgress()||u.selectionInProgress()){return;
}var t=this.objectAt(s);
if(t.type==="columnresizehandle"||t.type==="rowresizehandle"){u.positionResizeHandle(t.ref);
}else{u.removeResizeHandle();
}},onMouseDown:function(s){var t=this.objectAt(s);
if(t.pane){this.originFrame=t.pane;
}if(this.editor.canInsertRef(false)&&t.ref){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
this.navigator.startSelection(t.ref,this._selectionMode,this.appendSelection);
s.preventDefault();
return;
}else{this.editor.deactivate();
}var u=this._workbook.activeSheet();
if(t.type==="columnresizehandle"||t.type==="rowresizehandle"){u.startResizing({x:t.x,y:t.y});
s.preventDefault();
return;
}this._selectionMode=o[t.type];
this.appendSelection=s.mod;
this.navigator.startSelection(t.ref,this._selectionMode,this.appendSelection);
},onContextMenu:function(s){var x=this._workbook.activeSheet();
if(x.resizingInProgress()){return;
}s.preventDefault();
this.cellContextMenu.close();
this.colHeaderContextMenu.close();
this.rowHeaderContextMenu.close();
var v;
var u={pageX:s.pageX,pageY:s.pageY};
var w=this.objectAt(u);
if(w.type==="columnresizehandle"||w.type==="rowresizehandle"){return;
}this.navigator.selectForContextMenu(w.ref,o[w.type]);
var t=this.navigator._sheet.select() instanceof m.spreadsheet.UnionRef;
var y=false;
var z=false;
if(w.type==="cell"){v=this.cellContextMenu;
z=this.navigator.selectionIncludesMergedCells();
}else{if(w.type=="columnheader"){v=this.colHeaderContextMenu;
y=!t&&this.axisManager.selectionIncludesHiddenColumns();
}else{if(w.type=="rowheader"){v=this.rowHeaderContextMenu;
y=!t&&this.axisManager.selectionIncludesHiddenRows();
}}}v.element.find(e).toggle(!t);
v.element.find(r).toggle(y);
v.element.find("[data-action=unmerge]").toggle(z);
setTimeout(function(){v.open(s.pageX,s.pageY);
});
},prevent:function(s){s.preventDefault();
},constrainResize:function(v,s){var u=this._workbook.activeSheet();
var t=u.resizeHandlePosition();
return !t||v==="outside"||v==="topcorner"||s.col<t.col||s.row<t.row;
},onMouseDrag:function(s){if(this._selectionMode==="sheet"){return;
}var u={pageX:s.pageX,pageY:s.pageY};
var v=this.objectAt(u);
var w=this._workbook.activeSheet();
if(w.resizingInProgress()){if(!this.constrainResize(v.type,v.ref)){w.resizeHintPosition({x:v.x,y:v.y});
}return;
}if(v.type==="outside"){this.startAutoScroll(v);
return;
}if(this.originFrame===v.pane){this.selectToLocation(u);
}else{var t=this.originFrame._grid;
if(v.x>t.right){this.scrollLeft();
}if(v.y>t.bottom){this.scrollTop();
}if(v.y<t.top||v.x<t.left){this.startAutoScroll(v,u);
}else{this.selectToLocation(u);
}}s.preventDefault();
},onMouseUp:function(u){var w=this._workbook.activeSheet();
w.completeResizing();
this.navigator.completeSelection();
this.stopAutoScroll();
var s=this.editor.activeEditor();
if(!s){return;
}var t=u.target;
while(t){if(t===s.element[0]){return;
}t=t.parentNode;
}var v=this.objectAt(u);
if(v&&v.ref&&s.canInsertRef(false)){s.refAtPoint(w.selection()._ref);
w._setFormulaSelections(s.highlightedRefs());
}},onDblClick:function(s){var t=this.objectAt(s);
if(t.type!=="cell"){return;
}this.editor.activate({rect:this.view.activeCellRectangle()}).focus();
this.onEditorUpdate();
},onCut:function(){this._execute({command:"CutCommand",options:{workbook:this.view._workbook}});
},clipBoardValue:function(){return this.clipboardElement.html();
},onPaste:function(s){var t="";
var u="";
if(s){if(s.originalEvent.clipboardData&&s.originalEvent.clipboardData.getData){s.preventDefault();
if(/text\/html/.test(s.originalEvent.clipboardData.types)){t=s.originalEvent.clipboardData.getData("text/html");
}if(/text\/plain/.test(s.originalEvent.clipboardData.types)){u=s.originalEvent.clipboardData.getData("text/plain");
}}else{var v=this.clipboardElement.find("table.kendo-clipboard").detach();
this.clipboardElement.empty();
setTimeout(function(){this.clipboard.external({html:this.clipboardElement.html(),plain:window.clipboardData.getData("Text")});
this.clipboardElement.empty().append(v);
this._execute({command:"PasteCommand",options:{workbook:this.view._workbook}});
}.bind(this));
return;
}}else{if(m.support.browser.msie){this.clipboardElement.focus().select();
document.execCommand("paste");
return;
}else{window.alert("todo: add dialog \n use ctrl+v instead");
return;
}}this.clipboard.external({html:t,plain:u});
this._execute({command:"PasteCommand",options:{workbook:this.view._workbook}});
},onCopy:function(){this._execute({command:"CopyCommand",options:{workbook:this.view._workbook}});
},scrollTop:function(){this.scroller.scrollTop=0;
},scrollLeft:function(){this.scroller.scrollLeft=0;
},scrollDown:function(s){this.scroller.scrollTop+=s;
},scrollRight:function(s){this.scroller.scrollLeft+=s;
},scrollWith:function(t,s){this.scroller.scrollTop+=s;
this.scroller.scrollLeft+=t;
},objectAt:function(t){var u=this.container.offset();
var s={left:t.pageX-u.left,top:t.pageY-u.top};
return this.view.objectAt(s.left,s.top);
},selectToLocation:function(s){var t=this.objectAt(s);
if(t.pane){this.extendSelection(t);
this.lastKnownCellLocation=s;
this.originFrame=t.pane;
}this.stopAutoScroll();
},extendSelection:function(s){this.navigator.extendSelection(s.ref,this._selectionMode,this.appendSelection);
},autoScroll:function(){var z=this._autoScrollTarget.x;
var A=this._autoScrollTarget.y;
var s=this.originFrame._grid;
var t=this.view.scroller;
var v=8;
var u=t.scrollLeft;
var w=t.scrollTop;
if(z<s.left){this.scrollRight(-v);
}if(z>s.right){this.scrollRight(v);
}if(A<s.top){this.scrollDown(-v);
}if(A>s.bottom){this.scrollDown(v);
}if(w===t.scrollTop&&u===t.scrollLeft){this.selectToLocation(this.finalLocation);
}else{this.extendSelection(this.objectAt(this.lastKnownCellLocation));
}},startAutoScroll:function(t,s){if(!this._scrollInterval){this._scrollInterval=setInterval(this.autoScroll.bind(this),50);
}this.finalLocation=s||this.lastKnownCellLocation;
this._autoScrollTarget=t;
},stopAutoScroll:function(){clearInterval(this._scrollInterval);
this._scrollInterval=null;
},onEditorChange:function(s){this._workbook.activeSheet()._edit(false);
this._execute({command:"EditCommand",options:{value:s.value}});
},onEditorActivate:function(){var t=this._workbook;
var s=t.activeSheet();
s._setFormulaSelections(this.editor.highlightedRefs());
s._edit(true);
},onEditorDeactivate:function(){var s=this._workbook.activeSheet();
s._edit(false);
s._setFormulaSelections([]);
},onEditorUpdate:function(){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
},onEditorBarFocus:function(){this.editor.activate({rect:this.view.activeCellRectangle()});
},onEditorCellFocus:function(){this.editor.scale();
},onEditorEsc:function(){this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));
this.editor.deactivate();
this.clipboardElement.focus();
},onEditorBlur:function(s,t){if(this.editor.isFiltered()){return;
}this.editor.deactivate();
this.clipboardElement.focus();
this.navigator.navigateInSelection(j[t]);
},onEditorAction:function(u,s){var t=this.editor;
var v=this._workbook.activeSheet();
if(t.canInsertRef(true)){this.navigator.moveActiveCell(c[s]);
t.activeEditor().refAtPoint(v.selection()._ref);
v._setFormulaSelections(t.highlightedRefs());
u.preventDefault();
}},onEditorShiftAction:function(u,s){var t=this.editor;
var v=this._workbook.activeSheet();
if(t.canInsertRef(true)){this.navigator.modifySelection(c[s.replace("shift+","")],this.appendSelection);
t.activeEditor().refAtPoint(v.selection()._ref);
v._setFormulaSelections(t.highlightedRefs());
u.preventDefault();
}},onFilterHeaderClick:function(s){var u=a(s.currentTarget);
var t=this.view.createFilterMenu(u.data("column"));
t.bind("action",this.onCommandRequest.bind(this));
t.bind("action",t.close.bind(t));
t.openFor(u);
},onCommandRequest:function(s){if(s.command){this._execute(s);
}else{this._workbook.undoRedoStack[s.action]();
}},onDialogRequest:function(s){this.view.openDialog(s.name,s.options);
}});
m.spreadsheet.Controller=g;
})(window.kendo);
})();
(function(){(function(k){var a=k.jQuery;
var g=k.spreadsheet.CellRef;
var i=".";
var o=7;
var t={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-headers",filterButton:"k-spreadsheet-filter",icon:"k-icon k-font-icon",iconFilterDefault:"k-i-arrow-s",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu"};
function q(v){var x=window.getSelection();
x.removeAllRanges();
var w=document.createRange();
w.selectNodeContents(v);
x.addRange(w);
}function e(x,w){var v=x.trs[w].children;
return v[v.length-2];
}function d(y,x){var w=y.trs[x-1];
var v=y.trs[x].children.length-1;
if(w&&v>=0){return w.children[v];
}}function f(v){return["solid",v.size||"1px",v.color||"#000"].join(" ");
}function b(B,y,w){var A={};
if(w.background){A.backgroundColor=w.background;
}if(w.color){A.color=w.color;
}if(w.fontFamily){A.fontFamily=w.fontFamily;
}if(w.underline){A.textDecoration="underline";
}if(w.italic){A.fontStyle="italic";
}if(w.textAlign){A.textAlign=w.textAlign;
}if(w.verticalAlign){A.verticalAlign=w.verticalAlign;
}if(w.bold){A.fontWeight="bold";
}if(w.fontSize){A.fontSize=w.fontSize+"px";
}if(w.wrap===true){A.whiteSpace="normal";
A.wordBreak="break-all";
}else{A.whiteSpace="nowrap";
}if(w.borderRight){A.borderRight=f(w.borderRight);
}if(w.borderBottom){A.borderBottom=f(w.borderBottom);
}var x=w.value,D=typeof x;
if(w.format&&x!==null){x=k.spreadsheet.formatting.format(x,w.format);
if(x.__dataType){D=x.__dataType;
}}if(!A.textAlign){switch(D){case"number":case"date":A.textAlign="right";
break;
case"boolean":A.textAlign="center";
break;
}}var C=B.addCell(y,x,A);
var v,z;
if(w.borderLeft){z=e(B,y);
v=f(w.borderLeft);
if(z&&v){z.attr.style.borderRight=v;
}}if(w.borderTop){z=d(B,y);
v=f(w.borderTop);
if(z&&v){z.attr.style.borderBottom=v;
}}return C;
}var j=k.Class.extend({init:function(){this.cols=[];
this.trs=[];
this._height=0;
this._width=0;
},addColumn:function(w){this._width+=w;
var v=k.dom.element("col",{style:{width:w+"px"}});
v.visible=w>0;
this.cols.push(v);
},addRow:function(w){var v=null;
v={style:{height:w+"px"}};
this._height+=w;
var x=k.dom.element("tr",v);
x.visible=w>0;
this.trs.push(x);
},addCell:function(w,z,x,v){if(z===null||z===undefined){z="";
}if(!(z instanceof k.dom.Node)){z=k.dom.text(z);
}var y=k.dom.element("td",{style:x,className:v},[z]);
this.trs[w].children.push(y);
return y;
},toDomTree:function(w,z,v){this.trs=this.trs.filter(function(x){return x.visible;
});
this.cols=this.cols.filter(function(y,x){if(!y.visible){this.trs.forEach(function(A){A.children.splice(x,1);
});
}return y.visible;
},this);
return k.dom.element("table",{style:{left:w+"px",top:z+"px",height:this._height+"px",width:this._width+"px"},className:v},[k.dom.element("colgroup",null,this.cols),k.dom.element("tbody",null,this.trs)]);
}});
var c='<ul class="#=classNames.cellContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action=merge>Merge</li><li data-action=unmerge>Unmerge</li></ul>';
var p='<ul class="#=classNames.rowHeaderContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action="delete-row">Delete</li><li data-action="hide-row">Hide</li><li data-action="unhide-row">Unhide</li></ul>';
var h='<ul class="#=classNames.colHeaderContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action="delete-column">Delete</li><li data-action="hide-column">Hide</li><li data-action="unhide-column">Unhide</li></ul>';
k.spreadsheet.ContextMenu=k.ui.ContextMenu;
var s=k.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div><div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+c+p+h);
function u(x,w,v){return x>=w&&x<=v;
}var r=k.Class.extend({init:function(x,y){var v=r.classNames;
this.element=x;
this.options=a.extend(true,{},this.options,y);
this._chrome();
this._dialogs=[];
x.append(s({classNames:v}));
this._formulaInput();
this.wrapper=x.find(i+v.view);
this.container=x.find(i+v.fixedContainer)[0];
this.scroller=x.find(i+v.scroller)[0];
this.clipboard=x.find(i+v.clipboard);
this.viewSize=a(this.scroller.firstChild);
this.tree=new k.dom.Tree(this.container);
this.clipboardContents=new k.dom.Tree(this.clipboard[0]);
this.editor=new k.spreadsheet.SheetEditor(this);
this.sheetsbar=new k.spreadsheet.SheetsBar(x.find(i+v.sheetsBar),a.extend(true,this.options.sheetsbar));
var w={target:x,animation:false,showOn:"never"};
this.cellContextMenu=new k.spreadsheet.ContextMenu(x.find(i+v.cellContextMenu),w);
this.colHeaderContextMenu=new k.spreadsheet.ContextMenu(x.find(i+v.colHeaderContextMenu),w);
this.rowHeaderContextMenu=new k.spreadsheet.ContextMenu(x.find(i+v.rowHeaderContextMenu),w);
var z=k.support.scrollbar();
a(this.container).css({width:this.wrapper[0].clientWidth-z,height:this.wrapper[0].clientHeight-z});
},options:{messages:{errors:{shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet."}}},_resize:function(){var x=this.tabstrip?this.tabstrip.element.outerHeight():0;
var v=this.formulaBar?this.formulaBar.element.outerHeight():0;
var w=this.sheetsbar?this.sheetsbar.element.outerHeight():0;
this.wrapper.height(this.element.height()-(x+v+w));
},_chrome:function(){var v=a("<div />").prependTo(this.element);
this.formulaBar=new k.spreadsheet.FormulaBar(v);
if(this.options.toolbar){this._tabstrip();
}},_formulaInput:function(){var v=this.element.find(i+r.classNames.cellEditor);
this.formulaInput=new k.spreadsheet.FormulaInput(v,{autoScale:true});
},_tabstrip:function(){var w=a.extend(true,{home:true,insert:true,data:true},this.options.toolbar);
var x=[];
if(this.tabstrip){this.tabstrip.destroy();
this.element.children(".k-tabstrip").remove();
}for(var v in w){if(w[v]){x.push({id:v,text:v.charAt(0).toUpperCase()+v.substr(1),content:""});
}}this.tabstrip=new k.spreadsheet.TabStrip(a("<div />").prependTo(this.element),{animation:false,dataTextField:"text",dataContentField:"content",dataSource:x,toolbarOptions:w,view:this});
this.tabstrip.select(0);
},_executeCommand:function(v){this._workbook.execute(v);
},workbook:function(v){this._workbook=v;
},sheet:function(v){this._sheet=v;
},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell());
},_rectangle:function(v,w){return v._grid.boundingRectangle(w.toRangeRef());
},isColumnResizer:function(B,w,z){var y=this._rectangle(w,z);
B-=this._sheet._grid._headerWidth;
var v=o/2;
var A=y.right-this.scroller.scrollLeft;
return A-v<=B&&B<=A+v;
},isRowResizer:function(B,x,A){var z=this._rectangle(x,A);
B-=this._sheet._grid._headerHeight;
var w=o/2;
var v=z.bottom-this.scroller.scrollTop;
return v-w<=B&&B<=v+w;
},objectAt:function(E,F){var w=this._sheet._grid;
var z,A;
if(E<0||F<0||E>this.scroller.clientWidth||F>this.scroller.clientHeight){z={type:"outside"};
}else{if(E<w._headerWidth&&F<w._headerHeight){z={type:"topcorner"};
}else{A=this.paneAt(E,F);
var C=A._grid.rows.index(F,this.scroller.scrollTop);
var v=A._grid.columns.index(E,this.scroller.scrollLeft);
var D="cell";
var B=new g(C,v);
if(E<w._headerWidth){B=new g(C,-Infinity);
D=this.isRowResizer(F,A,B)?"rowresizehandle":"rowheader";
}else{if(F<w._headerHeight){B=new g(-Infinity,v);
D=this.isColumnResizer(E,A,B)?"columnresizehandle":"columnheader";
}}z={type:D,ref:B};
}}z.pane=A;
z.x=E;
z.y=F;
return z;
},paneAt:function(w,z){return this.panes.filter(function v(y){var x=y._grid;
return u(z,x.top,x.bottom)&&u(w,x.left,x.right);
})[0];
},containingPane:function(v){return this.panes.filter(function(w){if(w._grid.contains(v)){return true;
}return false;
})[0];
},cellRectangle:function(v){var x=this.containingPane(v)._grid;
var w=this._sheet._grid.rectangle(v);
return w.offset(x.headerWidth-this.scroller.scrollLeft,x.headerHeight-this.scroller.scrollTop);
},refresh:function(x){var y=this._sheet;
if(this.tabstrip){this.tabstrip.refreshTools(y.range(y.activeCell()));
}if(x.sheetSelection){this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet));
this._resize();
}this.viewSize[0].style.height=y._grid.totalHeight()+"px";
this.viewSize[0].style.width=y._grid.totalWidth()+"px";
if(x.layout){var v=y.frozenColumns();
var w=y.frozenRows();
this.panes=[this._pane(w,v)];
if(v>0){this.panes.push(this._pane(w,0,null,v));
}if(w>0){this.panes.push(this._pane(0,v,w,null));
}if(w>0&&v>0){this.panes.push(this._pane(0,0,w,v));
}}if(x.filter){this._destroyFilterMenu();
}if(x.activeCell){this._focus=y.activeCell().toRangeRef();
}},createFilterMenu:function(v){if(this._filterMenuColumn==v){return this._filterMenu;
}var z=this._sheet;
var y=z.filter().ref;
var x=new k.spreadsheet.Range(y,z);
var w=new k.spreadsheet.FilterMenu({column:v,range:x});
this._destroyFilterMenu();
this._filterMenu=w;
return w;
},selectClipBoardContents:function(){this.clipboard.focus();
q(this.clipboard[0]);
},scrollIntoView:function(w){var B=false;
var A=this.containingPane(w)._grid;
var v=A.scrollBoundaries(w);
var x=this.scroller;
var z=A.rows.frozen?0:x.scrollTop;
var y=A.columns.frozen?0:x.scrollLeft;
if(v.top<z){B=true;
x.scrollTop=v.scrollTop;
}if(v.bottom>z){B=true;
x.scrollTop=v.scrollBottom;
}if(v.left<y){B=true;
x.scrollLeft=v.scrollLeft;
}if(v.right>y){B=true;
x.scrollLeft=v.scrollRight;
}return B;
},openDialog:function(w,x){var A=this._sheet;
var z=A.activeCell();
var y=new k.spreadsheet.Range(z,A);
var v=k.spreadsheet.dialogs.create(w,x);
if(v){v.bind("action",this._executeCommand.bind(this));
this._dialogs.push(v);
v.open(y);
return v;
}},showError:function(w){var v=this.options.messages.errors;
this.openDialog("message",{title:"Error",text:v[w.reason]});
},destroy:function(){this._dialogs.forEach(function(v){v.destroy();
});
this.cellContextMenu.destroy();
this.rowHeaderContextMenu.destroy();
this.colHeaderContextMenu.destroy();
if(this.tabstrip){this.tabstrip.destroy();
}this._destroyFilterMenu();
},_destroyFilterMenu:function(){if(this._filterMenu){this._filterMenu.destroy();
this._filterMenu=undefined;
this._filterMenuColumn=undefined;
}},render:function(){var B=this._sheet;
var v=B.focus();
if(v&&this.scrollIntoView(v)){return;
}var w=B._grid;
var A=this.scroller.scrollTop;
var z=this.scroller.scrollLeft;
if(A<0){A=0;
}if(z<0){z=0;
}var y=this.panes.map(function(D){return D.render(z,A);
},this);
var x=[];
x=Array.prototype.concat.apply(x,y);
var C=k.dom.element("div",{style:{width:w._headerWidth+"px",height:w._headerHeight+"px"},className:r.classNames.topCorner});
x.push(C);
if(B.resizeHandlePosition()&&B.resizeHintPosition()){x.push(this.renderResizeHint());
}this.tree.render(x);
if(this.editor.isActive()){if(!this.editor.canInsertRef(false)){this.editor.position(this.activeCellRectangle());
}}else{if(!B.selectionInProgress()&&!B.resizingInProgress()&&!B._edit()){this.renderClipboardContents();
}}},renderResizeHint:function(){var y=this._sheet;
var x=y.resizeHandlePosition();
var w=x.col!==-Infinity;
var z;
if(w){z={height:this.scroller.clientHeight+"px",width:o+"px",left:y.resizeHintPosition().x+"px"};
}else{z={height:o+"px",width:this.scroller.clientWidth+"px",top:y.resizeHintPosition().y+"px"};
}var v=m.classNames;
return k.dom.element("div",{className:v.resizeHint+(!w?" "+v.resizeHintVertical:""),style:z},[k.dom.element("div",{className:v.resizeHintHandle}),k.dom.element("div",{className:v.resizeHintMarker})]);
},renderClipboardContents:function(){var A=this._sheet;
var v=A._grid;
var y=A.select();
if(!this._workbook.clipboard().canCopy()){this.clipboardContents.render([]);
return;
}y=A.trim(y);
var B=new j();
var z=v.rangeDimensions(y);
z.rows.forEach(function(C){B.addRow(C);
});
z.columns.forEach(function(C){B.addColumn(C);
});
var w={};
var x={};
A.forEachMergedCell(y,function(C){var D=C.topLeft;
v.forEach(C,function(E){if(D.eq(E)){w[E.print()]=C;
}else{x[E.print()]=true;
}});
});
A.forEach(y,function(G,D,C){var E=new g(G,D).print();
if(!x[E]){var H=b(B,G-y.topLeft.row,C);
var F=w[E];
if(F){H.attr.colspan=F.width();
H.attr.rowspan=F.height();
}}});
this.clipboardContents.render([B.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]);
this.selectClipBoardContents();
},_pane:function(y,v,z,w){var x=new m(this._sheet,this._sheet._grid.pane({row:y,column:v,rowCount:z,columnCount:w}));
x.refresh(this.scroller.clientWidth,this.scroller.clientHeight);
return x;
}});
function l(x,y,z,B,A,v){var w=[y];
if(B){w.push(x.top);
}if(A){w.push(x.right);
}if(v){w.push(x.bottom);
}if(z){w.push(x.left);
}return w.join(" ");
}var n={rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]};
var m=k.Class.extend({init:function(w,v){this._sheet=w;
this._grid=v;
},refresh:function(w,v){this._grid.refresh(w,v);
},isVisible:function(w,x,v){return this._grid.view(w,x).ref.intersects(v);
},render:function(B,C){var w=m.classNames;
var D=this._sheet;
var y=this._grid;
var E=y.view(B,C);
this._currentView=E;
this._selectedHeaders=D.selectedHeaders();
var v=[];
v.push(this.renderData());
v.push(this.renderMergedCells());
v.push(this.renderSelection());
v.push(this.renderEditorSelection());
v.push(this.renderFilterHeaders());
if(y.hasRowHeader){var A=new j();
A.addColumn(y.headerWidth);
E.rows.values.forEach(function(F){A.addRow(F);
});
D.forEach(E.ref.leftColumn(),function(F){var G=F+1;
A.addCell(F-E.ref.topLeft.row,G,{},this.headerClassName(F,"row"));
}.bind(this));
v.push(A.toDomTree(0,E.rowOffset,w.rowHeader));
}if(y.hasColumnHeader){var x=new j();
E.columns.values.forEach(function(F){x.addColumn(F);
});
x.addRow(y.headerHeight);
D.forEach(E.ref.topRow(),function(G,F){var H=k.spreadsheet.Ref.display(null,Infinity,F);
x.addCell(0,H,{},this.headerClassName(F,"col"));
}.bind(this));
v.push(x.toDomTree(E.columnOffset,0,w.columnHeader));
}if(D.resizeHandlePosition()&&(y.hasColumnHeader||y.hasRowHeader)){var z=D._grid.normalize(D.resizeHandlePosition());
if(E.ref.intersects(z)){if(!D.resizeHintPosition()){v.push(this.renderResizeHandler());
}}}return k.dom.element("div",{style:y.style,className:l(w,w.pane,y.hasRowHeader,y.hasColumnHeader)},v);
},headerClassName:function(x,A){var z=this._selectedHeaders;
var y;
var v;
if(A==="row"){y=z.rows[x];
v=z.allRows;
}else{y=z.cols[x];
v=z.allCols;
}var w=y||(z.all?"full":(v?"partial":"none"));
if(w){w="k-selection-"+w;
}return w;
},renderData:function(){var v=new j();
var w=this._currentView;
w.rows.values.forEach(function(x){v.addRow(x);
});
w.columns.values.forEach(function(x){v.addColumn(x);
});
this._sheet.forEach(w.ref,function(z,y,x){b(v,z-w.ref.topLeft.row,x);
});
return v.toDomTree(w.columnOffset,w.rowOffset,m.classNames.data);
},renderMergedCells:function(){var v=m.classNames;
var w=[];
var x=this._sheet;
x.forEachMergedCell(function(y){this._addTable(w,y,v.mergedCell);
}.bind(this));
return k.dom.element("div",{className:v.mergedCellsWrapper},w);
},renderResizeHandler:function(){var x=this._sheet;
var w=x.resizeHandlePosition();
var v=this._rectangle(w);
var y;
if(w.col!==-Infinity){y={height:this._grid.headerHeight+"px",width:o+"px",left:v.right-o/2+"px"};
}else{y={height:o+"px",width:this._grid.headerWidth+"px",top:v.bottom-o/2+"px"};
}return k.dom.element("div",{className:m.classNames.resizeHandle,style:y});
},renderFilterHeaders:function(){var A=this._sheet;
var x=[];
var v=r.classNames;
var z=0;
function y(B){return k.dom.element("span",{className:v.icon+" "+B});
}function w(D,F,E){var C=16;
var G={left:F.left+F.width-C-3+"px",top:F.top+(F.height-C)/2+"px"};
var B=k.dom.element("span",{className:D.filterButton,style:G,"data-column":E},[y(D.iconFilterDefault)]);
return B;
}A.forEachFilterHeader(this._currentView.ref,function(D){var C=this._rectangle(D);
var B=w(v,C,z);
z++;
x.push(B);
}.bind(this));
return k.dom.element("div",{className:v.filterHeadersWrapper},x);
},renderEditorSelection:function(){var v=m.classNames;
var x=this._sheet;
var w=[];
x._formulaSelections.forEach(function(y){var z=y.ref;
if(z===k.spreadsheet.NULLREF){return;
}this._addDiv(w,z,v.selectionHighlight+" "+y.seriesCls);
}.bind(this));
return k.dom.element("div",{className:v.selectionWrapper},w);
},_active:function(){return this._sheet._formulaSelections.filter(function(v){return v.active;
})[0];
},renderSelection:function(){var x=m.classNames;
var y=[];
var z="";
var A=this._sheet;
var C=this._currentView;
var v=A.activeCell().toRangeRef();
var w=l(x,x.activeCell,!v.move(0,-1).intersects(C.ref),!v.move(-1,0).intersects(C.ref),!v.move(0,1).intersects(C.ref),!v.move(1,0).intersects(C.ref));
if(A._edit()){var B=this._active();
if(B&&B.type=="ref"){z=" "+B.seriesCls;
w+=z;
}}if(A.select().eq(v)){w+=" "+x.single;
}A.select().forEach(function(D){if(D===k.spreadsheet.NULLREF){return;
}this._addDiv(y,D,x.selection+z);
}.bind(this));
this._addTable(y,v,w);
return k.dom.element("div",{className:x.selectionWrapper},y);
},_addDiv:function(w,y,v){var z=this._currentView;
if(z.ref.intersects(y)){var x=this._rectangle(y).resize(1,1).toDiv(v);
w.push(x);
}},_addTable:function(w,x,v){var y=this._sheet;
var z=this._currentView;
if(z.ref.intersects(x)){y.forEach(x.collapse(),function(D,B,A){var C=this._rectangle(x);
var E=new j();
E.addColumn(C.width);
E.addRow(C.height);
b(E,0,A);
w.push(E.toDomTree(C.left,C.top,v));
}.bind(this));
}},_rectangle:function(v){return this._grid.boundingRectangle(v.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop);
}});
k.spreadsheet.View=r;
k.spreadsheet.Pane=m;
k.spreadsheet.addCell=b;
a.extend(true,r,{classNames:t});
a.extend(true,m,{classNames:n});
})(window.kendo);
})();
(function(){(function(c){var a=c.spreadsheet.CellRef;
var e=c.spreadsheet.RangeRef;
var g=c.spreadsheet.UnionRef;
var f=c.Class.extend({init:function(i,j,k,h){this.left=i;
this.width=k;
this.right=i+k;
this.top=j;
this.height=h;
this.bottom=j+h;
},offset:function(h,i){return new f(this.left+h,this.top+i,this.width,this.height);
},resize:function(i,h){return new f(this.left,this.top,this.width+i,this.height+h);
},toDiv:function(h){return c.dom.element("div",{className:h,style:{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}});
}});
var b=c.Class.extend({init:function(m,i,l,h,j,k){this.rowCount=l;
this.columnCount=h;
this._columns=i;
this._rows=m;
this._headerHeight=j;
this._headerWidth=k;
},isAxis:function(i){i=i.toRangeRef();
var j=i.topLeft;
var h=i.bottomRight;
return(j.row===0&&h.row===this.rowCount-1)||(j.col===0&&h.col===this.columnCount-1);
},width:function(i,h){return this._columns.sum(i,h);
},height:function(i,h){return this._rows.sum(i,h);
},totalHeight:function(){return this._rows.total+this._headerHeight;
},totalWidth:function(){return this._columns.total+this._headerWidth;
},index:function(i,h){return h*this.rowCount+i;
},cellRef:function(h){return new a(h%this.rowCount,(h/this.rowCount)>>0);
},rowRef:function(h){return new e(new a(h,0),new a(h,this.columnCount-1));
},colRef:function(h){return new e(new a(0,h),new a(this.rowCount-1,h));
},cellRefIndex:function(h){return this.index(h.row,h.col);
},normalize:function(i){if(i instanceof e){return new e(this.normalize(i.topLeft),this.normalize(i.bottomRight)).setSheet(i.sheet,i.hasSheet());
}if(i instanceof g){return i.map(function(j){return this.normalize(j);
},this);
}var h=i.clone();
h.col=Math.max(0,Math.min(this.columnCount-1,i.col));
h.row=Math.max(0,Math.min(this.rowCount-1,i.row));
return h;
},rectangle:function(i){var j=this.normalize(i.topLeft);
var h=this.normalize(i.bottomRight);
return new f(this.width(0,j.col-1),this.height(0,j.row-1),this.width(j.col,h.col),this.height(j.row,h.row));
},pane:function(h){return new d(new c.spreadsheet.PaneAxis(this._rows,h.row,h.rowCount,this._headerHeight),new c.spreadsheet.PaneAxis(this._columns,h.column,h.columnCount,this._headerWidth),this);
},rangeDimensions:function(h){return{rows:this._rows.values.iterator(h.topLeft.row,h.bottomRight.row),columns:this._columns.values.iterator(h.topLeft.col,h.bottomRight.col)};
},forEach:function(k,i){var m=this.normalize(k.topLeft);
var h=this.normalize(k.bottomRight);
for(var j=m.col;
j<=h.col;
j++){for(var l=m.row;
l<=h.row;
l++){i(new a(l,j));
}}},trim:function(o,n){var q=o.topLeft;
var h=o.bottomRight;
var j=q.row;
var i=q.col;
for(var l=q.col;
l<=h.col;
l++){var p=this.index(q.row,l);
var m=this.index(h.row,l);
var r=n.tree.intersecting(p,m);
if(r.length){var k=this.cellRef(r[r.length-1].end);
j=Math.max(j,k.row);
i=l;
}}return new e(o.topLeft,new a(Math.min(j,o.bottomRight.row),i));
}});
var d=c.Class.extend({init:function(j,h,i){this.rows=j;
this.columns=h;
this._grid=i;
this.headerHeight=j.headerSize;
this.headerWidth=h.headerSize;
this.hasRowHeader=h.hasHeader;
this.hasColumnHeader=j.hasHeader;
},refresh:function(i,h){this.columns.viewSize(i);
this.rows.viewSize(h);
var j=this.columns.paneSegment();
var k=this.rows.paneSegment();
this.left=j.offset;
this.top=k.offset;
this.right=j.offset+j.length;
this.bottom=k.offset+k.length;
this.style={top:k.offset+"px",left:j.offset+"px",height:k.length+"px",width:j.length+"px"};
},view:function(i,k){var j=this.rows.visible(k);
var h=this.columns.visible(i);
return{rows:j,columns:h,rowOffset:j.offset,columnOffset:h.offset,mergedCellLeft:h.start,mergedCellTop:j.start,ref:new e(new a(j.values.start,h.values.start),new a(j.values.end,h.values.end))};
},contains:function(h){return this.rows.contains(h.topLeft.row,h.bottomRight.row)&&this.columns.contains(h.topLeft.col,h.bottomRight.col);
},index:function(i,h){return this._grid.index(i,h);
},boundingRectangle:function(h){return this._grid.rectangle(h);
},cellRefIndex:function(h){return this._grid.cellRefIndex(h);
},scrollBoundaries:function(i){var k=this.boundingRectangle(i);
var h={top:Math.max(0,k.top-this.top+(this.hasColumnHeader?0:this.headerHeight)),left:Math.max(0,k.left-this.left+(this.hasRowHeader?0:this.headerWidth)),right:k.right-this.columns._viewSize+this.headerWidth,bottom:k.bottom-this.rows._viewSize+this.headerHeight};
var l=this.columns.defaultValue/2;
var j=this.rows.defaultValue/2;
h.scrollTop=h.top-j;
h.scrollBottom=h.bottom+j;
h.scrollLeft=h.left-l;
h.scrollRight=h.right+l;
return h;
}});
c.spreadsheet.Grid=b;
c.spreadsheet.PaneGrid=d;
c.spreadsheet.Rectangle=f;
})(kendo);
})();
(function(){(function(b){var a=b.Class.extend({init:function(d,e){this._value=e;
this._count=d;
this.values=new b.spreadsheet.RangeList(0,d-1,e);
this._hidden=new b.spreadsheet.RangeList(0,d-1,0);
this.scrollBarSize=b.support.scrollbar();
this._refresh();
},toJSON:function(d,i){var k=[];
var g=this.values.iterator(0,this._count-1);
for(var e=0;
e<this._count;
e++){var j=g.at(e);
if(j===this._value){continue;
}var h=i[e];
if(h===undefined){h=k.length;
var f={index:e};
f[d]=j;
k.push(f);
i[e]=h;
}}return k;
},fromJSON:function(d,h){for(var e=0;
e<h.length;
e++){var g=h[e][d];
var f=h[e].index;
if(f===undefined){f=e;
}this.value(f,f,g);
}},hide:function(d){var e=this.value(d,d);
this._hidden.value(d,d,e);
this.value(d,d,0);
},hidden:function(d){return this._hidden.value(d,d)!==0;
},includesHidden:function(e,d){return this._hidden.intersecting(e,d).length>1;
},nextVisible:function(e,f){var d=this._count-1;
if(e===d){return f?e+1:e;
}e+=1;
var g=this._hidden.intersecting(e,e)[0];
if(g.value!==0){if(g.end===d){return e-1;
}else{return g.end+1;
}}else{return e;
}},nextPage:function(d,e){return this.index(this.sum(0,d-1)+e);
},prevPage:function(d,e){return this.index(this.sum(0,d)-e);
},firstVisible:function(){var d=this._hidden.first();
if(d.value===0){return 0;
}else{return d.end+1;
}},lastVisible:function(){var d=this._hidden.last();
if(d.value===0){return this._count-1;
}else{return d.start-1;
}},prevVisible:function(d,e){if(d===0){return e?-1:0;
}d-=1;
var f=this._hidden.intersecting(d,d)[0];
if(f.value!==0){if(f.start===0){return d+1;
}else{return f.start-1;
}}else{return d;
}},unhide:function(d){if(this.hidden(d)){var e=this._hidden.value(d,d);
this._hidden.value(d,d,0);
this.value(d,d,e);
}},value:function(e,d,f){if(f!==undefined){this.values.value(e,d,f);
this._refresh();
}else{return this.values.iterator(e,d).at(0);
}},sum:function(f,d){var h=this.values.iterator(f,d);
var g=0;
for(var e=f;
e<=d;
e++){g+=h.at(e);
}return g;
},visible:function(k,d){var n=null;
var g=null;
var h=false;
if(d>=this.total+this.scrollBarSize){h=true;
}var j=this._pixelValues.intersecting(k,d);
n=j[0];
g=j[j.length-1];
var m=k-n.start;
var l=((m/n.value.value)>>0)+n.value.start;
var i=m-(l-n.value.start)*n.value.value;
var f=d-g.start;
var e=((f/g.value.value)>>0)+g.value.start;
if(e>g.value.end){e=g.value.end;
}if(h){i+=g.value.value-(f-(e-g.value.start)*g.value.value);
}i=-i;
return{values:this.values.iterator(l,e),offset:i};
},index:function(g){var e=0;
var f=this.values.iterator(0,this._count-1);
var d=f.at(0);
while(d<g&&e<this._count-1){d+=f.at(++e);
}return e;
},_refresh:function(){var d=0;
this._pixelValues=this.values.map(function(f){var g=d;
d+=(f.end-f.start+1)*f.value;
var e=d-1;
return new b.spreadsheet.ValueRange(g,e,f);
});
this.total=d;
},getState:function(){return{values:this.values.getState(),hidden:this._hidden.getState()};
},setState:function(d){this.values.setState(d.values);
this._hidden.setState(d.hidden);
this._refresh();
}});
var c=b.Class.extend({init:function(d,g,e,f){this._axis=d;
this._start=g;
this._count=e;
this.hasHeader=g===0;
this.headerSize=f;
this.defaultValue=d._value;
this.frozen=e>0;
},viewSize:function(d){this._viewSize=d;
},sum:function(e,d){return this._axis.sum(e,d-1);
},start:function(){return this.sum(0,this._start);
},size:function(){return this.sum(this._start,this._start+this._count);
},index:function(e,d){return this._axis.index(e+(this.frozen?0:d)-this.headerSize);
},paneSegment:function(){var e=this.start();
var d;
if(!this.hasHeader){e+=this.headerSize;
}if(this.frozen){d=this.size();
if(this.hasHeader){d+=this.headerSize;
}else{d-=this.headerSize;
}}else{d=this._viewSize-e;
}return{offset:e,length:d};
},visible:function(d){var g=this.start();
var f;
if(this.frozen){f=this.size();
if(!this.hasHeader){f-=this.headerSize;
}}else{f=this._viewSize-g-this.headerSize;
g+=d;
}var e=this._axis.visible(g,g+f-1);
if(this.frozen){e.offset=0;
}e.start=g;
if(this.hasHeader){e.offset+=this.headerSize;
e.start-=this.headerSize;
}return e;
},contains:function(e,d){if(this.frozen){if(e>this._start+this._count){return false;
}if(d<this._start){return false;
}return true;
}else{return d>=this._start;
}}});
b.spreadsheet.Axis=a;
b.spreadsheet.PaneAxis=c;
})(kendo);
})();
(function(){(function(b){var a=b.spreadsheet.Filter=b.Class.extend({prepare:function(){},value:function(g){return g.value;
},matches:function(){throw new Error("The 'matches' method is not implemented.");
},toJSON:function(){throw new Error("The 'toJSON' method is not implemented.");
}});
a.create=function(i){var h=i.filter;
if(!h){throw new Error("Filter type not specified.");
}var g=b.spreadsheet[h.charAt(0).toUpperCase()+h.substring(1)+"Filter"];
if(!g){throw new Error("Filter type not recognized.");
}return new g(i);
};
b.spreadsheet.ValueFilter=a.extend({_values:[],_dates:[],_blanks:false,init:function(g){if(g.values!==undefined){this._values=g.values;
}if(g.blanks!==undefined){this._blanks=g.blanks;
}if(g.dates!==undefined){this._dates=g.dates;
}},value:function(g){var i=g.value;
if(this._dates.length>0&&g.format&&typeof i==="number"){var h=b.spreadsheet.formatting.type(i,g.format);
if(h==="date"){i=b.spreadsheet.numberToDate(i);
}}return i;
},matches:function(g){if(g===null||g===undefined){return this._blanks;
}if(g instanceof Date){return this._dates.some(function(h){return h.year===g.getFullYear()&&(h.month===undefined||h.month===g.getMonth())&&(h.day===undefined||h.day===g.getDate())&&(h.hours===undefined||h.hours===g.getHours())&&(h.minutes===undefined||h.minutes===g.getMinutes())&&(h.seconds===undefined||h.seconds===g.getSeconds());
});
}return this._values.indexOf(g)>=0;
},toJSON:function(){return{filter:"value",values:this._values.slice(0)};
}});
b.spreadsheet.CustomFilter=a.extend({_logic:"and",init:function(h){if(h.logic!==undefined){this._logic=h.logic;
}if(h.criteria===undefined){throw new Error("Must specify criteria.");
}this._criteria=h.criteria;
var g=b.data.Query.filterExpr({logic:this._logic,filters:this._criteria}).expression;
this._matches=new Function("d","return "+g);
},matches:function(g){if(g===null){return false;
}return this._matches(g);
},toJSON:function(){return{filter:"custom",logic:this._logic,criteria:this._criteria};
}});
b.spreadsheet.TopFilter=a.extend({init:function(g){this._type=g.type;
this._value=g.value;
this._values=[];
},prepare:function(g){var i=g.map(this.value).sort().filter(function(l,k,j){return k===0||l!==j[k-1];
});
if(this._type==="topNumber"||this._type=="topPercent"){i.sort(function(j,k){return k-j;
});
}else{i.sort(function(j,k){return j-k;
});
}var h=this._value;
if(this._type==="topPercent"||this._type==="bottomPercent"){h=(i.length*h/100)>>0;
}this._values=i.slice(0,h);
},matches:function(g){return this._values.indexOf(g)>=0;
},toJSON:function(){return{filter:"top",type:this._type,value:this._value};
}});
b.spreadsheet.DynamicFilter=a.extend({init:function(g){this._type=g.type;
this._predicate=this[g.type];
if(typeof this._predicate!=="function"){throw new Error("DynamicFilter type '"+g.type+"' not recognized.");
}},value:function(g){var i=g.value;
if(g.format){var h=b.spreadsheet.formatting.type(i,g.format);
if(h==="date"){i=b.spreadsheet.numberToDate(i);
}}return i;
},prepare:function(g){var j=0;
var i=0;
for(var h=0;
h<g.length;
h++){var k=this.value(g[h]);
if(typeof k==="number"){j+=k;
i++;
}}if(i>0){this._average=j/i;
}else{this._average=0;
}},matches:function(g){return this._predicate(g);
},aboveAverage:function(g){if(g instanceof Date){g=b.spreadsheet.dateToNumber(g);
}if(typeof g!=="number"){return false;
}return g>this._average;
},belowAverage:function(g){if(g instanceof Date){g=b.spreadsheet.dateToNumber(g);
}if(typeof g!=="number"){return false;
}return g<this._average;
},tomorrow:function(h){if(h instanceof Date){var g=b.date.addDays(b.date.today(),1);
return b.date.getDate(h).getTime()===g.getTime();
}return false;
},today:function(g){if(g instanceof Date){return b.date.isToday(g);
}return false;
},yesterday:function(g){if(g instanceof Date){var h=b.date.addDays(b.date.today(),-1);
return b.date.getDate(g).getTime()===h.getTime();
}return false;
},nextWeek:function(g){return e(b.date.addDays(b.date.today(),7),g);
},thisWeek:function(g){return e(b.date.today(),g);
},lastWeek:function(g){return e(b.date.addDays(b.date.today(),-7),g);
},nextMonth:function(g){return d(g,1);
},thisMonth:function(g){return d(g,0);
},lastMonth:function(g){return d(g,-1);
},nextQuarter:function(i){if(i instanceof Date){var h=b.date.today();
var g=c(i)-c(h);
return(g===1&&h.getFullYear()===i.getFullYear())||(g==-3&&h.getFullYear()+1===i.getFullYear());
}return false;
},thisQuarter:function(i){if(i instanceof Date){var h=b.date.today();
var g=c(i)-c(h);
return g===0&&h.getFullYear()===i.getFullYear();
}return false;
},lastQuarter:function(i){if(i instanceof Date){var h=b.date.today();
var g=c(h)-c(i);
return(g===1&&h.getFullYear()===i.getFullYear())||(g==-3&&h.getFullYear()-1===i.getFullYear());
}return false;
},nextYear:function(g){return f(g,1);
},thisYear:function(g){return f(g,0);
},lastYear:function(g){return f(g,-1);
},yearToDate:function(h){if(h instanceof Date){var g=b.date.today();
return h.getFullYear()===g.getFullYear()&&h<=g;
}return false;
},toJSON:function(){return{filter:"dynamic",type:this._type};
}});
[1,2,3,4].forEach(function(g){b.spreadsheet.DynamicFilter.prototype["quarter"+g]=function(h){if(h instanceof Date){return c(h)===g;
}return false;
};
});
b.cultures["en-US"].calendar.months.names.forEach(function(h,g){b.spreadsheet.DynamicFilter.prototype[h.toLowerCase()]=function(i){if(i instanceof Date){return i.getMonth()===g;
}return false;
};
});
function c(h){var g=h.getMonth()+1;
if(g>=1&&g<=3){return 1;
}else{if(g>=4&&g<=6){return 2;
}else{if(g>=7&&g<=9){return 3;
}else{return 4;
}}}}function f(i,g){if(i instanceof Date){var h=b.date.today();
h.setFullYear(h.getFullYear()+g);
return h.getFullYear()===i.getFullYear();
}return false;
}function d(i,g){if(i instanceof Date){var h=b.date.firstDayOfMonth(b.date.today());
h.setMonth(h.getMonth()+g,1);
return h.getTime()===b.date.firstDayOfMonth(i).getTime();
}return false;
}function e(g,h){if(h instanceof Date){var i=b.date.dayOfWeek(b.date.getDate(g),1);
var j=b.date.dayOfWeek(b.date.getDate(h),1);
return i.getTime()===j.getTime();
}return false;
}})(kendo);
})();
(function(){(function(a){var b=a.Class.extend({init:function(c,d){this._grid=c;
this._lists=d;
},indices:function(g,f,c,e){var d=b.ascendingComparer;
if(c===false){d=b.descendingComparer;
}return f.sortedIndices(this._grid.cellRefIndex(g.topLeft),this._grid.cellRefIndex(g.bottomRight),d,e);
},sortBy:function(j,e,i,c,g){var k=this.indices(j.toColumn(e),i,c,g);
for(var d=j.topLeft.col;
d<=j.bottomRight.col;
d++){var l=this._grid.index(j.topLeft.row,d);
var f=this._grid.index(j.bottomRight.row,d);
for(var h=0;
h<this._lists.length;
h++){if(l<this._lists[h].lastRangeStart()){this._lists[h].sort(l,f,k);
}}}return k;
}});
b.ascendingComparer=function(c,d){if(c===null&&d===null){return 0;
}if(c===null){return 1;
}if(d===null){return -1;
}var e=typeof c;
var f=typeof d;
if(e==="number"){if(f==="number"){return c-d;
}else{return -1;
}}if(e==="string"){switch(f){case"number":return 1;
case"string":return c.localeCompare(d);
default:return -1;
}}if(e==="boolean"){switch(f){case"number":return 1;
case"string":return 1;
case"boolean":return c-d;
default:return -1;
}}if(c instanceof a.spreadsheet.calc.runtime.CalcError){if(d instanceof a.spreadsheet.calc.runtime.CalcError){return 0;
}else{return 1;
}}throw new Error("Cannot compare "+c+" and "+d);
};
b.descendingComparer=function(c,d){if(c===null&&d===null){return 0;
}if(c===null){return 1;
}if(d===null){return -1;
}return b.ascendingComparer(d,c);
};
a.spreadsheet.Sorter=b;
})(kendo);
})();
(function(){var p=kendo.spreadsheet;
var a=p.calc;
var o=a.runtime;
var k={};
var l=kendo.Class.extend({init:function l(u,v){this.message=u;
this.pos=v;
},toString:function(){return this.message;
}});
(function(u){u.forEach(function(v,w){v.forEach(function(x){k[x]=u.length-w;
});
});
})([[":"],[" "],[","],["%"],["^"],["*","/"],["+","-"],["&"],["=","<",">","<=",">=","<>"]]);
var t={type:"bool",value:true};
var b={type:"bool",value:false};
function d(w){w=w.toUpperCase();
for(var u=0,v=0;
v<w.length;
++v){u=u*26+w.charCodeAt(v)-64;
}return u-1;
}function e(u){return parseFloat(u)-1;
}function n(v,w){if(v.toLowerCase()=="#sheet"){return p.SHEETREF;
}if(v.indexOf(",")>=0){return new p.UnionRef(v.split(/\s*,\s*/g).map(n));
}var u;
if((u=/^(([A-Z0-9]+)!)?\$?([A-Z]+)\$?([0-9]+)$/i.exec(v))){return new p.CellRef(e(u[4]),d(u[3]),0).setSheet(u[2],!!u[2]);
}if((u=/^(([A-Z0-9]+)!)?\$?([A-Z]+)\$?([0-9]+):(([A-Z0-9]+)!)?\$?([A-Z]+)\$?([0-9]+)$/i.exec(v))){return new p.RangeRef(new p.CellRef(e(u[4]),d(u[3]),0).setSheet(u[2],!!u[2]),new p.CellRef(e(u[8]),d(u[7]),0).setSheet(u[6],!!u[6])).setSheet(u[2],!!u[2]);
}if((u=/^(([A-Z0-9]+)!)?\$?([A-Z]+):(([A-Z0-9]+)!)?\$?([A-Z]+)$/i.exec(v))){return new p.RangeRef(new p.CellRef(-Infinity,d(u[3]),0).setSheet(u[2],!!u[2]),new p.CellRef(+Infinity,d(u[6]),0).setSheet(u[5],!!u[5])).setSheet(u[2],!!u[2]);
}if((u=/^(([A-Z0-9]+)!)?\$?([0-9]+):(([A-Z0-9]+)!)?\$?([0-9]+)$/i.exec(v))){return new p.RangeRef(new p.CellRef(e(u[3]),-Infinity,0).setSheet(u[2],!!u[2]),new p.CellRef(e(u[6]),+Infinity,0).setSheet(u[5],!!u[5])).setSheet(u[2],!!u[2]);
}if(!w){throw new Error("Cannot parse reference: "+v);
}}function m(L,K,v,x){var J=[];
if(typeof x=="string"){x=s(f(x));
}return{type:"exp",ast:H(true),refs:J,sheet:L,row:K,col:v};
function u(N){N.index=J.length;
J.push(N);
return N;
}function M(O,P){if(y(O,P)){return x.next();
}else{var N=x.peek();
if(N){x.croak("Expected "+O+" «"+P+"» but found "+N.type+" «"+N.value+"»");
}else{x.croak("Expected "+O+" «"+P+"»");
}}}function y(O,P){var N=x.peek();
return N!=null&&(O==null||N.type===O)&&(P==null||N.value===P)?N:null;
}function H(N){return z(B(G(N)),0,N);
}function E(O){var N;
if((N=/^((.+)!)?(\$)?([A-Z]+)(\$)?([0-9]+)$/i.exec(O))){var T=N[1]&&N[2];
var P=N[3]?0:1,R=d(N[4]);
var Q=N[5]?0:2,S=e(N[6]);
if(P){R-=v;
}if(Q){S-=K;
}return new p.CellRef(S,R,P|Q).setSheet(T||L,!!T);
}if((N=/^((.*)!)?(.+)$/i.exec(O))){var T=N[1]&&N[2];
var O=N[3];
return new p.NameRef(O).setSheet(T||L,!!T);
}}function I(P,N){if(P.upper=="TRUE"||P.upper=="FALSE"){return P.upper=="TRUE"?t:b;
}var O=E(P.value);
if(O){if(N){u(O);
}return O;
}return P;
}function G(N){var O=D()||A();
if(!O){if(y("punc","(")){x.next();
O=H(true);
M("punc",")");
}else{if(y("num")||y("str")){O=x.next();
}else{if(y("sym")){O=I(x.next(),true);
}else{if(y("op","+")||y("op","-")){O={type:"prefix",op:x.next().value,exp:H(N)};
}else{if(y("punc","{")){x.next();
O=F();
}else{if(!x.peek()){x.croak("Incomplete expression");
}else{x.croak("Parse error");
}}}}}}}return C(O);
}function F(){var O=[],P=[O],N=true;
while(!x.eof()&&!y("punc","}")){if(N){N=false;
}else{if(y("punc",";")){P.push(O=[]);
x.next();
}else{M("op",",");
}}O.push(H(false));
}M("punc","}");
return{type:"matrix",value:P};
}function B(N){if(y("punc","(")||y("sym")||y("num")){return{type:"binary",op:" ",left:N,right:H(false)};
}else{return N;
}}function A(){return x.ahead(2,function(P,O){if(P.type=="sym"&&O.type=="punc"&&O.value=="("){P=P.value;
x.skip(2);
var N=[];
if(!y("punc",")")){while(1){if(y("op",",")){N.push({type:"null"});
x.next();
continue;
}N.push(H(false));
if(x.eof()||y("punc",")")){break;
}M("op",",");
}}M("punc",")");
return{type:"func",func:P,args:N};
}});
}function C(N){if(y("op","%")){x.next();
return C({type:"postfix",op:"%",exp:N});
}else{return N;
}}function z(P,Q,N){var S=y("op");
if(S&&(N||S.value!=",")){var O=k[S.value];
if(O>Q){x.next();
var R=z(G(N),O,N);
return z({type:"binary",op:S.value,left:P,right:R},Q,N);
}}return P;
}function D(){return x.ahead(4,function(N,O,Q,R){if(g(N,O,Q,R)){var S=w(N,true);
var P=w(Q,false);
if(S!=null&&P!=null){if(P.hasSheet()&&S.sheet.toLowerCase()!=P.sheet.toLowerCase()){x.croak("Invalid range");
}else{x.skip(3);
return u(new p.RangeRef(S,P).setSheet(S.sheet,S.hasSheet()));
}}}});
}function w(R,O){if(R.type=="num"&&R.value==R.value|0){return new p.CellRef(e(R.value)-K,O?-Infinity:+Infinity,2).setSheet(L,false);
}var Q=I(R);
if(Q.type=="ref"){if(Q.ref=="name"){var P=Q.name;
var N=P.charAt(0)=="$";
if(N){P=P.substr(1);
}if(/^[0-9]+$/.test(P)){return new p.CellRef(e(P)-(N?0:K),O?-Infinity:+Infinity,(N?0:2)).setSheet(Q.sheet||L,Q.hasSheet());
}else{return new p.CellRef(O?-Infinity:+Infinity,d(P)-(N?0:v),(N?0:1)).setSheet(Q.sheet||L,Q.hasSheet());
}}return Q;
}}}function j(u){return h("function(row, col){return("+w(u.ast,0)+")}");
function w(y,z){switch(y.type){case"num":case"bool":return JSON.stringify(y.value);
case"str":return JSON.stringify(JSON.stringify(y.value));
case"ref":return"this.refs["+y.index+"].print(row, col)";
case"prefix":return x(y.op,z,function(){return JSON.stringify(y.op)+" + "+w(y.exp,k[y.op]);
});
case"postfix":return x(y.op,z,function(){return w(y.exp,k[y.op])+" + "+JSON.stringify(y.op);
});
case"binary":return x(y.op,z,function(){var A=v(w(y.left,k[y.op]),y.left instanceof p.NameRef&&y.op==":");
var B=v(w(y.right,k[y.op]),y.right instanceof p.NameRef&&y.op==":");
return A+" + "+JSON.stringify(y.op)+" + "+B;
});
case"func":return JSON.stringify(y.func+"(")+" + "+(y.args.length>0?y.args.map(function(A){return w(A,0);
}).join(" + ', ' + "):"''")+" + ')'";
case"matrix":return"'{ ' + "+y.value.map(function(A){return A.map(function(B){return w(B,0);
}).join(" + ', ' + ");
}).join(" + '; ' + ")+"+ ' }'";
case"null":return"''";
}throw new Error("Cannot make printer for node "+y.type);
}function v(y,z){return z?"'(' + "+y+" + ')'":y;
}function x(A,B,y){var z=(k[A]<B||(!B&&A==","));
return v(y(),z);
}}function q(u,H){var G=0;
return v(u,H);
function v(K,J){switch(K.type){case"ref":case"num":case"str":case"null":case"bool":return x(K,J);
case"prefix":case"postfix":return E(K,J);
case"binary":return y(K,J);
case"func":return z(K,J);
case"lambda":return B(K,J);
case"matrix":return C(K.value,J,true);
}throw new Error("Cannot CPS "+K.type);
}function x(K,J){return J(K);
}function E(K,J){return v({type:"func",func:"unary"+K.op,args:[K.exp]},J);
}function y(K,J){return v({type:"func",func:"binary"+K.op,args:[K.left,K.right]},J);
}function A(J,M,K,L){return v(J,function(N){var P=I(L);
var Q=F("T");
var O=F("E");
return{type:"func",func:"if",args:[P,N,{type:"lambda",vars:[Q],body:v(M||t,function(R){return{type:"call",func:{type:"var",name:Q},args:[R]};
})},{type:"lambda",vars:[O],body:v(K||b,function(R){return{type:"call",func:{type:"var",name:O},args:[R]};
})}]};
});
}function w(J,K){if(J.length===0){return x(t,K);
}return v({type:"func",func:"IF",args:[J[0],{type:"func",func:"AND",args:J.slice(1)},b]},K);
}function D(J,K){if(J.length===0){return x(b,K);
}return v({type:"func",func:"IF",args:[J[0],t,{type:"func",func:"OR",args:J.slice(1)}]},K);
}function z(L,J){switch(L.func.toLowerCase()){case"if":return A(L.args[0],L.args[1],L.args[2],J);
case"and":return w(L.args,J);
case"or":return D(L.args,J);
case"true":return J(t);
case"false":return J(b);
}return(function K(M,N){if(N==L.args.length){return{type:"func",func:L.func,args:M};
}else{return v(L.args[N],function(O){return K(M.concat([O]),N+1);
});
}})([I(J)],0);
}function B(M,L){var K=F("K");
var J=v(M.body,function(N){return{type:"call",func:{type:"var",value:K},args:[N]};
});
return L({type:"lambda",vars:[K].concat(M.vars),body:J});
}function C(K,M,L){var J=[];
return(function N(O){if(O==K.length){return M({type:"matrix",value:J});
}else{return(L?C:v)(K[O],function(P){J[O]=P;
return N(O+1);
});
}})(0);
}function I(K){var J=F("R");
return{type:"lambda",vars:[J],body:K({type:"var",name:J})};
}function F(J){if(!J){J="";
}J="_"+J;
return J+(++G);
}}var h=(function(u){return function(v){if(Object.prototype.hasOwnProperty.call(u,v)){return u[v];
}u[v]=new Function("'use strict';return("+v+")")();
return u[v];
};
})({});
var c={};
function i(v){var A=j(v);
var x=A.call(v);
if(Object.prototype.hasOwnProperty.call(c,x)){return c[x].clone(v.sheet,v.row,v.col);
}var u=y(q(v.ast,function(B){return{type:"return",value:B};
}));
u=["function(){","var context = this, refs = context.formula.absrefs",u,"}"].join(";\n");
var w=new o.Formula(v.refs,h(u),A,v.sheet,v.row,v.col);
c[x]=w;
return w;
function y(B){var C=B.type;
if(C=="num"){return B.value+"";
}else{if(C=="str"){return JSON.stringify(B.value);
}else{if(C=="return"){return"context.resolve("+y(B.value)+")";
}else{if(C=="func"){return"context.func("+JSON.stringify(B.func)+", "+y(B.args[0])+", "+z(B.args.slice(1))+")";
}else{if(C=="call"){return y(B.func)+"("+B.args.map(y).join(", ")+")";
}else{if(C=="ref"){return"refs["+B.index+"]";
}else{if(C=="bool"){return""+B.value;
}else{if(C=="if"){return"(context.bool("+y(B.co)+") ? "+y(B.th)+" : "+y(B.el)+")";
}else{if(C=="lambda"){return"(function("+B.vars.join(", ")+"){ return("+y(B.body)+") })";
}else{if(C=="var"){return B.name;
}else{if(C=="matrix"){return z(B.value);
}else{if(C=="null"){return"null";
}else{throw new Error("Cannot compile expression "+C);
}}}}}}}}}}}}}function z(B){return"[ "+B.map(y).join(", ")+" ]";
}}function s(z,x){var Q=[],y=0;
var O=z.readWhile;
var u=x?function(S){var R=z.pos();
S=S();
S.begin=R;
S.end=z.pos();
return S;
}:function(R){return R();
};
return{next:G,peek:H,eof:w,croak:z.croak,ahead:v,skip:P};
function A(R){return(/[0-9]/i.test(R));
}function C(R){return(/[a-z$_]/i.test(R)||R.toLowerCase()!=R.toUpperCase());
}function B(R){return C(R)||A(R)||R=="!"||R==".";
}function D(R){return R in k;
}function E(R){return";(){}[]".indexOf(R)>=0;
}function F(R){return" \t\n\xa0".indexOf(R)>=0;
}function J(){var R=false;
var S=O(function(T){if(T=="."){if(R){return false;
}R=true;
return true;
}return A(T);
});
return{type:"num",value:parseFloat(S)};
}function N(){var R=O(B);
return{type:"sym",value:R,upper:R.toUpperCase(),space:F(z.peek())};
}function M(){z.next();
return{type:"str",value:z.readEscaped('"')};
}function K(){return{type:"op",value:O(function(R,S){return(S+R) in k;
})};
}function L(){return{type:"punc",value:z.next()};
}function I(){O(F);
if(z.eof()){return null;
}var R=z.peek(),S;
if(R=='"'){return u(M);
}if(A(R)){return u(J);
}if(C(R)){return u(N);
}if(D(R)){return u(K);
}if(E(R)){return u(L);
}if((S=z.lookingAt(/^#([a-z\/]+)[?!]/i))){return u(function(){z.skip(S);
return{type:"error",value:S[1]};
});
}if(!x){z.croak("Can't handle character: "+R);
}return u(function(){return{type:"error",value:z.next()};
});
}function H(){while(Q.length<=y){Q.push(I());
}return Q[y];
}function G(){var R=H();
if(R){y++;
}return R;
}function v(U,T){var V=y,R=[],S={type:"eof"};
while(U-->0){R.push(G()||S);
}y=V;
return T.apply(R,R);
}function P(R){y+=R;
}function w(){return H()==null;
}}function f(y){var E=0,z=1,u=0;
return{next:C,peek:D,eof:w,croak:v,readWhile:G,readEscaped:F,lookingAt:B,skip:H,forward:x,pos:A};
function A(){return E;
}function C(){var I=y.charAt(E++);
if(I=="\n"){z++;
u=0;
}else{u++;
}return I;
}function D(){return y.charAt(E);
}function w(){return D()==="";
}function v(I){throw new l(I+" (pos "+u+")",E);
}function H(I){if(typeof I=="string"){if(y.substr(E,I.length)!=I){v("Expected "+I);
}x(I.length);
}else{if(I instanceof RegExp){var J=I.exec(y.substr(E));
if(J){x(J[0].length);
return J;
}}else{x(I[0].length);
}}}function x(I){while(I-->0){C();
}}function F(J){var K=false,L="";
while(!w()){var I=C();
if(K){L+=I;
K=false;
}else{if(I=="\\"){K=true;
}else{if(I==J){break;
}else{L+=I;
}}}}return L;
}function G(I){var J="";
while(!w()&&I(D(),J)){J+=C();
}return J;
}function B(I){return I.exec(y.substr(E));
}}a.parse=function(z,y,u,w){if(w instanceof Date){return{type:"date",value:o.dateToSerial(w)};
}if(typeof w=="number"){return{type:"number",value:w};
}if(typeof w=="boolean"){return{type:"boolean",value:w};
}w+="";
if(/^'/.test(w)){return{type:"string",value:w.substr(1)};
}if(/^=/.test(w)){w=w.substr(1);
if(/\S/.test(w)){return m(z,y,u,w);
}else{return{type:"string",value:"="+w};
}}if(w.toLowerCase()=="true"){return{type:"boolean",value:true};
}if(w.toLowerCase()=="false"){return{type:"boolean",value:false};
}var v=kendo.parseDate(w);
if(v){return{type:"date",value:o.dateToSerial(v)};
}var x=parseFloat(w);
if(!isNaN(x)&&w.length>0&&x==w){return{type:"number",value:x};
}return{type:"string",value:w};
};
function g(u,v,w,x){return((u.type=="sym"||u.type=="num")&&(v.type=="op"&&v.value==":")&&(w.type=="sym"||w.type=="num")&&!(x.type=="punc"&&x.value=="("&&!w.space));
}function r(u){var z=[];
u=s(f(u),true);
while(!u.eof()){z.push(u.ahead(4,w)||u.ahead(2,v)||x());
}var y=z[0];
if(y.type=="op"&&y.value=="="){y.type="startexp";
}return z;
function w(A,B,C,D){if(g(A,B,C,D)){var E=n(A.value+":"+C.value,true);
if(E){u.skip(3);
return{type:"ref",ref:E,begin:A.begin,end:C.end};
}}}function x(){var B=u.next();
if(B.type=="sym"){var A=n(B.value,true);
if(A){B.type="ref";
B.ref=A;
}else{if(B.upper=="TRUE"){B.type="bool";
B.value=true;
}else{if(B.upper=="FALSE"){B.type="bool";
B.value=false;
}}}}return B;
}function v(B,A){if(B.type=="sym"&&A.type=="punc"&&A.value=="("){u.skip(1);
B.type="func";
return B;
}}}a.parseFormula=m;
a.parseReference=n;
a.compile=i;
a.InputStream=f;
a.ParseError=l;
a.tokenize=r;
})();
(function(){var c=kendo.spreadsheet.calc;
var j=/^\[(black|green|white|blue|magenta|yellow|cyan|red)\]/i;
var k=/^\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\]/;
function g(q){q=c.InputStream(q);
var x=[],p=false,o=false,n;
while(!q.eof()){var w=v();
x.push(w);
if(w.cond){o=true;
}}function m(){x.push({cond:"text",body:[{type:"text"}]});
}if(o){m();
}else{if(x.length==1){x[0].cond="num";
m();
}else{if(x.length==2){x[0].cond={op:">=",value:0};
x[1].cond={op:"<",value:0};
m();
}else{if(x.length>=3){x[0].cond={op:">",value:0};
x[1].cond={op:"<",value:0};
x[2].cond={op:"=",value:0};
m();
if(x.length>3){x[3].cond="text";
x=x.slice(0,4);
}}}}}return x;
function r(){var y=q.skip(j);
if(y){return y[1].toLowerCase();
}}function s(){var y=q.skip(k);
if(y){var z=parseFloat(y[2]);
if(!isNaN(z)){return{op:y[1],value:z};
}}}function t(){var y=[],z;
LOOP:while(!q.eof()&&(z=u())){y.push(z);
}return y;
}function u(){var y,z;
if((z=q.skip(/^([#0?]+),([#0?]+)/))){return{type:"digit",sep:true,format:z[1]+z[2],decimal:n};
}if((z=q.skip(/^[#0?]+/))){return{type:"digit",sep:false,format:z[0],decimal:n};
}if((z=q.skip(/^(e)([+-])/i))){return{type:"exp",ch:z[1],sign:z[2]};
}if((z=q.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i))){var A="date",z=z[1].toLowerCase();
if(p&&(z=="m"||z=="mm")){A="time";
}p=false;
return{type:A,part:z.charAt(0),format:z.length};
}if((z=q.skip(/^(hh?|ss?)/i))){p=true;
z=z[1].toLowerCase();
return{type:"time",part:z.charAt(0),format:z.length};
}if((z=q.skip(/^\[(hh?|mm?|ss?)\]/i))){p=true;
z=z[1].toLowerCase();
return{type:"eltime",part:z.charAt(0),format:z.length};
}if((z=q.skip(/^(am\/pm|a\/p)/i))){z=z[1].split("/");
return{type:"ampm",am:z[0],pm:z[1]};
}switch((y=q.next())){case";":return null;
case"\\":return{type:"str",value:q.next()};
case'"':return{type:"str",value:q.readEscaped(y)};
case"@":return{type:"text"};
case"_":return{type:"space",value:q.next()};
case"*":return{type:"fill",value:q.next()};
case".":if(q.lookingAt(/^\s*[#0?]/)){n=true;
return{type:"dec"};
}return{type:"str",value:"."};
case"%":return{type:"percent"};
case",":return{type:"comma"};
}return{type:"str",value:y};
}function v(){n=false;
var y=r(),z=s();
if(!y&&z){y=r();
}return{color:y,cond:z,body:t()};
}}function h(o){return o.map(m).join(";");
function m(q){var p="";
if(q.color){p+="["+q.color+"]";
}if(q.cond){if(!(q.cond=="text"||q.cond=="num")){p+="["+q.cond.op+q.cond.value+"]";
}}p+=q.body.map(n).join("");
return p;
}function n(p){if(p.type=="digit"){if(p.sep){return p.format.charAt(0)+","+p.format.substr(1);
}else{return p.format;
}}else{if(p.type=="exp"){return p.ch+p.sign;
}else{if(p.type=="date"||p.type=="time"){return f("",p.format,p.part);
}else{if(p.type=="ampm"){return p.am+"/"+p.pm;
}else{if(p.type=="str"){return JSON.stringify(p.value);
}else{if(p.type=="text"){return"@";
}else{if(p.type=="space"){return"_"+p.value;
}else{if(p.type=="fill"){return"*"+p.value;
}else{if(p.type=="dec"){return".";
}else{if(p.type=="percent"){return"%";
}else{if(p.type=="comma"){return",";
}}}}}}}}}}}}}function a(m,n){m.forEach(function(s){var q=n;
if(s.cond=="text"){return;
}var p=s.body,o=false,r=p.length;
while(q!==0&&--r>=0){var u=p[r];
if(u.type=="digit"){if(u.decimal){o=true;
if(q>0){u.format+=f("",q,"0");
}else{if(q<0){var t=u.format.length;
u.format=u.format.substr(0,t+q);
q+=t-u.format.length;
}}if(u.format.length===0){p.splice(r,1);
while(--r>=0){u=p[r];
if(u.type=="digit"&&u.decimal){++r;
break;
}if(u.type=="dec"){p.splice(r,1);
break;
}}}}if(q>0){break;
}}}if(!o&&q>0){p.splice(r+1,0,{type:"dec"},{type:"digit",sep:false,decimal:true,format:f("",q,"0")});
}});
}function l(n){var m=0;
return{next:function(){return n[m++];
},eof:function(){return m>=n.length;
},ahead:function(p,o){if(m+p<=n.length){var q=o.apply(null,n.slice(m,m+p));
if(q){m+=p;
}return q;
}},restart:function(){m=0;
}};
}function e(r){var v=l(r.body);
var t=false;
var u=false;
var s=false;
var y=0;
var A=0;
var n="";
var B=false;
var q=0;
var w=[],p=[];
var o=r.cond;
var z="";
if(o=="text"){z="if (typeof value == 'string') { ";
}else{if(o=="num"){z="if (typeof value == 'number') { ";
}else{if(o){var x=o.op=="="?"==":o.op;
z="if (typeof value == 'number' && value "+x+" "+o.value+") { ";
n+="value = Math.abs(value); ";
}}}if(r.color){n+="element.attr.style = { color: "+JSON.stringify(r.color)+"}; ";
}function m(D,E){if((D.type=="digit"&&E.type=="comma")||(D.type=="comma"&&D.hidden&&E.type=="comma")){E.hidden=true;
A++;
}}while(!v.eof()){v.ahead(2,m);
var C=v.next();
if(C.type=="percent"){y++;
}else{if(C.type=="digit"){if(C.decimal){q+=C.format.length;
p.push(C.format);
}else{w.push(C.format);
if(C.sep){B=true;
}}}else{if(C.type=="time"){u=true;
}else{if(C.type=="date"){t=true;
}else{if(C.type=="ampm"){s=u=true;
}}}}}}if(y>0){n+="value *= "+Math.pow(100,y)+"; ";
}if(A>0){n+="value /= "+Math.pow(1000,A)+"; ";
}if(w.length){n+="var intPart = runtime.formatInt(culture, value, "+JSON.stringify(w)+", "+q+", "+B+"); ";
}if(p.length){n+="var decPart = runtime.formatDec(culture, value, "+JSON.stringify(p)+", "+q+"); ";
}if(w.length||p.length){n+="type = 'number'; ";
}if(t){n+="var date = runtime.unpackDate(value); ";
}if(u){n+="var time = runtime.unpackTime(value); ";
}if(t||u){n+="type = 'date'; ";
}if(y>0||A>0||w.length||p.length||t||u){if(!z){z="if (typeof value == 'number') { ";
}}v.restart();
while(!v.eof()){var C=v.next();
if(C.type=="dec"){n+="output += culture.numberFormat['.']; ";
}else{if(C.type=="comma"&&!C.hidden){n+="output += ','; ";
}else{if(C.type=="percent"){n+="output += culture.numberFormat.percent.symbol; ";
}else{if(C.type=="str"){n+="output += "+JSON.stringify(C.value)+"; ";
}else{if(C.type=="text"){n+="type = 'text'; ";
n+="output += value; ";
}else{if(C.type=="space"){n+="element.children.push(dom.text(output)); ";
n+="output = ''; ";
n+="element.children.push(dom.element('span', { style: { visibility: 'hidden' }}, [ dom.text("+JSON.stringify(C.value)+") ])); ";
}else{if(C.type=="fill"){n+="output += runtime.fill("+JSON.stringify(C.value)+"); ";
}else{if(C.type=="digit"){n+="output += "+(C.decimal?"decPart":"intPart")+".shift(); ";
}else{if(C.type=="date"){n+="output += runtime.date(culture, date, "+JSON.stringify(C.part)+", "+C.format+"); ";
}else{if(C.type=="time"){n+="output += runtime.time(culture, time, "+JSON.stringify(C.part)+", "+C.format+", "+s+"); ";
}else{if(C.type=="eltime"){n+="output += runtime.eltime(culture, value, "+JSON.stringify(C.part)+", "+C.format+"); ";
}else{if(C.type=="ampm"){n+="output += time.hours < 12 ? "+JSON.stringify(C.am)+" : "+JSON.stringify(C.pm)+"; ";
}}}}}}}}}}}}}n+="element.children.push(dom.text(output)); ";
n+="element.__dataType = type; ";
n+="return element; ";
if(z){n=z+n+"}";
}return n;
}var b={};
function d(n){if(Object.prototype.hasOwnProperty.call(b,n)){return b[n];
}var o=g(n);
var m=o.map(e).join("\n");
m="return function(value, culture){ 'use strict'; if (!culture) culture = kendo.culture(); var output = '', type = null, element = dom.element('span'); "+m+"; return element; };";
b[n]=new Function("runtime","dom",m)(i,kendo.dom);
return b[n];
}var i={unpackDate:c.runtime.unpackDate,unpackTime:c.runtime.unpackTime,space:function(m){return"<span style='visibility: hidden'>"+kendo.htmlEncode(m)+"</span>";
},date:function(m,n,p,o){switch(p){case"d":switch(o){case 1:return n.date;
case 2:return f(n.date,2,"0");
case 3:return m.calendars.standard.days.namesAbbr[n.day];
case 4:return m.calendars.standard.days.names[n.day];
}break;
case"m":switch(o){case 1:return n.month+1;
case 2:return f(n.month+1,2,"0");
case 3:return m.calendars.standard.months.namesAbbr[n.month];
case 4:return m.calendars.standard.months.names[n.month];
case 5:return m.calendars.standard.months.names[n.month].charAt(0);
}break;
case"y":switch(o){case 2:return n.year%100;
case 4:return n.year;
}break;
}return"##";
},time:function(n,r,q,p,m){switch(q){case"h":var o=m?r.hours%12:r.hours;
switch(p){case 1:return o;
case 2:return f(o,2,"0");
}break;
case"m":switch(p){case 1:return r.minutes;
case 2:return f(r.minutes,2,"0");
}break;
case"s":switch(p){case 1:return r.seconds;
case 2:return f(r.seconds,2,"0");
}break;
}return"##";
},eltime:function(m,p,o,n){switch(o){case"h":p=p*24;
break;
case"m":p=p*24*60;
break;
case"s":p=p*24*60*60;
break;
}p|=0;
switch(n){case 1:return p;
case 2:return f(p,2,"0");
}return"##";
},fill:function(m){return m;
},formatInt:function(o,z,v,p,x){z=z.toFixed(p).replace(/\..*$/,"");
if(p>0){if(z==="0"){z="";
}else{if(z==="-0"){z="-";
}}}var r=z.length-1;
var w=[];
var u=0,y;
function m(A){if(x&&u&&u%3===0&&A!=" "){y=o.numberFormat[","]+y;
}y=A+y;
u++;
}for(var s=v.length;
--s>=0;
){var q=v[s];
y="";
for(var t=q.length;
--t>=0;
){var n=q.charAt(t);
if(r<0){if(n=="0"){m("0");
}else{if(n=="?"){m(" ");
}}}else{m(z.charAt(r--));
}}if(s===0){while(r>=0){m(z.charAt(r--));
}}w.unshift(y);
}return w;
},formatDec:function(n,x,t,o){x=x.toFixed(o);
var u=x.indexOf(".");
if(u>=0){x=x.substr(u+1).replace(/0+$/,"");
}else{x="";
}var q=0;
var v=[];
for(var r=0;
r<t.length;
++r){var p=t[r];
var w="";
for(var s=0;
s<p.length;
++s){var m=p.charAt(s);
if(q<x.length){w+=x.charAt(q++);
}else{if(m=="0"){w+="0";
}else{if(m=="?"){w+=" ";
}}}}v.push(w);
}return v;
}};
function f(n,o,m){n+="";
while(n.length<o){n=m+n;
}return n;
}kendo.spreadsheet.formatting={compile:d,parse:g,format:function(o,n,m){return d(n)(o,m);
},type:function(n,m){return d(m)(n).__dataType;
},adjustDecimals:function(o,n){var m=g(o);
a(m,n);
return h(m);
}};
})();
(function(){var R=kendo.util;
var O=kendo.spreadsheet;
var w=O.calc;
var M=w.runtime;
var C=M.defineFunction;
var B=M.defineAlias;
var x=M.CalcError;
var K=O.RangeRef;
var y=O.CellRef;
var P=O.UnionRef;
var G=M.Matrix;
var L=O.Ref;
var z=M.daysInMonth;
var I=M.packDate;
var Q=M.unpackDate;
var A=M.daysInYear;
["abs","cos","sin","acos","asin","tan","atan","exp","sqrt"].forEach(function(T){C(T,Math[T]).args([["n","*number"]]);
});
C("ln",Math.log).args([["n","*number"]]);
C("log",function(U,T){return Math.log(U)/Math.log(T);
}).args([["num",["and","*number",["assert","$num > 0","NUM"]]],["base",["and",["or","*number",["null",10]],["assert","$base != 1","DIV/0"],["assert","$base > 0","NUM"]]]]);
C("log10",function(T){return Math.log(T)/Math.log(10);
}).args([["num",["and","*number",["assert","$num > 0","NUM"]]]]);
C("pi",function(){return Math.PI;
}).args([]);
C("sqrtpi",function(T){return Math.sqrt(T*Math.PI);
}).args([["num","*number+"]]);
C("degrees",function(T){return((180*T)/Math.PI)%360;
}).args([["radians","*number"]]);
C("radians",function(T){return Math.PI*T/180;
}).args([["degrees","*number"]]);
function d(T){return(Math.exp(T)+Math.exp(-T))/2;
}C("cosh",d).args([["num","*number"]]);
C("acosh",function(T){return Math.log(T+Math.sqrt(T-1)*Math.sqrt(T+1));
}).args([["num",["and","*number",["assert","$num >= 1"]]]]);
function n(T){return(Math.exp(T)-Math.exp(-T))/2;
}C("sinh",n).args([["num","*number"]]);
C("asinh",function(T){return Math.log(T+Math.sqrt(T*T+1));
}).args([["num","*number"]]);
C("sec",function(T){return 1/Math.cos(T);
}).args([["num","*number"]]);
C("sech",function(T){return 1/d(T);
}).args([["num","*number"]]);
C("csc",function(T){return 1/Math.sin(T);
}).args([["num","*number"]]);
C("csch",function(T){return 1/n(T);
}).args([["num","*number"]]);
C("atan2",function(T,U){return Math.atan(U/T);
}).args([["x","*divisor"],["y","*number"]]);
function p(T){return n(T)/d(T);
}C("tanh",p).args([["num","*number"]]);
C("atanh",function(T){return Math.log(Math.sqrt(1-T*T)/(1-T));
}).args([["num",["and","*number",["assert","$num > -1 && $num < 1"]]]]);
C("cot",function(T){return 1/Math.tan(T);
}).args([["num","*divisor"]]);
C("coth",function(T){return 1/p(T);
}).args([["num","*divisor"]]);
C("acot",function(T){return Math.PI/2-Math.atan(T);
}).args([["num","*number"]]);
C("acoth",function(T){return Math.log((T+1)/(T-1))/2;
}).args([["num",["and","*number",["assert","$num < -1 || $num > 1"]]]]);
C("power",function(T,U){return Math.pow(T,U);
}).args([["a","*number"],["b","*number"]]);
C("mod",function(T,U){return T%U;
}).args([["a","*number"],["b","*divisor"]]);
C("quotient",function(T,U){return Math.floor(T/U);
}).args([["a","*number"],["b","*divisor"]]);
C("ceiling",function(T,U){return U?U*Math.ceil(T/U):0;
}).args([["number","*number"],["significance",["and","*number",["assert","$significance >= 0 || $number < 0"]]]]);
C("ceiling.precise",function(T,U){U=Math.abs(U);
return U?U*Math.ceil(T/U):0;
}).args([["number","*number"],["significance",["or","*number",["null",1]]]]);
B("iso.ceiling","ceiling.precise");
C("ceiling.math",function(U,V,T){if(!V||!U){return 0;
}if(U<0&&((!T&&V<0)||(T&&V>0))){V=-V;
}return V?V*Math.ceil(U/V):0;
}).args([["number","*number"],["significance",["or","*number",["null","$number < 0 ? -1 : 1"]]],["mode",["or","*logical",["null",0]]]]);
C("floor",function(T,U){return U?U*Math.floor(T/U):0;
}).args([["number","*number"],["significance",["and","*number",["assert","$significance >= 0 || $number < 0"]]]]);
C("floor.precise",function(T,U){U=Math.abs(U);
return U?U*Math.floor(T/U):0;
}).args([["number","*number"],["significance",["or","*number",["null",1]]]]);
C("floor.math",function(U,V,T){if(!V||!U){return 0;
}if(U<0&&((!T&&V<0)||(T&&V>0))){V=-V;
}return V?V*Math.floor(U/V):0;
}).args([["number","*number"],["significance",["or","*number",["null","$number < 0 ? -1 : 1"]]],["mode",["or","*logical",["null",0]]]]);
C("int",Math.floor).args([["number","*number"]]);
C("mround",function(U,T){return T?T*Math.round(U/T):0;
}).args([["number","*number"],["multiple","*number"]]);
C("even",function(U){var T=U<0?Math.floor(U):Math.ceil(U);
return T%2?T+(T<0?-1:1):T;
}).args([["number","*number"]]);
C("odd",function(U){var T=U<0?Math.floor(U):Math.ceil(U);
return T%2?T:T+(T<0?-1:1);
}).args([["number","*number"]]);
C("sign",function(T){return T<0?-1:T>0?1:0;
}).args([["number","*number"]]);
function h(T,U){while(U){var V=T%U;
T=U;
U=V;
}return T;
}function i(T,U){return Math.abs(T*U)/h(T,U);
}C("gcd",function(U){var T=U[0];
for(var V=1;
V<U.length;
++V){T=h(T,U[V]);
}return T;
}).args([["numbers",["collect","number"]]]);
C("lcm",function(U){var T=U[0];
for(var V=1;
V<U.length;
++V){T=i(T,U[V]);
}return T;
}).args([["numbers",["collect","number"]]]);
C("sum",function(T){return T.reduce(function(V,U){return V+U;
},0);
}).args([["numbers",["collect","number"]]]);
C("product",function(T){return T.reduce(function(V,U){return V*U;
},1);
}).args([["numbers",["collect","number"]]]);
C("sumproduct",function(){var U=0,T=arguments;
T[0].each(function(X,Y,V){if(typeof X=="number"){for(var W=1;
W<T.length;
++W){var Z=T[W].get(Y,V);
if(typeof Z!="number"){return;
}X*=Z;
}U+=X;
}});
return U;
}).args([["a1","matrix"],["+",["a2",["and","matrix",["assert","$a2.width == $a1.width"],["assert","$a2.height == $a1.height"]]]]]);
C("sumsq",function(T){return T.reduce(function(V,U){return V+U*U;
},0);
}).args([["numbers",["collect","number"]]]);
C("sumx2my2",function(T,U){var V=0;
T.each(function(Y,X,W){var Z=U.get(X,W);
if(typeof Y=="number"&&typeof Z=="number"){V+=Y*Y-Z*Z;
}});
return V;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
C("sumx2py2",function(T,U){var V=0;
T.each(function(Y,X,W){var Z=U.get(X,W);
if(typeof Y=="number"&&typeof Z=="number"){V+=Y*Y+Z*Z;
}});
return V;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
C("sumxmy2",function(T,U){var V=0;
T.each(function(Y,X,W){var Z=U.get(X,W);
if(typeof Y=="number"&&typeof Z=="number"){V+=(Y-Z)*(Y-Z);
}});
return V;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
C("seriessum",function(X,V,U,T){var W=0;
T.each(function(Y){if(typeof Y!="number"){throw new x("VALUE");
}W+=Y*Math.pow(X,V);
V+=U;
});
return W;
}).args([["x","number"],["y","number"],["m","number"],["a","matrix"]]);
C("min",function(T){return Math.min.apply(Math,T);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
C("max",function(T){return Math.max.apply(Math,T);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
C("counta",function(T){return T.length;
}).args([["values",["#collect","anyvalue"]]]);
C("count",function(T){return T.length;
}).args([["numbers",["#collect","number"]]]);
C("countunique",function(V){var T=0,U=[];
V.forEach(function(W){if(U.indexOf(W)<0){T++;
U.push(W);
}});
return T;
}).args([["values",["#collect","anyvalue"]]]);
C("countblank",function(){var U=0;
function T(W){if(W==null||W===""){U++;
}}function V(W){for(var X=0;
X<W.length;
++X){var Y=W[X];
if(Y instanceof G){Y.each(T,true);
}else{T(Y);
}}}V(arguments);
return U;
}).args([["+",["args",["or","matrix","anyvalue"]]]]);
C("iseven",function(T){return T%2===0;
}).args([["number","*number"]]);
C("isodd",function(T){return T%2!==0;
}).args([["number","*number"]]);
C("n",function(T){if(typeof T=="boolean"){return T?1:0;
}if(typeof T=="number"){return T;
}return 0;
}).args([["value","*anyvalue"]]);
C("na",function(){return new x("N/A");
}).args([]);
function E(T,W){var U=[],X=0,Y=T[0];
while(X<T.length){U.push({matrix:T[X++],pred:J(T[X++])});
}ROW:for(var Z=0;
Z<Y.height;
++Z){COL:for(var V=0;
V<Y.width;
++V){for(X=0;
X<U.length;
++X){var aa=U[X].matrix.get(Z,V);
if(!U[X].pred(aa==null||aa===""?0:aa)){continue COL;
}}W(Z,V);
}}}var r=[["m1","matrix"],["c1","anyvalue"],[["m2",["and","matrix",["assert","$m1.width == $m2.width"],["assert","$m1.height == $m2.height"]]],["c2","anyvalue"]]];
C("countifs",function(){var T=0;
E(arguments,function(){T++;
});
return T;
}).args(r);
var u=[["range","matrix"]].concat(r);
C("sumifs",function(U){var T=Array.prototype.slice.call(arguments);
T.splice(1,0,H);
var V=0;
E(T,function(X,W){var Y=U.get(X,W);
if(Y){V+=Y;
}});
return V;
}).args(u);
C("averageifs",function(V){var T=Array.prototype.slice.call(arguments);
T.splice(1,0,H);
var W=0,U=0;
E(T,function(Y,X){var Z=V.get(Y,X);
if(Z==null||Z===""){Z=0;
}W+=Z;
U++;
});
return U?W/U:new x("DIV/0");
}).args(u);
C("countif",function(V,U){U=J(U);
var T=0;
V.each(function(W){if(U(W)){T++;
}});
return T;
}).args([["range","matrix"],["criteria","*anyvalue"]]);
var t=[["range","matrix"],["criteria","*anyvalue"],["sumRange",["or",["and","matrix",["assert","$sumRange.width == $range.width"],["assert","$sumRange.height == $range.height"]],["null","$range"]]]];
C("sumif",function(U,T,W){var V=0;
T=J(T);
U.each(function(aa,Y,X){if(T(aa)){var Z=W.get(Y,X);
if(H(Z)){V+=Z||0;
}}});
return V;
}).args(t);
C("averageif",function(V,U,X){var W=0,T=0;
U=J(U);
V.each(function(ab,Z,Y){if(U(ab)){var aa=X.get(Z,Y);
if(H(aa)){W+=aa||0;
T++;
}}});
return T?W/T:new x("DIV/0");
}).args(t);
(function(T){T("large",function(V,U){return V.sort(D)[U];
});
T("small",function(V,U){return V.sort(v)[U];
});
})(function(U,T){C(U,function(W,X){var Y=[];
var V=W.each(function(Z){if(Z instanceof x){return Z;
}if(typeof Z=="number"){Y.push(Z);
}});
if(V){return V;
}if(X>Y.length){return new x("NUM");
}return T(Y,X-1);
}).args([["array","matrix"],["nth","*number++"]]);
});
function a(T){return T.reduce(function(V,U){return V+U;
},0)/T.length;
}function q(V,U,T){if(T==null){T=a(V);
}return V.reduce(function(X,W){return X+Math.pow(W-T,2);
},0)/U;
}function o(U,T){return Math.sqrt(q(U,T));
}C("stdev.s",function(T){return o(T,T.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
C("stdev.p",function(T){return o(T,T.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
C("var.s",function(T){return q(T,T.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
C("var.p",function(T){return q(T,T.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
C("median",function(U){var T=U.length;
U.sort(v);
if(T%2){return U[T>>1];
}return(U[T>>1]+U[T>>1+1])/2;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
C("mode.sngl",function(Y){Y.sort(v);
var Z=null,T=0,V=1,W=null;
for(var U=0;
U<Y.length;
++U){var X=Y[U];
if(X!=Z){T=1;
Z=X;
}else{T++;
}if(T>V){V=T;
W=X;
}}return W==null?new x("N/A"):W;
}).args([["numbers",["collect","number"]]]);
C("mode.mult",function(V){var X=Object.create(null),U=2,W=[];
V.forEach(function(Y){var Z=X[Y]||0;
X[Y]=++Z;
if(Z==U){W.push(Y);
}else{if(Z>U){U=Z;
W=[Y];
}}});
var T=new G(this);
W.forEach(function(Z,Y){T.set(Y,0,Z);
});
return T;
}).args([["numbers",["collect","number"]]]);
C("geomean",function(U){var T=U.length;
var V=U.reduce(function(X,W){if(W<0){throw new x("NUM");
}return X*W;
},1);
return Math.pow(V,1/T);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
C("harmean",function(U){var T=U.length;
var V=U.reduce(function(X,W){if(!W){throw new x("DIV/0");
}return X+1/W;
},0);
return T/V;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
C("trimmean",function(W,X){var V=W.length;
W.sort(v);
var T=Math.floor(V*X);
if(T%2){--T;
}T/=2;
var Y=0;
for(var U=T;
U<V-T;
++U){Y+=W[U];
}return Y/(V-T*2);
}).args([["numbers",["collect","number",1]],["percent",["and","number",["assert","$percent >= 0 && $percent < 1","NUM"]]],["?",["assert","$numbers.length > 0","NUM"]]]);
C("frequency",function(V,T){V.sort(v);
T.sort(v);
var Y=-Infinity;
var W=0;
function U(Z){var aa=0;
while(W<V.length&&V[W]>Y&&V[W]<=Z){++aa;
++W;
}return aa;
}var X=new G(this);
T.forEach(function(ab,Z){var aa=U(ab);
Y=ab;
X.set(Z,0,aa);
});
X.set(X.height,0,V.length-W);
return X;
}).args([["data",["collect","number",1]],["bins",["collect","number",1]]]);
C("rank.eq",function(W,U,T){U.sort(T?v:D);
var V=U.indexOf(W);
return V<0?new x("N/A"):V+1;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
B("rank","rank.eq");
C("rank.avg",function(X,V,T){V.sort(T?v:D);
var W=V.indexOf(X);
if(W<0){return new x("N/A");
}for(var U=W;
V[U]==X;
++U){}return(W+U+1)/2;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
C("kurt",function(V){var U=V.length;
var T=a(V);
var Y=q(V,U-1,T);
var W=Math.sqrt(Y);
var X=V.reduce(function(aa,Z){return aa+Math.pow((Z-T)/W,4);
},0);
return U*(U+1)/((U-1)*(U-2)*(U-3))*X-3*Math.pow(U-1,2)/((U-2)*(U-3));
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 4","NUM"]]]);
function m(Y,aa,T){var X=0,W=0,V=null,Z=null,U=false;
Y.forEach(function(ab){if(ab<aa){X++;
V=V==null?ab:Math.max(V,ab);
}else{if(ab>aa){W++;
Z=Z==null?ab:Math.min(Z,ab);
}else{U=true;
}}});
if(!X&&!W){return new x("N/A");
}if(U){if(T){return(X+1)/(Y.length+1);
}return X/(X+W);
}return((Z-aa)*m(Y,V,T)+(aa-V)*m(Y,Z,T))/(Z-V);
}var s=[["array",["collect","number",1]],["x","number"],["significance",["or",["null",3],["and","integer",["assert","$significance >= 1","NUM"]]]],["?",["assert","$array.length > 0","NUM"]]];
C("percentrank.inc",function(T,W,V){var U=m(T,W,0);
U=U.toFixed(V+1);
return parseFloat(U.substr(0,U.length-1));
}).args(s);
C("percentrank.exc",function(T,W,V){var U=m(T,W,1);
U=U.toFixed(V+1);
return parseFloat(U.substr(0,U.length-1));
}).args(s);
B("percentrank","percentrank.inc");
function e(Z,aa,V){var Y=0;
var T=a(Z);
var U=a(aa);
var X=Z.length;
for(var W=0;
W<X;
++W){Y+=(Z[W]-T)*(aa[W]-U);
}return Y/V;
}C("covariance.p",function(T,U){return e(T,U,T.length);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["and",["assert","$array1.length == $array2.length","N/A"],["assert","$array1.length > 0","DIV/0"]]]]);
C("covariance.s",function(T,U){return e(T,U,T.length-1);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["and",["assert","$array1.length == $array2.length","N/A"],["assert","$array1.length > 1","DIV/0"]]]]);
B("covar","covariance.p");
var g=R.memoize(function(V){for(var U=2,T=1;
U<=V;
++U){T*=U;
}return T;
});
C("fact",g).args([["n","*integer+"]]);
C("factdouble",function(V){for(var U=2+(V&1),T=1;
U<=V;
U+=2){T*=U;
}return T;
}).args([["n","*integer+"]]);
C("multinomial",function(U){var T=1,V=0;
U.forEach(function(W){if(W<0){throw new x("NUM");
}V+=W;
T*=g(W);
});
return g(V)/T;
}).args([["numbers",["collect","number"]]]);
var c=R.memoize(function(W,V){for(var T=V+1,U=1,X=1,Y=1;
U<=W-V;
++T,++U){X*=T;
Y*=U;
}return X/Y;
});
C("combin",c).args([["n","*integer++"],["k",["and","*integer+",["assert","$k <= $n"]]]]);
C("combina",function(U,T){return c(U+T-1,U-1);
}).args([["n","*integer++"],["k",["and","*integer++",["assert","$k <= $n"]]]]);
C("average",function(T){var U=T.reduce(function(W,V){return W+V;
},0);
return U/T.length;
}).args([["numbers",["collect",["and","number",["not","boolean"]]]],["?",["assert","$numbers.length > 0","DIV/0"]]]);
C("averagea",function(V){var U=0,T=0;
V.forEach(function(W){if(typeof W!="string"){U+=W;
}++T;
});
return T?U/T:new x("DIV/0");
}).args([["values",["collect","anyvalue"]]]);
function j(W,X){W.sort(v);
var V=W.length;
var U=X|0,T=X-U;
if(U===0){return W[0];
}if(U>=V){return W[V-1];
}--U;
return W[U]+T*(W[U+1]-W[U]);
}function l(T,U){var V=U*(T.length-1)+1;
return j(T,V);
}function k(T,U){var V=U*(T.length+1);
return j(T,V);
}C("percentile.inc",l).args([["numbers",["collect","number",1]],["p",["and","number",["[between]",0,1]]]]);
C("percentile.exc",k).args([["numbers",["collect","number",1]],["p",["and","number",["(between)",0,1]]]]);
C("quartile.inc",function(T,U){return l(T,U/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
C("quartile.exc",function(T,U){return k(T,U/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
B("quartile","quartile.inc");
B("percentile","percentile.inc");
C("aggregate",function(U,X,ab,T){var ac=this;
var Z=1;
var Y=2;
var aa=4;
var W=["AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV.S","STDEV.P","SUM","VAR.S","VAR.P","MEDIAN","MODE.SNGL","LARGE","SMALL","PERCENTILE.INC","QUARTILE.INC","PERCENTILE.EXC","QUARTILE.EXC"][X-1];
var ad=[];
function V(ae){if(ae instanceof L){ac.ss.getRefCells(ae,true).forEach(function(ag){var ai=ag.value;
if((ab&Z)&&ag.hidden){return;
}if(ag.formula){var ah=ag.formula.print(ag.row,ag.col);
if(/^\s*(?:aggregate|subtotal)\s*\(/i.test(ah)){if(!(ab&aa)){return;
}}if("value" in ag.formula){ai=ag.formula.value;
}}if((ab&Y)&&ai instanceof x){return;
}if(typeof ai=="number"||ai instanceof x){ad.push(ai);
}});
}else{if(Array.isArray(ae)){for(var af=0;
af<ae.length;
++af){V(ae[af]);
}}else{if(ae instanceof G){ae.each(V);
}else{if(typeof ae=="number"){ad.push(ae);
}else{if(ae instanceof x&&!(ab&Y)){ad.push(ae);
}}}}}}ac.resolveCells(T,function(){if(X>12){V(T[0]);
var ae=T[1];
if(ae instanceof y){ae=ac.ss.getData(ae);
}if(typeof ae!="number"){return U(new x("VALUE"));
}}else{V(T);
}ac.func(W,U,ad);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],["options",["or",["null",0],["values",0,1,2,3,4,5,6,7]]],["args","rest"]]);
C("avedev",function(U){var T=U.reduce(function(W,V){return W+V;
},0)/U.length;
return U.reduce(function(W,V){return W+Math.abs(V-T);
},0)/U.length;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
function b(Y,V,W,T){if(!T){return c(V,Y)*Math.pow(W,Y)*Math.pow(1-W,V-Y);
}else{var X=0;
for(var U=0;
U<=Y;
++U){X+=c(V,U)*Math.pow(W,U)*Math.pow(1-W,V-U);
}return X;
}}C("binom.dist",b).args([["successes","integer+"],["trials",["and","integer",["assert","$trials >= $successes"]]],["probability",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
B("binomdist","binom.dist");
C("binom.inv",function(U,V,T){for(var W=0;
W<=U;
++W){if(b(W,U,V,true)>=T){return W;
}}return new x("N/A");
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["alpha",["and","number",["[between]",0,1]]]]);
B("critbinom","binom.inv");
C("binom.dist.range",function(U,V,W,X){var Y=0;
for(var T=W;
T<=X;
++T){Y+=c(U,T)*Math.pow(V,T)*Math.pow(1-V,U-T);
}return Y;
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["successes_min",["and","integer",["[between]",0,"$trials"]]],["successes_max",["or",["and","integer",["[between]","$successes_min","$trials"]],["null","$successes_min"]]]]);
C("negbinom.dist",function(X,U,V,T){if(T){var W=0;
while(X>=0){W+=c(X+U-1,X)*Math.pow(V,U)*Math.pow(1-V,X);
X--;
}return W;
}return c(X+U-1,X)*Math.pow(V,U)*Math.pow(1-V,X);
}).args([["number_f","integer+"],["number_s","integer+"],["probability_s",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
B("negbinomdist","negbinom.dist");
C("address",function(X,W,U,T,Y){var V=new y(X-1,W-1,U-1);
if(Y){V.setSheet(Y,true);
}return T?V.print(0,0):V.print();
}).args([["row","integer++"],["col","integer++"],["abs",["or",["null",1],["values",1,2,3,4]]],["a1",["or",["null",true],"logical"]],["sheet",["or","null","string"]]]);
C("areas",function(V){var T=0;
(function U(W){if(W instanceof y||W instanceof K){T++;
}else{if(W instanceof P){W.refs.forEach(U);
}}})(V);
return T;
}).args([["ref","ref"]]);
C("choose",function(T){if(T>=arguments.length){return new x("N/A");
}else{return arguments[T];
}}).args([["index","*integer"],["+",["value","anything"]]]);
C("column",function(T){if(!T){return this.formula.col+1;
}if(T instanceof y){return T.col+1;
}return this.asMatrix(T).mapCol(function(U){return U+T.topLeft.col+1;
});
}).args([["ref",["or","area","null"]]]);
C("columns",function(T){return T instanceof L?T.width():T.width;
}).args([["ref",["or","area","#matrix"]]]);
C("formulatext",function(U){var T=this.ss.getRefCells(U)[0];
if(!T.formula){return new x("N/A");
}return T.formula.print(T.row,T.col);
}).args([["ref","ref"]]);
C("hlookup",function(X,U,W,T){var V=null;
U.eachCol(function(Y){var Z=U.get(0,Y);
if(T){if(Z>X){return true;
}V=Y;
}else{if(Z===X){V=Y;
return true;
}}});
if(V==null){return new x("N/A");
}return U.get(W-1,V);
}).args([["value","anyvalue"],["range","matrix"],["row","integer++"],["approx",["or","logical",["null",true]]]]);
C("index",function(U,V,T){if(V==null&&T==null){return new x("N/A");
}if(U.width>1&&U.height>1){if(V!=null&&T!=null){return U.get(V-1,T-1);
}if(V==null){return U.mapRow(function(W){return U.get(W,T-1);
});
}if(T==null){return U.mapCol(function(W){return U.get(V-1,W);
});
}}if(U.width==1){return U.get(V-1,0);
}if(U.height==1){return U.get(0,T-1);
}return new x("REF");
}).args([["range","matrix"],["row",["or","integer++","null"]],["col",["or","integer++","null"]]]);
C("indirect",function(W){try{var V=this.formula;
var U=w.parseFormula(V.sheet,V.row,V.col,W);
if(!(U.ast instanceof L)){throw 1;
}return U.ast.absolute(V.row,V.col);
}catch(T){return new x("REF");
}}).args([["thing","string"]]);
C("match",function(X,V,W){var U=1,T;
if(W===0){T=J(X);
}else{if(W===-1){T=J("<="+X);
}else{if(W===1){T=J(">="+X);
}}}if(V.each(function(Y){if(Y!=null&&T(Y)){if(W!==0&&X!=Y){--U;
}return true;
}U++;
},true)&&U>0){return U;
}else{return new x("N/A");
}}).args([["value","anyvalue"],["range","matrix"],["type",["or",["values",-1,0,1],["null",1]]]]);
C("offset",function(V,W,T,U,Y){var X=(V instanceof y?V:V.topLeft).clone();
X.row+=W;
X.col+=T;
if(X.row<0||X.col<0){return new x("VALUE");
}if(U>1||Y>1){return new K(X,new y(X.row+U-1,X.col+Y-1)).setSheet(V.sheet,V.hasSheet());
}return X;
}).args([["ref","area"],["rows","*integer"],["cols","*integer"],["height",["or","*integer++",["null","$ref.height()"]]],["width",["or","*integer++",["null","$ref.width()"]]]]);
C("row",function(T){if(!T){return this.formula.row+1;
}if(T instanceof y){return T.row+1;
}return this.asMatrix(T).mapRow(function(U){return U+T.topLeft.row+1;
});
}).args([["ref",["or","area","null"]]]);
C("rows",function(T){return T instanceof L?T.height():T.height;
}).args([["ref",["or","area","#matrix"]]]);
C("vlookup",function(X,V,U,T){var W=null;
V.eachRow(function(Z){var Y=V.get(Z,0);
if(T){if(Y>X){return true;
}W=Z;
}else{if(Y===X){W=Z;
return true;
}}});
if(W==null){return new x("N/A");
}return V.get(W,U-1);
}).args([["value","anyvalue"],["range","matrix"],["col","integer++"],["approx",["or","logical",["null",true]]]]);
C("date",function(V,U,T){return I(V,U-1,T);
}).args([["year","*integer"],["month","*integer"],["date","*integer"]]);
C("day",function(T){return Q(T).date;
}).args([["date","*date"]]);
C("month",function(T){return Q(T).month+1;
}).args([["date","*date"]]);
C("year",function(T){return Q(T).year;
}).args([["date","*date"]]);
C("weekday",function(T){return Q(T).day+1;
}).args([["date","*date"]]);
C("weeknum",function(T,X){var V=I(Q(T).year,0,1);
var W=Q(V);
var U;
if(X==21){U=3-(W.day+6)%7;
if(U<0){U+=7;
}V+=U;
W.date+=U;
W.day=4;
X=1;
}else{if(X==1){X=0;
}else{if(X==2){X=1;
}else{X=(X-10)%7;
}}}U=W.day-X;
if(U<0){U+=7;
}V-=U;
return Math.ceil((T+1-V)/7);
}).args([["date","*date"],["type",["or",["null",1],["values",1,2,11,12,13,14,15,16,17,21]]]]);
function S(U){var T=Q(I(U,0,1));
if((T.day==4)||(T.day==3&&M.isLeapYear(U))){return 53;
}return 52;
}C("isoweeknum",function F(U){var T=Q(U);
var V=T.day||7;
var W=Math.floor((T.ord-V+10)/7);
if(W<1){return S(T.year-1);
}else{if(W==53&&W>S(T.year)){return 1;
}}return W;
}).args([["date","*date"]]);
C("now",function(){return M.dateToSerial(new Date());
}).args([]);
C("today",function(){return M.dateToSerial(new Date())|0;
}).args([]);
C("time",function(T,U,V){return M.packTime(T,U,V,0);
}).args([["hours","*integer"],["minutes","*integer"],["seconds","*integer"]]);
C("hour",function(T){return M.unpackTime(T).hours;
}).args([["time","*datetime"]]);
C("minute",function(T){return M.unpackTime(T).minutes;
}).args([["time","*datetime"]]);
C("second",function(T){return M.unpackTime(T).seconds;
}).args([["time","*datetime"]]);
C("edate",function(T,W){var U=Q(T);
var V=U.month+W;
var X=U.year+Math.floor(V/12);
V%=12;
if(V<0){V+=12;
}U=Math.min(U.date,z(X,V));
return I(X,V,U);
}).args([["start_date","*date"],["months","*integer"]]);
C("eomonth",function(T,W){var U=Q(T);
var V=U.month+W;
var X=U.year+Math.floor(V/12);
V%=12;
if(V<0){V+=12;
}U=z(X,V);
return I(X,V,U);
}).args([["start_date","*date"],["months","*integer"]]);
C("workday",function(T,X,V){var W=X>0?1:-1;
X=Math.abs(X);
var U=Q(T).day;
while(X>0){T+=W;
U=(U+W)%7;
if(U>0&&U<6&&V.indexOf(T)<0){--X;
}}return T;
}).args([["start_date","date"],["days","integer"],["holidays",["collect","date"]]]);
C("networkdays",function(U,W,X){if(U>W){var Y=U;
U=W;
W=Y;
}var T=0;
var V=Q(U).day;
while(U<=W){if(V>0&&V<6&&X.indexOf(U)<0){T++;
}U++;
V=(V+1)%7;
}return T;
}).args([["start_date","date"],["end_date","date"],["holidays",["collect","date"]]]);
C("days",function(U,T){return T-U;
}).args([["start_date","*date"],["end_date","*date"]]);
function f(X,V,W){var T=Q(X);
var U=Q(V);
if(W){if(T.date==31){T.date=30;
}if(U.date==31){U.date=30;
}}else{if(T.month==1&&U.month==1&&T.date==z(T.year,1)&&U.date==z(U.year,1)){U.date=30;
}if(T.date==z(T.year,T.month)){T.date=30;
if(U.date==31){U.date=30;
}}}return(360*(U.year-T.year)+30*(U.month-T.month)+(U.date-T.date));
}C("days360",f).args([["start_date","*date"],["end_date","*date"],["method",["or","*logical",["null","false"]]]]);
C("yearfrac",function(V,T,U){switch(U){case 0:return f(V,T,false)/360;
case 1:return(T-V)/A(Q(V).year);
case 2:return(T-V)/360;
case 3:return(T-V)/365;
case 4:return f(V,T,true)/360;
}}).args([["start_date","*date"],["end_date","*date"],["method",["or",["null",0],["values",0,1,2,3,4]]]]);
C("datevalue",function(U){var T=kendo.parseDate(U);
if(T){return M.dateToSerial(T);
}return new x("VALUE");
}).args([["text","*string"]]);
C("timevalue",function(Y){var V=Y.toLowerCase().match(/(\d+):(\d+)(:(\d+)(\.(\d+))?)?\s*(am?|pm?)?/);
if(V){var U=parseFloat(V[1]);
var W=parseFloat(V[2]);
var X=V[3]?parseFloat(V[4]):0;
var T=V[7];
if(T&&(U>12||U<1)){return new x("VALUE");
}if(/^p/.test(T)){U+=12;
}return M.packTime(U,W,X,0);
}return new x("VALUE");
}).args([["text","*string"]]);
C("mdeterm",function(U){var T=U.each(function(V){if(typeof V!="number"){return new x("VALUE");
}},true);
return T||U.determinant();
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
C("transpose",function(T){return T.transpose();
}).args([["range","matrix"]]);
C("mmult",function(T,U){return T.multiply(U);
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.height == $a.width"]]]]);
C("munit",function(T){return new G(this).unit(T);
}).args([["n","integer+"]]);
C("minverse",function(U){var T=U.each(function(V){if(typeof V!="number"){return new x("VALUE");
}},true);
return T||U.inverse()||new x("VALUE");
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
C("rand",function(){return Math.random();
}).args([]);
C("randbetween",function(U,T){return U+Math.floor((T-U+1)*Math.random());
}).args([["min","integer"],["max",["and","integer",["assert","$max >= $min"]]]]);
C("true",function(){return true;
}).args([]);
C("false",function(){return true;
}).args([]);
C("roman",function(T){return R.arabicToRoman(T).toUpperCase();
}).args([["number","*integer"]]);
C("arabic",function(U){var T=R.romanToArabic(U);
return T==null?new x("VALUE"):T;
}).args([["roman","*string"]]);
C("base",function(U,V,T){var W=U.toString(V).toUpperCase();
while(W.length<T){W="0"+W;
}return W;
}).args([["number","*integer"],["radix",["and","*integer",["[between]",2,36]]],["minLen",["or","*integer+",["null",0]]]]);
C("decimal",function(W,V){W=W.toUpperCase();
var X=0;
for(var U=0;
U<W.length;
++U){var T=W.charCodeAt(U);
if(T>=48&&T<=57){T-=48;
}else{if(T>=65&&T<(55+V)){T-=55;
}else{return new x("VALUE");
}}X=X*V+T;
}return X;
}).args([["text","*string"],["radix",["and","*integer",["[between]",2,36]]]]);
C("char",function(T){return String.fromCharCode(T);
}).args([["code","*integer+"]]);
var N=/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;
C("clean",function(T){return T.replace(N,"");
}).args([["text","*string"]]);
C("code",function(T){return T.charAt(0);
}).args([["text","*string"]]);
B("unichar","char");
B("unicode","code");
C("concatenate",function(){var U="";
for(var T=0;
T<arguments.length;
++T){U+=arguments[T];
}return U;
}).args([["+",["text","*string"]]]);
C("dollar",function(W,U){var V="$#,##0.DECIMALS;($#,##0.DECIMALS)";
var T="";
while(U-->0){T+="0";
}V=V.replace(/DECIMALS/g,T);
return O.formatting.format(W,V).text();
}).args([["number","*number"],["decimals",["or","*integer++",["null",2]]]]);
C("exact",function(T,U){return T===U;
}).args([["text1","*string"],["text2","*string"]]);
C("find",function(W,V,U){var T=V.indexOf(W,U-1);
return T<0?new x("VALUE"):T+1;
}).args([["substring","*string"],["string","*string"],["start",["or","*integer++",["null",1]]]]);
C("fixed",function(X,U,W){var V=W?"0.DECIMALS":"#,##0.DECIMALS";
var T="";
while(U-->0){T+="0";
}V=V.replace(/DECIMALS/g,T);
return O.formatting.format(X,V).text();
}).args([["number","*number"],["decimals",["or","*integer++",["null",2]]],["noCommas",["or","*boolean",["null",false]]]]);
C("left",function(U,T){return U.substr(0,T);
}).args([["text","*string"],["length",["or","*integer+",["null",1]]]]);
C("right",function(U,T){return U.substr(-T);
}).args([["text","*string"],["length",["or","*integer+",["null",1]]]]);
C("len",function(T){return T.length;
}).args([["text","*string"]]);
C("lower",function(T){return T.toLowerCase();
}).args([["text","*string"]]);
C("upper",function(T){return T.toUpperCase();
}).args([["text","*string"]]);
C("ltrim",function(T){return T.replace(/^\s+/,"");
}).args([["text","*string"]]);
C("rtrim",function(T){return T.replace(/\s+$/,"");
}).args([["text","*string"]]);
C("trim",function(T){return T.replace(/^\s+|\s+$/,"");
}).args([["text","*string"]]);
C("mid",function(V,U,T){return V.substr(U-1,T);
}).args([["text","*string"],["start","*integer++"],["length","*integer+"]]);
C("proper",function(T){return T.toLowerCase().replace(/\b./g,function(U){return U.toUpperCase();
});
}).args([["text","*string"]]);
C("replace",function(W,V,T,U){return W.substr(0,--V)+U+W.substr(V+T);
}).args([["text","*string"],["start","*integer++"],["length","*integer+"],["newText","*string"]]);
C("rept",function(V,T){var U="";
while(T-->0){U+=V;
}return U;
}).args([["text","*string"],["number","*integer+"]]);
C("search",function(W,V,U){var T=V.toLowerCase().indexOf(W.toLowerCase(),U-1);
return T<0?new x("VALUE"):T+1;
}).args([["substring","*string"],["string","*string"],["start",["or","*integer++",["null",1]]]]);
C("substitute",function(Y,V,T,U){if(V===T){return Y;
}var W=-1;
function X(){Y=Y.substring(0,W)+T+Y.substring(W+V.length);
}while((W=Y.indexOf(V,W+1))>=0){if(U==null){X();
}else{if(--U===0){X();
break;
}}}return Y;
}).args([["text","*string"],["oldText","*string"],["newText","*string"],["nth",["or","*integer++","null"]]]);
C("t",function(T){return typeof T=="string"?T:"";
}).args([["value","*anyvalue"]]);
C("text",function(U,T){return O.formatting.format(U,T).text();
}).args([["value","*anyvalue"],["format","*string"]]);
C("value",function(T){if(typeof T=="number"){return T;
}if(typeof T=="boolean"){return +T;
}T=(T+"").replace(/[$€,]/g,"");
T=parseFloat(T);
return isNaN(T)?new x("VALUE"):T;
}).args([["value","*anyvalue"]]);
var J=(function(){var ab={};
function aa(ac,ae){if(typeof ae=="string"){var ad=parseFloat(ae);
if(!isNaN(ad)){ae=ad;
}}return function(af){var ag=ae;
if(typeof af=="string"&&typeof ag=="string"){af=af.toLowerCase();
ag=ag.toLowerCase();
}return ac(af,ag);
};
}function Z(ac){if(typeof ac=="string"){return ac.toLowerCase();
}return ac;
}function W(ac,ad){return Z(ac)<Z(ad);
}function X(ac,ad){return Z(ac)<=Z(ad);
}function U(ac,ad){return Z(ac)>Z(ad);
}function V(ac,ad){return Z(ac)>=Z(ad);
}function Y(ac,ad){return Z(ac)!=Z(ad);
}function T(ac,ad){if(ad instanceof RegExp){return ad.test(ac);
}return Z(ac)==Z(ad);
}return function(ac){if(typeof ac=="function"){return ac;
}var ad;
if((ad=/^=(.*)$/.exec(ac))){return aa(T,ad[1]);
}if((ad=/^<>(.*)$/.exec(ac))){return aa(Y,ad[1]);
}if((ad=/^<=(.*)$/.exec(ac))){return aa(X,ad[1]);
}if((ad=/^<(.*)$/.exec(ac))){return aa(W,ad[1]);
}if((ad=/^>=(.*)$/.exec(ac))){return aa(V,ad[1]);
}if((ad=/^>(.*)$/.exec(ac))){return aa(U,ad[1]);
}if(/[?*]/.exec(ac)){var ae;
if(Object.prototype.hasOwnProperty.call(ab,ac)){ae=ab[ac];
}else{ae=ac.replace(/(~\?|~\*|[\]({\+\.\|\^\$\\})\[]|[?*])/g,function(af){switch(af){case"~?":return"\\?";
case"~*":return"\\*";
case"?":return".";
case"*":return".*";
default:return"\\"+af;
}});
ae=ab[ac]=new RegExp("^"+ae+"$","i");
}return aa(T,ae);
}return aa(T,ac);
};
})();
function H(T){return typeof T=="number"||typeof T=="boolean"||T==null||T==="";
}function v(T,U){return T===U?0:T<U?-1:1;
}function D(T,U){return T===U?0:T<U?1:-1;
}})();
(function(){var ag=kendo.spreadsheet;
var l=ag.calc;
var ae=l.runtime;
var u=ae.defineFunction;
var m=ae.CalcError;
u("ERF",function(ao,ap){if(ap==null){return w(ao);
}return w(ap)-w(ao);
}).args([["lower_limit","number"],["upper_limit",["or","number","null"]]]);
u("ERFC",x).args([["x","number"]]);
u("GAMMALN",P).args([["x","number++"]]);
u("GAMMA",L).args([["x","number"]]);
u("GAMMA.DIST",M).args([["x","number+"],["alpha","number++"],["beta","number++"],["cumulative","logical"]]);
u("GAMMA.INV",O).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"]]);
u("NORM.S.DIST",X).args([["z","number"],["cumulative","logical"]]);
u("NORM.S.INV",Y).args([["p",["and","number",["[between]",0,1]]]]);
u("NORM.DIST",V).args([["x","number"],["mean","number"],["stddev","number++"],["cumulative","logical"]]);
u("NORM.INV",W).args([["p",["and","number",["[between]",0,1]]],["mean","number"],["stddev","number++"]]);
u("BETADIST",g).args([["x","number"],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["and",["assert","$x >= $A","NUM"],["assert","$x <= $B","NUM"],["assert","$A < $B","NUM"]]]]);
u("BETA.DIST",d).args([["x","number"],["alpha","number++"],["beta","number++"],["cumulative","logical"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["and",["assert","$x >= $A","NUM"],["assert","$x <= $B","NUM"],["assert","$A < $B","NUM"]]]]);
u("BETA.INV",e).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]]]);
u("CHISQ.DIST",n).args([["x","number+"],["deg_freedom","integer++"],["cumulative","logical"]]);
u("CHISQ.DIST.RT",p).args([["x","number+"],["deg_freedom","integer++"]]);
u("CHISQ.INV",o).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
u("CHISQ.INV.RT",q).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
u("CHISQ.TEST",function(ao,ap){return r(ao.data,ap.data);
}).args([["actual_range","matrix"],["expected_range","matrix"],["?",["and",["assert","$actual_range.width == $expected_range.width"],["assert","$actual_range.height == $expected_range.height"]]]]);
u("EXPON.DIST",y).args([["x","number+"],["lambda","number++"],["cumulative","logical"]]);
u("POISSON.DIST",ab).args([["x","integer+"],["mean","number+"],["cumulative","logical"]]);
u("F.DIST",A).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"],["cumulative","logical"]]);
u("F.DIST.RT",B).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
u("F.INV",C).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
u("F.INV.RT",D).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
u("F.TEST",I).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["and",["assert","$array1.length >= 2","DIV/0"],["assert","$array2.length >= 2","DIV/0"]]]]);
u("FISHER",E).args([["x",["and","number",["(between)",-1,1]]]]);
u("FISHERINV",F).args([["y","number"]]);
u("T.DIST",ai).args([["x","number"],["deg_freedom","integer++"],["cumulative","logical"]]);
u("T.DIST.RT",am).args([["x","number"],["deg_freedom","integer++"]]);
u("T.DIST.2T",aj).args([["x","number+"],["deg_freedom","integer++"]]);
u("T.INV",al).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
u("T.INV.2T",ak).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
u("T.TEST",an).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["tails",["and","integer",["values",1,2]]],["type",["and","integer",["values",1,2,3]]],["?",["and",["assert","$type != 1 || $array1.length == $array2.length","N/A"],["assert","$array1.length >= 2","DIV/0"],["assert","$array2.length >= 2","DIV/0"]]]]);
u("CONFIDENCE.T",t).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++",["assert","$size != 1","DIV/0"]]]]);
u("CONFIDENCE.NORM",s).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++"]]]);
u("GAUSS",Q).args([["z","number"]]);
u("PHI",aa).args([["x","number"]]);
u("LOGNORM.DIST",S).args([["x","number++"],["mean","number"],["standard_dev","number++"],["cumulative","logical"]]);
u("LOGNORM.INV",T).args([["probability",["and","number",["(between)",0,1]]],["mean","number"],["standard_dev","number++"]]);
u("PROB",ac).args([["x_range",["collect","number",1]],["prob_range",["collect","number",1]],["lower_limit","number"],["upper_limit",["or","number",["null","$lower_limit"]]],["?",["and",["assert","$prob_range.length == $x_range.length","N/A"]]]]);
u("SLOPE",af).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["and",["assert","$known_x.length == $known_y.length","N/A"],["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]]);
u("INTERCEPT",R).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["and",["assert","$known_x.length == $known_y.length","N/A"],["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]]);
u("PEARSON",Z).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["and",["assert","$array2.length == $array1.length","N/A"],["assert","$array2.length > 0 && $array1.length > 0","N/A"]]]]);
u("RSQ",ad).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["and",["assert","$known_x.length == $known_y.length","N/A"],["assert","$known_x.length > 0 && $known_y.length > 0","N/A"],["assert","$known_x.length != 1 && $known_y.length != 1","N/A"]]]]);
u("STEYX",ah).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["and",["assert","$known_x.length == $known_y.length","N/A"],["assert","$known_x.length >= 3 && $known_y.length >= 3","DIV/0"]]]]);
u("FORECAST",G).args([["x","number"],["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["and",["assert","$known_x.length == $known_y.length","N/A"],["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]]);
var U=300,v=2.2204e-16,H=1e-30,z=Math.abs;
function w(at){if(z(at)>=3.3){return 1-x(at);
}var ar=at>0?1:-1;
if(ar==-1){at=-at;
}var ap=0,ao=1;
for(var aq=1;
aq<100;
aq++){ap+=ao;
ao*=2*at*at/(2*aq+1);
}return ar*2/Math.sqrt(Math.PI)*at*Math.exp(-at*at)*ap;
}function x(ar){if(z(ar)<3.3){return 1-w(ar);
}var aq=1;
if(ar<0){aq=-1;
ar=-ar;
}var ao=ar;
for(var ap=8;
ap>=1;
ap-=0.5){ao=ar+ap/ao;
}ao=1/(ar+ao);
return aq==1?Math.exp(-ar*ar)/Math.sqrt(Math.PI)*ao:2-Math.exp(-ar*ar)/Math.sqrt(Math.PI)*ao;
}function P(at){var ao=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,0.001208650973866179,-5.395239384953e-06];
var au=at,ar=at+5.5,aq=ao[0];
ar-=(at+0.5)*Math.log(ar);
for(var ap=1;
ap<=6;
ap++){au+=1;
aq+=ao[ap]/au;
}return -ar+Math.log(Math.sqrt(2*Math.PI)*aq/at);
}function L(ap){if(ap>0){return Math.exp(P(ap));
}var ao=Math.PI,aq=-ap;
return -ao/(aq*L(aq)*Math.sin(ao*aq));
}function h(ao,ap){return P(ao)+P(ap)-P(ao+ap);
}function c(ao,ap){return Math.exp(h(ao,ap));
}function N(ao,ap){return ap<ao+1?K(ao,ap):1-J(ao,ap);
}function K(ao,aw){var av=1/ao,ar=av,aq=ao;
var at=P(ao),au;
for(au=1;
au<=U;
au++){aq++;
ar*=aw/aq;
av+=ar;
if(z(ar)<z(av)*v){break;
}}return av*Math.exp(-aw+ao*Math.log(aw)-at);
}function J(ao,ay){var av=H,ar=av,at=0,ap=1,aq=ay+1-ao;
var aw=P(ao);
for(var ax=1;
ax<=U;
ax++){at=aq+ap*at;
if(z(at)<H){at=H;
}ar=aq+ap/ar;
if(z(ar)<H){ar=H;
}at=1/at;
var au=ar*at;
av*=au;
if(z(au-1)<v){break;
}aq+=2;
ap=-ax*(ax-ao);
}return av*Math.exp(-ay-aw+ao*Math.log(ay));
}function M(ar,ao,ap,aq){if(!aq){return Math.pow(ar/ap,ao-1)*Math.exp(-ar/ap)/(ap*L(ao));
}return N(ao,ar/ap);
}function O(av,ao,aq){if(av===0){return 0;
}if(av==1){return Infinity;
}var at=0,au=10,ax=0,ap=ao*aq;
if(ap>1){au*=ap;
}for(var ar=0;
ar<U;
ar++){ax=0.5*(at+au);
var aw=M(ax,ao,aq,true);
if(z(av-aw)<1e-16){break;
}if(aw>av){au=ax;
}else{at=ax;
}}return ax;
}function X(ap,ao){if(!ao){return Math.exp(-ap*ap/2)/Math.sqrt(2*Math.PI);
}return 0.5+0.5*w(ap/Math.sqrt(2));
}function Y(at){var ao=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],ap=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],aq=[-0.007784894002430293,-0.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],ar=[0.007784695709041462,0.3224671290700398,2.445134137142996,3.754408661907416];
var av=0.02425,au=1-av;
var aw,ax;
if(at<av){aw=Math.sqrt(-2*Math.log(at));
return(((((aq[0]*aw+aq[1])*aw+aq[2])*aw+aq[3])*aw+aq[4])*aw+aq[5])/((((ar[0]*aw+ar[1])*aw+ar[2])*aw+ar[3])*aw+1);
}if(au<at){aw=Math.sqrt(-2*Math.log(1-at));
return -(((((aq[0]*aw+aq[1])*aw+aq[2])*aw+aq[3])*aw+aq[4])*aw+aq[5])/((((ar[0]*aw+ar[1])*aw+ar[2])*aw+ar[3])*aw+1);
}aw=at-0.5;
ax=aw*aw;
return(((((ao[0]*ax+ao[1])*ax+ao[2])*ax+ao[3])*ax+ao[4])*ax+ao[5])*aw/(((((ap[0]*ax+ap[1])*ax+ap[2])*ax+ap[3])*ax+ap[4])*ax+1);
}function V(ar,ap,aq,ao){if(!ao){return Math.exp(-(ar-ap)*(ar-ap)/(2*aq*aq))/(aq*Math.sqrt(2*Math.PI));
}return X((ar-ap)/aq,true);
}function W(ap,ao,aq){return ao+aq*Y(ap);
}function k(aq,ao,ap){return Math.exp((ao-1)*Math.log(aq)+(ap-1)*Math.log(1-aq)-h(ao,ap));
}function i(ar,ao,ap){var aq=Math.exp(ao*Math.log(ar)+ap*Math.log(1-ar)-h(ao,ap));
return ar<(ao+1)/(ao+ap+2)?aq*f(ao,ap,ar)/ao:1-aq*f(ap,ao,1-ar)/ap;
}function f(ao,aq,aB){var aw,ax;
var ap,ar,at,au,av,ay,az,aA;
ay=ao+aq;
aA=ao+1;
az=ao-1;
ar=1;
at=1-ay*aB/aA;
if(z(at)<H){at=H;
}at=1/at;
av=at;
for(aw=1;
aw<=U;
aw++){ax=2*aw;
ap=aw*(aq-aw)*aB/((az+ax)*(ao+ax));
at=1+ap*at;
if(z(at)<H){at=H;
}ar=1+ap/ar;
if(z(ar)<H){ar=H;
}at=1/at;
av*=at*ar;
ap=-(ao+aw)*(ay+aw)*aB/((ao+ax)*(aA+ax));
at=1+ap*at;
if(z(at)<H){at=H;
}ar=1+ap/ar;
if(z(ar)<H){ar=H;
}at=1/at;
au=at*ar;
av*=au;
if(z(au-1)<v){break;
}}return av;
}function j(au,ao,ap){var ar=0,at=1,aw=0;
for(var aq=0;
aq<U;
aq++){aw=0.5*(ar+at);
var av=i(aw,ao,ap);
if(z(au-av)<v){break;
}if(av>au){at=aw;
}else{ar=aw;
}}return aw;
}function g(at,ao,ap,aq,ar){return i((at-aq)/(ar-aq),ao,ap);
}function d(au,ao,ap,aq,ar,at){if(aq){return i((au-ar)/(at-ar),ao,ap);
}return k((au-ar)/(at-ar),ao,ap)/(at-ar);
}function e(at,ao,ap,aq,ar){return aq+(ar-aq)*j(at,ao,ap);
}function n(aq,ap,ao){return M(aq,ap/2,2,ao);
}function p(ap,ao){return 1-n(ap,ao,true);
}function o(ap,ao){return O(ap,ao/2,2);
}function q(ap,ao){return o(1-ap,ao);
}function r(aw,ar){var ax=aw.length,ao=aw[0].length;
var ay=0,at,au;
for(at=0;
at<ax;
at++){for(au=0;
au<ao;
au++){var aq=ar[at][au];
var ap=aw[at][au]-aq;
ap*=ap;
ay+=ap/aq;
}}var av=(ax-1)*(ao-1);
return p(ay,av);
}function y(aq,ap,ao){if(ao){return 1-Math.exp(-ap*aq);
}return ap*Math.exp(-ap*aq);
}function ab(aq,at,ao){if(ao){return 1-n(2*at,2*(aq+1),true);
}var ar=0;
for(var ap=2;
ap<=aq;
ap++){ar+=Math.log(ap);
}return Math.exp(aq*Math.log(at)-at-ar);
}function A(at,aq,ap,ao){if(ao){return i(aq*at/(ap+aq*at),aq/2,ap/2);
}var ar=aq/ap;
aq/=2;
ap/=2;
return ar/c(aq,ap)*Math.pow(ar*at,aq-1)/Math.pow(1+ar*at,aq+ap);
}function B(aq,ap,ao){return 1-A(aq,ap,ao,true);
}function D(aq,ap,ao){return ao/ap*(1/e(aq,ao/2,ap/2,0,1)-1);
}function C(aq,ap,ao){return ao/ap*(1/e(1-aq,ao/2,ap/2,0,1)-1);
}function a(ao){var aq=0,ar=ao.length;
for(var ap=0;
ap<ar;
ap++){aq+=ao[ap];
}return aq/ar;
}function b(ao,ar){var au=0,at=ao.length;
for(var aq=0;
aq<at;
aq++){var ap=ao[aq]-ar;
au+=ap*ap;
}return au/(at-1);
}function I(ao,ap){var aq=ao.length-1,ar=ap.length-1;
var at=b(ao,a(ao)),au=b(ap,a(ap));
if(!at||!au){throw new m("DIV/0");
}return 2*A(at/au,aq,ar,true);
}function E(ao){return 0.5*Math.log((1+ao)/(1-ao));
}function F(ap){var ao=Math.exp(2*ap);
return(ao-1)/(ao+1);
}function ai(aq,ap,ao){if(ao){return 1-0.5*i(ap/(aq*aq+ap),ap/2,0.5);
}return 1/(Math.sqrt(ap)*c(0.5,ap/2))*Math.pow(1+aq*aq/ap,-(ap+1)/2);
}function am(ap,ao){return 1-ai(ap,ao,true);
}function aj(ap,ao){if(ap<0){ap=-ap;
}return 2*am(ap,ao);
}function al(ap,ao){var aq=j(2*Math.min(ap,1-ap),ao/2,0.5);
aq=Math.sqrt(ao*(1-aq)/aq);
return(ap>0.5)?aq:-aq;
}function ak(ap,ao){return al(1-ap/2,ao);
}function an(at,au,aE,aF){var az=at.length,aA=au.length;
var aD,ar;
if(aF==1){var ao=0,ap=0;
for(var av=0;
av<az;
av++){var aq=at[av]-au[av];
ao+=aq;
ap+=aq*aq;
}var ay=ao/az;
aD=ay/Math.sqrt((ap-ao*ay)/(az*(az-1)));
return aE==1?am(aD,az-1):aj(aD,az-1);
}var aw=a(at),ax=a(au),aJ=b(at,aw),aK=b(au,ax);
if(aF==3){var aH=aJ/az,aI=aK/aA,aG=aH+aI;
var aB=aH/aG,aC=aI/aG;
ar=1/(aB*aB/(az-1)+aC*aC/(aA-1));
aD=z(aw-ax)/Math.sqrt(aG);
return aE==1?am(aD,ar):aj(aD,ar);
}else{ar=az+aA-2;
aD=z(aw-ax)*Math.sqrt(ar*az*aA/((az+aA)*((az-1)*aJ+(aA-1)*aK)));
return aE==1?am(aD,ar):aj(aD,ar);
}}function t(ao,aq,ap){return -al(ao/2,ap-1)*aq/Math.sqrt(ap);
}function s(ao,aq,ap){return -Y(ao/2)*aq/Math.sqrt(ap);
}function Q(ao){return X(ao,true)-0.5;
}function aa(ao){return X(ao);
}function S(at,ap,aq,ao){if(ao){return 0.5+0.5*w((Math.log(at)-ap)/(aq*Math.sqrt(2)));
}var ar=Math.log(at)-ap;
return Math.exp(-ar*ar/(2*aq*aq))/(at*aq*Math.sqrt(2*Math.PI));
}function T(ap,ao,aq){return Math.exp(W(ap,ao,aq));
}function ac(ax,ar,ap,av){var aq=ax.length;
var au=0,ao;
for(ao=0;
ao<aq;
ao++){if(ar[ao]<=0||ar[ao]>1){throw new m("NUM");
}au+=ar[ao];
}if(au!=1){throw new m("NUM");
}var at=0;
for(ao=0;
ao<aq;
ao++){var aw=ax[ao];
if(aw>=ap&&aw<=av){at+=ar[ao];
}}return at;
}function af(ax,aw){var ar=a(aw),at=a(ax),ao=0,ap=0;
for(var aq=0,au=ax.length;
aq<au;
aq++){var av=aw[aq]-ar;
ao+=av*(ax[aq]-at);
ap+=av*av;
}return ao/ap;
}function R(ax,aw){var ar=a(aw),at=a(ax);
var ao=0,ap=0;
for(var aq=0,au=ax.length;
aq<au;
aq++){var av=aw[aq]-ar;
ao+=av*(ax[aq]-at);
ap+=av*av;
}return at-ao*ar/ap;
}function Z(ay,az){var ap=a(ay),aq=a(az);
var at=0,au=0,av=0;
for(var ao=0,ar=ay.length;
ao<ar;
ao++){var aw=ay[ao]-ap,ax=az[ao]-aq;
at+=aw*ax;
au+=aw*aw;
av+=ax*ax;
}return at/Math.sqrt(au*av);
}function ad(ap,aq){var ao=Z(ap,aq);
return ao*ao;
}function ah(az,ay){var ar=ay.length;
var ap=a(ay),aq=a(az);
var at=0,au=0,av=0;
for(var ao=0;
ao<ar;
ao++){var aw=ay[ao]-ap,ax=az[ao]-aq;
at+=ax*ax;
au+=aw*ax;
av+=aw*aw;
}return Math.sqrt((at-au*au/av)/(ar-2));
}function G(az,aB,aA){var ar=a(aA),at=a(aB);
var av=0,aw=0;
for(var aq=0,au=aA.length;
aq<au;
aq++){var ax=aA[aq]-ar,ay=aB[aq]-at;
av+=ax*ay;
aw+=ax*ax;
}if(aw===0){throw new m("N/A");
}var ap=av/aw,ao=at-ap*ar;
return ao+ap*az;
}})();
(function(){(function(d){var a=d.jQuery;
var b=["allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders"];
var c=d.ui.Widget.extend({init:function(e,f){d.ui.Widget.call(this,e,f);
this.element=e;
this.color="#000";
this.element.addClass("k-spreadsheet-border-palette");
this._borderTypePalette();
this._borderColorPalette();
this.element.on("click",".k-spreadsheet-border-type-palette .k-button",this._click.bind(this));
},options:{name:"BorderPalette"},events:["change"],_borderTypePalette:function(){var e=b.map(function(g){return'<a href="#" data-border-type="'+g+'" class="k-button k-button-icon"><span class="k-sprite k-font-icon k-icon k-i-'+d.toHyphens(g)+'">'+g.replace(/([A-Z])/g," $1").toLowerCase()+"</span></a>";
}).join("");
var f=a("<div />",{"class":"k-spreadsheet-border-type-palette",html:e});
f.appendTo(this.element);
},_borderColorPalette:function(){var f=a("<div />",{"class":"k-spreadsheet-border-style-palette"});
var e=this.colorPalette=a("<div />").kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],value:this.color,change:this._colorChange.bind(this)}).data("kendoColorPalette");
f.append(e.wrapper).appendTo(this.element);
},_colorChange:function(f){this.color=f.value;
if(this.type){this.trigger("change",{type:this.type,color:this.color});
}},_click:function(f){this.type=a(f.currentTarget).data("borderType");
this.trigger("change",{type:this.type,color:this.color});
},destroy:function(){this.colorPalette.destroy();
this.element.off("click");
}});
d.spreadsheet.BorderPalette=c;
})(window.kendo);
})();
(function(){(function(t){var a=t.jQuery;
var B=t.ui.ToolBar;
var j={home:[["cut","copy","paste"],["bold","italic","underline"],"backgroundColor","textColor","borders","fontSize","fontFamily","alignment","textWrap",["formatDecreaseDecimal","formatIncreaseDecimal"],"format","merge","filter"],insert:[["addColumnLeft","addColumnRight","addRowBelow","addRowAbove"],["deleteColumn","deleteRow"]],data:["sort","filter","validation"]};
var C={bold:{type:"button",command:"PropertyChangeCommand",property:"bold",value:true,iconClass:"bold",togglable:true},italic:{type:"button",command:"PropertyChangeCommand",property:"italic",value:true,iconClass:"italic",togglable:true},underline:{type:"button",command:"PropertyChangeCommand",property:"underline",value:true,iconClass:"underline",togglable:true},formatDecreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:-1,iconClass:"decrease-decimal"},formatIncreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:+1,iconClass:"increase-decimal"},textWrap:{type:"button",command:"TextWrapCommand",property:"wrap",value:true,iconClass:"text-wrap",togglable:true},cut:{type:"button",command:"CutCommand",iconClass:"cut"},copy:{type:"button",command:"CopyCommand",iconClass:"copy"},paste:{type:"button",command:"PasteCommand",iconClass:"paste"},filter:{type:"button",command:"FilterCommand",property:"hasFilter",iconClass:"filter",togglable:true},separator:{type:"separator"},alignment:{type:"alignment",iconClass:"justify-left"},backgroundColor:{type:"colorPicker",property:"background",iconClass:"background"},textColor:{type:"colorPicker",property:"color",iconClass:"text"},fontFamily:{type:"fontFamily",property:"fontFamily",iconClass:"text",width:130},fontSize:{type:"fontSize",property:"fontSize",iconClass:"font-size",width:60},format:{type:"format",property:"format",width:100,iconClass:"format-number"},merge:{type:"merge",iconClass:"merge-cells"},borders:{type:"borders",iconClass:"all-borders"},formatCells:{type:"dialog",dialogName:"formatCells",overflow:"never"},addColumnLeft:{type:"button",command:"AddColumnCommand",value:"left",iconClass:"add-column-left"},addColumnRight:{type:"button",command:"AddColumnCommand",value:"right",iconClass:"add-column-right"},addRowBelow:{type:"button",command:"AddRowCommand",value:"below",iconClass:"add-row-below"},addRowAbove:{type:"button",command:"AddRowCommand",value:"above",iconClass:"add-row-above"},deleteColumn:{type:"button",command:"DeleteColumnCommand",iconClass:"delete-column"},deleteRow:{type:"button",command:"DeleteRowCommand",iconClass:"delete-row"},sort:{type:"sort",iconClass:"sort-desc"},validation:{type:"dialog",dialogName:"validation",iconClass:"exception",overflow:"never"}};
var A=B.extend({init:function(D,F){F.items=this._expandTools(F.tools||A.prototype.options.tools[F.toolbarName]);
B.fn.init.call(this,D,F);
var E=this._click.bind(this);
this.element.addClass("k-spreadsheet-toolbar");
this.bind({click:E,toggle:E});
},_expandTools:function(F){var E=this.options.messages;
function D(J){var G=a.isPlainObject(J)?J:C[J]||{};
var H="k-icon k-font-icon k-i-"+G.iconClass;
var K=G.type;
var L={splitButton:{spriteCssClass:H},button:{showText:"overflow"},colorPicker:{toolIcon:H}};
var I=a.extend({name:G.name||J,text:E[G.name||J],spriteCssClass:H,attributes:{title:E[G.name||J]}},L[K],G);
if(K=="splitButton"){I.menuButtons=I.menuButtons.map(D);
}I.attributes["data-tool"]=J;
if(G.property){I.attributes["data-property"]=G.property;
}return I;
}return F.reduce(function(H,G){if(a.isArray(G)){H.push({type:"buttonGroup",buttons:G.map(D)});
}else{H.push(D.call(this,G));
}return H;
},[]);
},_click:function(F){var H=F.target.attr("data-tool");
var G=C[H]||{};
var E=G.command;
if(!E){return;
}var D={command:E,options:{property:G.property||null,value:G.value||null}};
if(typeof D.options.value==="boolean"){D.options.value=F.checked?true:null;
}this.action(D);
},events:["click","toggle","open","close","overflowOpen","overflowClose","action","dialog"],options:{name:"SpreadsheetToolBar",resizable:true,tools:j,messages:{bold:"Bold",italic:"Italic",underline:"Underline",alignment:"Alignment",merge:"Merge cells",filter:"Filter",format:"Custom format...",formatDecreaseDecimal:"Decrease decimal",formatIncreaseDecimal:"Increase decimal",textWrap:"Wrap text",fontFamily:"Font",fontSize:"Font size",borders:"Borders",textColor:"Text Color",backgroundColor:"Background",cut:"Cut",copy:"Copy",paste:"Paste",addColumnLeft:"Add column left",addColumnRight:"Add column right",addRowBelow:"Add row below",addRowAbove:"Add row above",deleteColumn:"Delete column",deleteRow:"Delete row",sortAsc:"Sort ascending",sortDesc:"Sort descending",validation:"Data validation..."}},action:function(D){this.trigger("action",D);
},dialog:function(D){this.trigger("dialog",D);
},refresh:function(D){var G=D;
var J=this._tools();
function H(P,R){var Q=P.toolbar;
var M=P.overflow;
var N=(Q&&Q.options.togglable)||(M&&M.options.togglable);
if(!N){return;
}var O=false;
if(typeof R==="boolean"){O=R;
}else{if(typeof R==="string"){O=Q.options.value===R;
}}Q.toggle(O);
if(M){M.toggle(O);
}}function K(N,P){var O=N.toolbar;
var M=N.overflow;
if(O&&O.update){O.update(P);
}if(M&&M.update){M.update(P);
}}for(var E=0;
E<J.length;
E++){var F=J[E].property;
var I=J[E].tool;
var L=t.isFunction(G[F])?G[F]():G;
if(I.type==="button"){H(I,L);
}else{K(I,L);
}}},_tools:function(){return this.element.find("[data-property]").toArray().reduce(function(F,D){D=a(D);
var E=D.attr("data-property");
F.push({property:E,tool:this._getItem(D)});
return F;
}.bind(this),[]);
},destroy:function(){this.element.find("[data-command],.k-button").each(function(){var D=a(this);
var E=D.data("instance");
if(E&&E.destroy){E.destroy();
}});
B.fn.destroy.call(this);
}});
var k=t.toolbar.Item.extend({init:function(E,F){var D=a("<select />").kendoDropDownList({height:"auto"}).data("kendoDropDownList");
this.dropDownList=D;
this.element=D.wrapper;
this.options=E;
this.toolbar=F;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
D.bind("open",this._open.bind(this));
D.bind("change",this._change.bind(this));
this.element.width(E.width).attr({"data-command":"PropertyChangeCommand","data-property":E.property});
},_open:function(){var D=this.dropDownList;
var E=D.list;
var F;
E.css({whiteSpace:"nowrap",width:"auto"});
F=E.width();
if(F){F+=20;
}else{F=D._listWidth;
}E.css("width",F+t.support.scrollbar());
D._listWidth=F;
},_change:function(E){var F=E.sender;
var H=F.value();
var D=F.dataItem();
var G=D?D.popup:undefined;
if(G){this.toolbar.dialog({name:G});
}else{this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:H=="null"?null:H}});
}},value:function(D){if(D!==undefined){this.dropDownList.value(D);
}else{return this.dropDownList.value();
}}});
var x=t.toolbar.Item.extend({init:function(D,E){this.element=a("<a href='#' class='k-button k-button-icon'><span class='"+D.spriteCssClass+"'></span><span class='k-font-icon k-icon k-i-arrow-s'></span></a>");
this.element.on("click",this.open.bind(this)).attr("data-command",D.command);
this.options=D;
this.toolbar=E;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this._popup();
},destroy:function(){this.popup.destroy();
},open:function(){this.popup.toggle();
},_popup:function(){var D=this.element;
this.popup=a("<div class='k-spreadsheet-popup' />").appendTo(D).kendoPopup({anchor:D}).data("kendoPopup");
}});
t.toolbar.registerComponent("dialog",t.toolbar.ToolBarButton.extend({init:function(D,E){t.toolbar.ToolBarButton.fn.init.call(this,D,E);
this._dialogName=D.dialogName;
this.element.bind("click",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
var w=t.toolbar.OverflowButton.extend({init:function(E,F){t.toolbar.OverflowButton.fn.init.call(this,E,F);
this.element.on("click",this._click.bind(this));
this.message=this.options.text;
var D=this.element.data("button");
this.element.data(this.options.type,D);
},_click:a.noop});
var f=x.extend({init:function(D,E){x.fn.init.call(this,D,E);
this._colorPalette();
this.element.attr({"data-property":D.property});
this.element.data({type:"colorPicker",colorPicker:this,instance:this});
},destroy:function(){this.colorPalette.destroy();
x.fn.destroy.call(this);
},update:function(D){this.value(D);
},value:function(D){if(D!==undefined){this.colorPalette.value(D);
}else{return this.colorPalette.value();
}},_colorPalette:function(){var D=a("<div />").appendTo(this.popup.element);
this.colorPalette=D.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this._colorChange.bind(this)}).data("kendoColorPalette");
},_colorChange:function(D){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:D.sender.value()}});
this.popup.close();
}});
var g=w.extend({init:function(D,E){D.iconName="text";
w.fn.init.call(this,D,E);
},_click:function(){this.toolbar.dialog({name:"colorPicker",options:{title:this.options.property,property:this.options.property}});
}});
t.toolbar.registerComponent("colorPicker",f,g);
var m=[8,9,10,11,12,13,14,16,18,20,22,24,26,28,36,48,72];
var i=12;
var p=t.toolbar.Item.extend({init:function(E,F){var D=a("<input />").kendoComboBox({change:this._valueChange.bind(this),dataSource:E.fontSizes||m,value:i}).data("kendoComboBox");
this.comboBox=D;
this.element=D.wrapper;
this.options=E;
this.toolbar=F;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this.element.width(E.width).attr({"data-command":"PropertyChangeCommand","data-property":E.property});
this.element.data({type:"fontSize",fontSize:this});
},_valueChange:function(D){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:t.parseInt(D.sender.value())}});
},update:function(D){this.value(t.parseInt(D)||i);
},value:function(D){if(D!==undefined){this.comboBox.value(D);
}else{return this.comboBox.value();
}}});
var q=w.extend({_click:function(){this.toolbar.dialog({name:"fontSize",options:{sizes:m,defaultSize:i}});
},update:function(D){this._value=D||i;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
t.toolbar.registerComponent("fontSize",p,q);
var l=["Arial","Courier New","Georgia","Times New Roman","Trebuchet MS","Verdana"];
var h="Arial";
var n=k.extend({init:function(E,F){k.fn.init.call(this,E,F);
var D=this.dropDownList;
D.setDataSource(E.fontFamilies||l);
D.value(h);
this.element.data({type:"fontFamily",fontFamily:this});
},update:function(D){this.value(D||h);
}});
var o=w.extend({_click:function(){this.toolbar.dialog({name:"fontFamily",options:{fonts:l,defaultFont:h}});
},update:function(D){this._value=D||h;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
t.toolbar.registerComponent("fontFamily",n,o);
var r=k.extend({_revertTitle:function(D){D.sender.value("");
D.sender.wrapper.width("auto");
},init:function(E,F){k.fn.init.call(this,E,F);
var D=this.dropDownList;
D.bind("change",this._revertTitle.bind(this));
D.bind("dataBound",this._revertTitle.bind(this));
D.setOptions({dataValueField:"format",dataValuePrimitive:true,valueTemplate:"<span class='k-icon k-font-icon k-i-"+E.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>",template:"# if (data.sample) { #<span class='k-spreadsheet-sample'>#: data.sample #</span># } ##: data.name #"});
D.setDataSource([{format:null,name:"Automatic"},{format:"0",name:"Number",sample:"1,499.99"},{format:"0.00%",name:"Percent",sample:"14.50%"},{format:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',name:"Financial",sample:"(1,000.12)"},{format:"$#,##0.00;[Red]$#,##0.00",name:"Currency",sample:"$1,499.99"},{format:"m/d/yyyy",name:"Date",sample:"4/21/2012"},{format:"h:mm:ss AM/PM",name:"Time",sample:"5:49:00 PM"},{format:"m/d/yyyy h:mm",name:"Date time",sample:"4/21/2012 5:49:00"},{format:"[h]:mm:ss",name:"Duration",sample:"168:05:00"},{popup:"formatCells",name:"More formats..."}]);
this.element.data({type:"format",format:this});
}});
var s=w.extend({_click:function(){this.toolbar.dialog({name:"formatCells"});
}});
t.toolbar.registerComponent("format",r,s);
var e=x.extend({init:function(D,E){x.fn.init.call(this,D,E);
this._borderPalette();
this.element.data({type:"borders",instance:this});
},destroy:function(){this.borderPalette.destroy();
x.fn.destroy.call(this);
},_borderPalette:function(){var D=a("<div />").appendTo(this.popup.element);
this.borderPalette=new t.spreadsheet.BorderPalette(D,{change:this._action.bind(this)});
},_action:function(D){this.toolbar.action({command:"BorderChangeCommand",options:{border:D.type,style:{size:"1px",color:D.color}}});
}});
var d=w.extend({_click:function(){this.toolbar.dialog({name:"borders"});
}});
t.toolbar.registerComponent("borders",e,d);
var c=x.extend({init:function(D,E){x.fn.init.call(this,D,E);
this.element.attr({"data-property":"alignment"});
this._commandPalette();
this.popup.element.on("click",".k-button",function(F){this._action(a(F.currentTarget));
}.bind(this));
this.element.data({type:"alignment",alignment:this,instance:this});
},buttons:[{property:"textAlign",value:"left",iconClass:"justify-left"},{property:"textAlign",value:"center",iconClass:"justify-center"},{property:"textAlign",value:"right",iconClass:"justify-right"},{property:"textAlign",value:"justify",iconClass:"justify-full"},{property:"verticalAlign",value:"top",iconClass:"align-top"},{property:"verticalAlign",value:"middle",iconClass:"align-middle"},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom"}],destroy:function(){this.popup.element.off();
x.fn.destroy.call(this);
},update:function(D){var E=D.textAlign();
var F=D.verticalAlign();
this.popup.element.find(".k-button").removeClass("k-state-active");
if(E){this.popup.element.find(".k-button[data-value="+E+"]").addClass("k-state-active");
}if(F){this.popup.element.find(".k-button[data-value="+F+"]").addClass("k-state-active");
}},_commandPalette:function(){var D=this.buttons;
var E=a("<div />").appendTo(this.popup.element);
D.forEach(function(H,G){var F="<a title='Align "+H.value+"' data-property='"+H.property+"' data-value='"+H.value+"' class='k-button k-button-icon'><span class='k-icon k-font-icon k-i-"+H.iconClass+"'></span></a>";
if(G!==0&&D[G-1].property!==H.property){E.append(a("<span class='k-separator' />"));
}E.append(F);
});
},_action:function(D){var E=D.attr("data-property");
var F=D.attr("data-value");
this.toolbar.action({command:"PropertyChangeCommand",options:{property:E,value:F}});
}});
var b=w.extend({_click:function(){this.toolbar.dialog({name:"alignment"});
}});
t.toolbar.registerComponent("alignment",c,b);
var v=x.extend({init:function(D,E){x.fn.init.call(this,D,E);
this._commandPalette();
this.popup.element.on("click",".k-button",function(F){this._action(a(F.currentTarget));
}.bind(this));
this.element.data({type:"merge",merge:this,instance:this});
},buttons:[{value:"cells",iconClass:"merge-cells"},{value:"horizontally",iconClass:"merge-horizontally"},{value:"vertically",iconClass:"merge-vertically"},{value:"unmerge",iconClass:"normal-layout"}],destroy:function(){this.popup.element.off();
x.fn.destroy.call(this);
},_commandPalette:function(){var D=a("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(F){var G=F.value==="unmerge"?"Unmerge":"Merge "+F.value;
var E="<a title='"+G+"' data-value='"+F.value+"' class='k-button k-button-icontext'><span class='k-icon k-font-icon k-i-"+F.iconClass+"'></span>"+G+"</a>";
D.append(E);
});
},_action:function(D){var E=D.attr("data-value");
this.toolbar.action({command:"MergeCellCommand",options:{value:E}});
}});
var u=w.extend({_click:function(){this.toolbar.dialog({name:"merge"});
}});
t.toolbar.registerComponent("merge",v,u);
var y=k.extend({_revertTitle:function(D){D.sender.value("");
D.sender.wrapper.width("auto");
},init:function(E,F){k.fn.init.call(this,E,F);
var D=this.dropDownList;
D.bind("change",this._revertTitle.bind(this));
D.bind("dataBound",this._revertTitle.bind(this));
D.setOptions({valueTemplate:"<span class='k-icon k-font-icon k-i-"+E.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>",template:"<span class='k-icon k-font-icon k-i-"+E.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>#=text#",dataValueField:"value"});
D.setDataSource([{value:1,sheet:true,asc:true,text:"Sort sheet A to Z",iconClass:"sort-asc"},{value:2,sheet:true,asc:false,text:"Sort sheet Z to A",iconClass:"sort-desc"},{value:3,sheet:false,asc:true,text:"Sort range A to Z",iconClass:"sort-asc"},{value:4,sheet:false,asc:false,text:"Sort range Z to A",iconClass:"sort-desc"}]);
this.element.data({type:"sort",sort:this});
},_change:function(E){var F=E.sender;
var D=F.dataItem();
this.toolbar.action({command:"SortCommand",options:{asc:D.asc,sheet:D.sheet}});
},value:a.noop});
var z=w.extend({_click:function(){this.toolbar.dialog({name:"sort"});
}});
t.toolbar.registerComponent("sort",y,z);
t.spreadsheet.ToolBar=A;
t.spreadsheet.TabStrip=t.ui.TabStrip.extend({init:function(D,E){t.ui.TabStrip.fn.init.call(this,D,E);
D.addClass("k-spreadsheet-tabstrip");
this._quickAccessButtons();
this.quickAccessToolBar.on("click",".k-button",function(H){var G=a(H.currentTarget).attr("title").toLowerCase();
this.trigger("action",{action:G});
}.bind(this));
this.toolbars={};
var F=E.dataSource;
this.contentElements.each(function(H,G){this._toolbar(a(G),F[H].id,E.toolbarOptions[F[H].id]);
}.bind(this));
},events:t.ui.TabStrip.fn.events.concat(["action","dialog"]),destroy:function(){this.quickAccessToolBar.off("click");
t.ui.TabStrip.fn.destroy.call(this);
for(var D in this.toolbars){this.toolbars[D].destroy();
}},action:function(D){this.trigger("action",D);
},dialog:function(D){this.trigger("dialog",D);
},refreshTools:function(E){var F=this.toolbars;
for(var D in F){if(F.hasOwnProperty(D)){F[D].refresh(E);
}}},_quickAccessButtons:function(){var D=[{title:"Undo",iconClass:"undo-large",action:"undo"},{title:"Redo",iconClass:"redo-large",action:"redo"}];
var E=t.template("<a href='\\#' title='#= title #' class='k-button k-button-icon'><span class='k-icon k-font-icon k-i-#=iconClass#'></span></a>");
this.quickAccessToolBar=a("<div />",{"class":"k-spreadsheet-quick-access-toolbar",html:t.render(E,D)}).insertBefore(this.wrapper);
this.quickAccessToolBar.on("click",".k-button",function(G){var F=a(G.currentTarget).attr("title").toLowerCase();
this.action({action:F});
}.bind(this));
this.tabGroup.css("padding-left",this.quickAccessToolBar.outerWidth());
},_toolbar:function(D,F,H){var E;
var G;
if(this.toolbars[F]){this.toolbars[F].destroy();
D.children(".k-toolbar").remove();
}if(H){E=D.html("<div />").children("div");
G={tools:typeof H==="boolean"?undefined:H,toolbarName:F,action:this.action.bind(this),dialog:this.dialog.bind(this)};
this.toolbars[F]=new t.spreadsheet.ToolBar(E,G);
}}});
})(window.kendo);
})();
(function(){(function(j){var a=j.jQuery;
var m=j.data.ObservableObject;
var n={};
j.spreadsheet.dialogs={register:function(t,s){n[t]=s;
},create:function(t,u){var s=n[t];
if(s){return new s(u);
}}};
var o=j.spreadsheet.SpreadsheetDialog=j.Observable.extend({init:function(s){j.Observable.fn.init.call(this,s);
this.options=a.extend(true,{},this.options,s);
},dialog:function(){if(!this._dialog){this._dialog=a("<div class='k-spreadsheet-window k-action-window' />").addClass(this.options.className||"").append(this.options.template).appendTo(document.body).kendoWindow({scrollable:false,resizable:false,maximizable:false,modal:true,visible:false,width:this.options.width||320,title:this.options.title,open:function(){this.center();
},deactivate:function(){this._dialog.destroy();
this._dialog=null;
}.bind(this)}).data("kendoWindow");
}return this._dialog;
},destroy:function(){if(this._dialog){this._dialog.destroy();
this._dialog=null;
}},open:function(){this.dialog().open();
},apply:function(){this.close();
},close:function(){this.dialog().close();
}});
function i(u,t){var s=j.spreadsheet.formatting.format(u,t);
return s.children[0].nodeValue;
}var h=j.spreadsheet.FormatCellsViewModel=m.extend({init:function(s){m.fn.init.call(this,s);
this.useCategory(this.category);
},useCategory:function(s){var u=s&&s.type||"number";
var t=u=="currency";
this.category=s;
this.set("showCurrencyFilter",t&&this.currencies.length>1);
if(!t){this.set("formats",this.allFormats[u+"Formats"]);
}else{this.currency(this.currencies[0]);
}this.useFirstFormat();
},useFirstFormat:function(){if(this.formats.length){this.set("format",this.formats[0].value);
}},currency:function(s){if(s!==undefined){this._currency=s;
var u=s.value;
var t=[{currency:u,decimals:true},{currency:u,decimals:true,iso:true},{currency:u,decimals:false}];
t=t.map(function(v){v=h.convert.currency(v);
return{value:v,name:i(1000,v)};
});
this.set("formats",t);
this.useFirstFormat();
}return this._currency||this.currencies[0];
},categoryFilter:function(s){if(s!==undefined){this.useCategory(s);
}return this.category;
},preview:function(){var s=this.get("format");
var t=this.value||0;
if(s&&s.length){return i(t,s);
}else{return t;
}}});
h.convert={currency:function(u){function v(x,w){return new Array(w+1).join(x);
}var t=u.currency;
var s=t.pattern[1];
if(u.decimals){s=s.replace(/n/g,"n"+t["."]+v("0",t.decimals));
}if(u.iso){s='"'+t.abbr+'" '+s.replace(/\s*\$\s*/g,"");
}else{s=s.replace(/\$/g,t.symbol);
}s=s.replace(/n/g,"?");
return s;
},date:function(s){if((/T|Z/).test(s)){return"";
}return s.toLowerCase().replace(/tt/g,"AM/PM").replace(/'/g,'"');
}};
function p(t,s){var v=[];
var w=[];
for(var u=0;
u<s.length;
u++){if(a.inArray(s[u][t],w)==-1){v.push(s[u]);
w.push(s[u][t]);
}}return v;
}var g=o.extend({init:function(s){o.fn.init.call(this,s);
this._generateFormats();
},options:{title:"Format number",className:"k-spreadsheet-format-cells",categories:[{type:"number",name:"Number"},{type:"currency",name:"Currency"},{type:"date",name:"Date"}],template:"<div class='k-root-tabs' data-role='tabstrip' data-text-field='name' data-bind='source: categories, value: categoryFilter' data-animation='false' /><div class='k-spreadsheet-preview' data-bind='text: preview' /><script type='text/x-kendo-template' id='format-item-template'>#: data.name #</script><select data-role='dropdownlist' class='k-format-filter' data-text-field='description' data-value-field='value.name' data-bind='visible: showCurrencyFilter, value: currency, source: currencies' /><ul data-role='staticlist' tabindex='0' class='k-list k-reset' data-template='format-item-template' data-value-primitive='true' data-value-field='value' data-bind='source: formats, value: format' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>Apply</button><button class='k-button' data-bind='click: close'>Cancel</button></div>"},_generateFormats:function(){var t=this.options;
if(!t.currencies){t.currencies=g.currenciesFrom(j.cultures);
}if(!t.numberFormats){t.numberFormats=[{value:"#.00%",name:"100.00%"},{value:"#%",name:"100%"},{value:"#.00",name:"1024.00"},{value:"#,###.00",name:"1,024.00"}];
}if(!t.dateFormats){var s=j.cultures.current.calendars.standard.patterns;
t.dateFormats=p("value",a.map(s,function(u){u=h.convert.date(u);
if(!u){return;
}return{value:u,name:i(34567.7678,u)};
}));
}},open:function(w){var v=this.options;
var x=w.value();
var s=v.categories.slice(0);
var u;
this.viewModel=new h({currencies:v.currencies.slice(0),allFormats:{numberFormats:v.numberFormats.slice(0),dateFormats:v.dateFormats.slice(0)},categories:s,format:w.format(),category:x instanceof Date?s[2]:s[0],apply:this.apply.bind(this),close:this.close.bind(this),value:x});
o.fn.open.call(this);
u=this.dialog().element;
j.bind(u,this.viewModel);
var t=u.find("select.k-format-filter").data("kendoDropDownList");
if(v.currencies.length>10){t.setOptions({filter:"contains"});
}u.find(j.roleSelector("staticlist")).parent().addClass("k-list-wrapper");
},apply:function(){var s=this.viewModel.format;
o.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"format",value:s}});
}});
g.currenciesFrom=function(s){return p("description",a.map(s,function(t,w){if(!(/-/).test(w)){return;
}var u=t.numberFormat.currency;
var v=j.format("{0} ({1}, {2})",u.name,u.abbr,u.symbol);
return{description:v,value:u};
}));
};
j.spreadsheet.dialogs.register("formatCells",g);
j.spreadsheet.dialogs.FormatCellsDialog=g;
var l=o.extend({options:{className:"k-spreadsheet-message",title:"",text:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: close, text: okText' /></div>"},open:function(){o.fn.open.call(this);
j.bind(this.dialog().element,{text:this.options.text,okText:"OK",close:this.close.bind(this)});
}});
j.spreadsheet.dialogs.register("message",l);
var e=o.extend({init:function(s){o.fn.init.call(this,s);
this._list();
},options:{title:"Font",template:"<ul class='k-list k-reset'></ul>"},_list:function(){var u=this.dialog().element.find("ul");
var t=this.options.fonts;
var s=this.options.defaultFont;
this.list=new j.ui.StaticList(u,{dataSource:new j.data.DataSource({data:t}),template:"#:data#",value:s,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(s){o.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontFamily",value:s.sender.value()[0]}});
}});
j.spreadsheet.dialogs.register("fontFamily",e);
var f=o.extend({init:function(s){o.fn.init.call(this,s);
this._list();
},options:{title:"Font Size",template:"<ul class='k-list k-reset'></ul>"},_list:function(){var u=this.dialog().element.find("ul");
var t=this.options.sizes;
var s=this.options.defaultSize;
this.list=new j.ui.StaticList(u,{dataSource:new j.data.DataSource({data:t}),template:"#:data#",value:s,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(s){o.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontSize",value:j.parseInt(s.sender.value()[0])}});
}});
j.spreadsheet.dialogs.register("fontSize",f);
var c=o.extend({init:function(s){o.fn.init.call(this,s);
this.element=this.dialog().element;
this._borderPalette();
this.viewModel=j.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
j.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{title:"Borders",width:177,template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>Apply</button><button class='k-button' data-bind='click: close'>Cancel</button></div>"},apply:function(){o.fn.apply.call(this);
var s=this.value();
this.trigger("action",{command:"BorderChangeCommand",options:{border:s.type,style:{size:"1px",color:s.color}}});
},_borderPalette:function(){var s=this.dialog().element.find("div:first");
this.borderPalette=new j.spreadsheet.BorderPalette(s,{change:this.value.bind(this)});
},value:function(s){if(s===undefined){return this._state;
}else{this._state=s;
}}});
j.spreadsheet.dialogs.register("borders",c);
var d=o.extend({init:function(s){o.fn.init.call(this,s);
this.element=this.dialog().element;
this._colorPalette();
this.property=s.property;
this.options.title=s.title;
this.viewModel=j.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
j.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{width:177,template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>Apply</button><button class='k-button' data-bind='click: close'>Cancel</button></div>"},apply:function(){o.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:this.property,value:this.value()}});
},_colorPalette:function(){var s=this.dialog().element.find("div:first");
this.colorPalette=s.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this.value.bind(this)}).data("kendoColorPalette");
},value:function(s){if(s===undefined){return this._value;
}else{this._value=s.value;
}}});
j.spreadsheet.dialogs.register("colorPicker",d);
var b=o.extend({init:function(s){o.fn.init.call(this,s);
this._list();
},options:{title:"Alignment",template:"<ul class='k-list k-reset'></ul>",buttons:[{property:"textAlign",value:"left",iconClass:"justify-left"},{property:"textAlign",value:"center",iconClass:"justify-center"},{property:"textAlign",value:"right",iconClass:"justify-right"},{property:"textAlign",value:"justify",iconClass:"justify-full"},{property:"verticalAlign",value:"top",iconClass:"align-top"},{property:"verticalAlign",value:"middle",iconClass:"align-middle"},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom"}]},_list:function(){var s=this.dialog().element.find("ul");
this.list=new j.ui.StaticList(s,{dataSource:new j.data.DataSource({data:this.options.buttons}),template:"<a title='Align #=value#' data-property='#=property#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>Align #=value#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(t){var s=t.sender.value()[0];
o.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:s.property,value:s.value}});
}});
j.spreadsheet.dialogs.register("alignment",b);
var k=o.extend({init:function(s){o.fn.init.call(this,s);
this._list();
},options:{title:"Merge cells",template:"<ul class='k-list k-reset'></ul>",buttons:[{value:"cells",iconClass:"merge-cells"},{value:"horizontally",iconClass:"merge-horizontally"},{value:"vertically",iconClass:"merge-vertically"},{value:"unmerge",iconClass:"normal-layout"}]},_list:function(){var s=this.dialog().element.find("ul");
this.list=new j.ui.StaticList(s,{dataSource:new j.data.DataSource({data:this.options.buttons}),template:function(t){var u=t.value==="unmerge"?"Unmerge":"Merge "+t.value;
return"<a title='"+u+"' data-value="+t.value+"><span class='k-icon k-font-icon k-i-"+t.iconClass+"'></span>"+u+"</a>";
},change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(t){var s=t.sender.value()[0];
o.fn.apply.call(this);
this.trigger("action",{command:"MergeCellCommand",options:{value:s.value}});
}});
j.spreadsheet.dialogs.register("merge",k);
var r=j.spreadsheet.ValidationCellsViewModel=m.extend({init:function(s){m.fn.init.call(this,s);
this.bind("change",(function(t){if(t.field==="criterion"){this.clear();
}}).bind(this));
this._init();
},_init:function(){this.number={};
this.text={};
this.date={};
this.custom={};
this.clear();
},clear:function(){this.set("number.comparer","greaterThan");
this.set("number.from",null);
this.set("number.to",null);
this.set("text.comparer","greaterThan");
this.set("text.from",null);
this.set("date.comparer","greaterThan");
this.set("date.from",null);
this.set("date.to",null);
this.set("custom.from",null);
},isNumber:function(){return this.get("criterion")==="number";
},isText:function(){return this.get("criterion")==="text";
},isDate:function(){return this.get("criterion")==="date";
},isCustom:function(){return this.get("criterion")==="custom";
},showRemove:function(){return this.get("hasValidation");
},reset:function(){this.set("criterion","any");
},update:function(t){this.set("hasValidation",!!t);
if(t){var s=this[t.dataType||"text"];
s.comparer=t.comparerType;
s.from=t.from;
s.to=t.to;
this.criterion=t.dataType;
this.type=t.type;
}},toValidationObject:function(){var t=this.criterion;
var s=this[t];
if(!s){return null;
}return{type:this.type,dataType:t!=="custom"?t:"",comparerType:s.comparer,from:s.from,to:s.to};
}});
var q=o.extend({init:function(s){o.fn.init.call(this,s);
},options:{width:420,title:"Data Validation",criterion:"any",type:"reject",hint:"Please enter message!",criteria:[{type:"any",name:"Any value"},{type:"number",name:"Number"},{type:"text",name:"Text"},{type:"date",name:"Date"},{type:"custom",name:"Custom Formula"}],comparers:[{type:"greaterThan",name:"greater than"},{type:"lessThan",name:"less than"},{type:"between",name:"between"},{type:"notBetween",name:"not between"},{type:"equalTo",name:"equal to"},{type:"notEqualTo",name:"not equal to"},{type:"greaterThanOrEqualTo",name:"greater than or equal to"},{type:"lessThanOrEqualTo",name:"less than or equal to"}],template:'<div class="k-edit-form-container"><div class="k-edit-label"><label>Criteria:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: criterion, source: criteria" /></div><div data-bind="visible: isNumber"><div class="k-edit-label"><label>Data:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: number.comparer, source: comparers" /></div><div class="k-edit-label"><label>Min:</label></div><div class="k-edit-field"><input placeholder="e.g. 10" class="k-textbox" data-bind="value: number.from" /></div><div class="k-edit-label"><label>Max:</label></div><div class="k-edit-field"><input placeholder="e.g. 100" class="k-textbox" data-bind="value: number.to" /></div></div><div data-bind="visible: isText"><div class="k-edit-label"><label>Data:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: text.comparer, source: comparers" /></div><div class="k-edit-label"><label>Value:</label></div><div class="k-edit-field"><input class="k-textbox" data-bind="value: text.from" /></div></div><div data-bind="visible: isDate"><div class="k-edit-label"><label>Data:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: text.comparer, source: comparers" /></div><div class="k-edit-label"><label>Start:</label></div><div class="k-edit-field"><input class="k-textbox" data-bind="value: date.from" /></div><div class="k-edit-label"><label>End:</label></div><div class="k-edit-field"><input class="k-textbox" data-bind="value: date.to" /></div></div><div data-bind="visible: isCustom"><div class="k-edit-label"><label>Value:</label></div><div class="k-edit-field"><input class="k-textbox" data-bind="value: custom.from" /></div></div><div class="k-edit-label"><label>On invalid data:</label></div><div class="k-edit-field"><input type="radio" name="validationType" value="reject" data-bind="checked: type" />Reject input</div><div class="k-edit-field"><input type="radio" name="validationType" value="warning" data-bind="checked: type" />Show warning</div><div class="k-edit-label"><label>Hint message:</label></div><div class="k-edit-field"><input class="k-textbox" placeholder="Type message" data-bind="value: hint" /></div><div class="k-action-buttons"><button class="k-button" data-bind="visible: showRemove, click: remove">Remove</button><button class="k-button k-primary" data-bind="click: apply">Apply</button><button class="k-button" data-bind="click: close">Cancel</button></div></div>'},open:function(u){var t=this.options;
var s;
this.viewModel=new r({type:t.type,hint:t.hint,comparers:t.comparers.slice(0),criteria:t.criteria.slice(0),criterion:t.criterion,apply:this.apply.bind(this),close:this.close.bind(this),remove:this.remove.bind(this)});
this.viewModel.update(u.validation());
o.fn.open.call(this);
s=this.dialog().element;
j.bind(s,this.viewModel);
},apply:function(){o.fn.apply.call(this);
this.trigger("action",{command:"EditValidationCommand",options:{value:this.viewModel.toValidationObject()}});
},remove:function(){this.viewModel.reset();
this.apply();
}});
j.spreadsheet.dialogs.register("validation",q);
j.spreadsheet.dialogs.ValidationDialog=q;
})(window.kendo);
})();
(function(){(function(a){var b=a.Class.extend({init:function(c){this.options=$.extend({},this.options,c);
this.columns=this._normalizeColumns(this.options.columns);
this._sheet();
this._dataSource();
this._header();
this.dataSource.fetch();
},_sheet:function(){this.sheet=this.options.sheet;
this._sheetChangeHandler=this._sheetChange.bind(this);
this._sheetDeleteRowHandler=this._sheetDeleteRow.bind(this);
this._sheetInsertRowHandler=this._sheetInsertRow.bind(this);
this.sheet.bind("change",this._sheetChangeHandler).bind("deleteRow",this._sheetDeleteRowHandler).bind("insertRow",this._sheetInsertRowHandler);
},_sheetInsertRow:function(c){if(c.index!==undefined){this.dataSource.insert(Math.max(c.index-1,0),{});
}},_sheetDeleteRow:function(d){if(d.index!==undefined){var c=this.dataSource;
var f=c.view()[d.index-1];
if(f){c.remove(f);
}}},_header:function(){this.sheet.batch(function(){this.columns.forEach(function(c,d){this.sheet.range(0,d).value(c.title);
}.bind(this));
}.bind(this));
},_sheetChange:function(g){if(g.recalc&&g.ref){var f=this.dataSource;
var d=f.view();
var c=this.columns;
if(!c.length&&d.length){c=Object.keys(d[0].toJSON());
}this._skipRebind=true;
g.ref.forEach(function(i){i=i.toRangeRef();
for(var j=i.topLeft.row;
j<=i.bottomRight.row;
j++){var h=d[j-1];
if(!h){h=f.insert(j-1,{});
d=f.view();
}for(var e=i.topLeft.col;
e<=i.bottomRight.col&&e<c.length;
e++){h.set(c[e].field,g.value);
}}});
this._skipRebind=false;
}},_normalizeColumns:function(c){return c.map(function(d){var e=d.field||d;
return{field:e,title:d.title||e};
});
},_dataSource:function(){var d=this.options;
var c=d.dataSource;
c=Array.isArray(c)?{data:c}:c;
if(this.dataSource&&this._changeHandler){this.dataSource.unbind("change",this._changeHandler);
}else{this._changeHandler=this._change.bind(this);
}this.dataSource=a.data.DataSource.create(c).bind("change",this._changeHandler);
},_change:function(){if(this._skipRebind){return;
}var d=this.dataSource.view();
var c=this.columns;
if(!c.length&&d.length){this.columns=c=this._normalizeColumns(Object.keys(d[0].toJSON()));
this._header();
}var e=c.map(function(f){return a.getter(f.field);
});
this.sheet.batch(function(){for(var g=0,h=d.length;
g<h;
g++){for(var f=0;
f<e.length;
f++){this.sheet.range(g+1,f).value(e[f](d[g]));
}}}.bind(this));
},destroy:function(){this.dataSource.unbind("change",this._changeHandler);
this.sheet.unbind("change",this._sheetChangeHandler).unbind("deleteRow",this._sheetDeleteRowHandler).unbind("insertRow",this._sheetInsertRowHandler);
},options:{columns:[]}});
a.spreadsheet.SheetDataSourceBinder=b;
})(kendo);
})();
(function(){(function(g){var a=g.jQuery;
var i=g.ui.Widget;
var b={details:"k-details",button:"k-button",detailsSummary:"k-details-summary",detailsContent:"k-details-content",icon:"k-icon k-font-icon",iconCollapse:"k-i-collapse-se",iconExpand:"k-i-expand-e",iconSearch:"k-i-search",textbox:"k-textbox",wrapper:"k-spreadsheet-filter-menu",filterByCondition:"k-spreadsheet-condition-filter",filterByValue:"k-spreadsheet-value-filter",valuesTreeViewWrapper:"k-spreadsheet-value-treeview-wrapper",actionButtons:"k-action-buttons"};
var c=i.extend({init:function(j,k){i.fn.init.call(this,j,k);
this.element.addClass(e.classNames.details);
this._summary=this.element.find("."+e.classNames.detailsSummary).on("click",this.toggle.bind(this));
this._icon=a("<span />",{"class":e.classNames.icon+" "+e.classNames.iconCollapse}).prependTo(this._summary);
this._container=g.wrap(this._summary.next(),true);
},options:{name:"Details"},toggle:function(){var k=this._container.is(":visible");
var j=g.fx(this._container).expand("vertical");
j.stop()[k?"reverse":"play"]();
this._icon.toggleClass(e.classNames.iconExpand,k).toggleClass(e.classNames.iconCollapse,!k);
}});
var h={filterByValue:"<div class='"+b.detailsSummary+"'>#= messages.filterByValue #</div><div class='"+b.detailsContent+"'><div class='"+b.valuesTreeViewWrapper+"'><div data-#=ns#role='treeview' data-#=ns#checkboxes='{ checkChildren: true }' data-#=ns#bind='events: { check: valuesChange, select: valueSelect }' /></div></div>",filterByCondition:"<div class='"+b.detailsSummary+"'>#= messages.filterByCondition #</div><div class='"+b.detailsContent+'\'><select data-#=ns#bind="value: customFilter.criteria[0].operator" data-height="auto" data-#=ns#role="dropdownlist"><option value="">None</option>#for(var type in operators){##for(var op in operators[type]){#<option value="#=op#">#=operators[type][op]#</option>#}##}#</select><input data-#=ns#bind="value: customFilter.criteria[0].value" class="k-textbox" /><select class="k-filter-and" data-#=ns#bind="value: customFilter.logic" data-#=ns#role="dropdownlist"><option value="and">#=messages.and#</option><option value="or">#=messages.or#</option></select><select data-#=ns#bind="value: customFilter.criteria[1].operator" data-height="auto" data-#=ns#role="dropdownlist"><option value="">None</option>#for(var type in operators){##for(var op in operators[type]){#<option value="#=op#">#=operators[type][op]#</option>#}##}#</select><input data-#=ns#bind="value: customFilter.criteria[1].value" class="'+b.textbox+'" /></div>',menuItem:"<li data-command='#=command#' data-dir='#=dir#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</li>",actionButtons:"<div class='"+b.actionButtons+"'><button data-#=ns#bind='click: apply' class='k-button k-primary'>#=messages.apply#</button><button data-#=ns#bind='click: close' class='k-button'>#=messages.cancel#</button></div>"};
function d(m){var j={};
var l=[];
for(var k=0;
k<m.length;
k++){if(!j[m[k].value]){j[m[k].value]=true;
l.push(m[k]);
}}return l;
}var f=g.spreadsheet.FilterMenuViewModel=g.data.ObservableObject.extend({valuesChange:function(l){var j=function(o){return o.checked;
};
var m=function(o){return o.text;
};
var k=l.sender.dataSource.data();
var n=k[0].children.data().toJSON();
n=n.filter(j).map(m);
this.set("valueFilter",{values:n});
},valueSelect:function(j){j.preventDefault();
var k=j.sender.dataItem(j.node);
k.set("checked",!k.checked);
}});
var e=i.extend({init:function(k){var j=a("<div />",{"class":e.classNames.wrapper}).appendTo(document.body);
i.call(this,j,k);
this.viewModel=new f({customFilter:{logic:"and",criteria:[{operator:"",value:""},{operator:"",value:""}]},valueFilter:{values:[]},close:this.close.bind(this),apply:this.apply.bind(this)});
this._popup();
this._sort();
this._filterByCondition();
this._filterByValue();
this._actionButtons();
},options:{name:"FilterMenu",column:0,range:null,messages:{sortAscending:"Sort range A to Z",sortDescending:"Sort range Z to A",filterByValue:"Filter by value",filterByCondition:"Filter by condition",apply:"Apply",search:"Search",cancel:"Cancel",blanks:"(Blanks)",and:"AND",or:"OR"},operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},events:["action"],destroy:function(){i.fn.destroy.call(this);
this.menu.destroy();
this.valuesTreeView.destroy();
this.popup.destroy();
},openFor:function(j){this.popup.setOptions({anchor:j});
this.popup.open();
},close:function(){this.popup.close();
},apply:function(){this.viewModel.valuesChange({sender:this.valuesTreeView});
var j={operatingRange:this.options.range,column:this.options.column};
var k=this.viewModel.valueFilter.values;
if(k&&k.length){j.values=k;
}this.action({command:"ApplyFilterCommand",options:j});
},action:function(j){this.trigger("action",a.extend({},j));
},getValues:function(){var m=[];
var l=this.options.messages;
var j=this.options.column;
var k=this.options.range.resize({top:1}).column(j);
k.forEachCell(function(q,o,n){var p;
if(n.value===undefined){n.dataType="blank";
}else{if(n.format){n.dataType=g.spreadsheet.formatting.type(n.value,n.format);
}else{n.dataType=typeof n.value;
}}if(n.value!==null&&n.format){p=g.spreadsheet.formatting.compile(n.format);
n.text=p(n.value).text();
}else{n.text=n.value?n.value:l.blanks;
}if(n.dataType==="date"){n.value=g.spreadsheet.numberToDate(n.value);
}m.push(n);
});
m=d(m);
m.sort(function(n,o){if(n.dataType===o.dataType){return 0;
}if(n.dataType==="blank"||o.dataType==="blank"){return n.dataType==="blank"?-1:1;
}if(n.dataType==="number"||o.dataType==="number"){return n.dataType==="number"?-1:1;
}if(n.dataType==="date"||o.dataType==="date"){return n.dataType==="date"?-1:1;
}return 0;
});
return[{text:"All",expanded:true,checked:true,items:m}];
},_popup:function(){this.popup=this.element.kendoPopup().data("kendoPopup");
},_sort:function(){var l=g.template(e.templates.menuItem);
var k=this.options.messages;
var j=[{command:"sort",dir:"asc",text:k.sortAscending,iconClass:"sort-asc"},{command:"sort",dir:"desc",text:k.sortDescending,iconClass:"sort-desc"}];
var m=a("<ul />",{html:g.render(l,j)}).appendTo(this.element);
this.menu=m.kendoMenu({orientation:"vertical",select:function(o){var n=a(o.item).data("dir")==="asc";
var q=this.options.range.resize({top:1});
var p={asc:n,sheet:false,operatingRange:q};
this.action({command:"SortCommand",options:p});
}.bind(this)}).data("kendoMenu");
},_appendTemplate:function(l,k){var j=g.template(l);
var m=a("<div />").html(j({messages:this.options.messages,operators:this.options.operators,ns:g.ns}));
this.element.append(m);
if(k){k=new c(m);
}g.bind(m,this.viewModel);
return m;
},_filterByCondition:function(){this._appendTemplate(e.templates.filterByCondition,true);
},_filterByValue:function(){var j=this._appendTemplate(e.templates.filterByValue,true);
this.valuesTreeView=j.find("[data-role=treeview]").data("kendoTreeView");
this.valuesTreeView.setDataSource(this.getValues());
},_actionButtons:function(){this._appendTemplate(e.templates.actionButtons,false);
}});
g.spreadsheet.FilterMenu=e;
a.extend(true,e,{classNames:b,templates:h});
})(window.kendo);
})();
(function(){(function(a){var b=a.Observable.extend({init:function(c){a.Observable.fn.init.call(this);
this.view=c;
this.formulaBar=c.formulaBar;
this.barInput=c.formulaBar.formulaInput;
this.cellInput=c.formulaInput;
this.barInput.syncWith(this.cellInput);
this.cellInput.syncWith(this.barInput);
this.barInput.bind("keyup",this._triggerUpdate.bind(this));
this.cellInput.bind("keyup",this._triggerUpdate.bind(this));
},events:["activate","deactivate","change","update"],_triggerUpdate:function(){this.trigger("update",{value:this.value()});
},activeEditor:function(){var c=null;
if(this.barElement().is(":focus")){c=this.barInput;
}else{if(this.cellElement().is(":focus")){c=this.cellInput;
}}return c;
},activate:function(c){this._active=true;
this.position(c.rect);
this.cellInput.resize(c.rect);
this.trigger("activate");
return this;
},deactivate:function(){var c=this.cellInput;
if(!this._active){return;
}this._active=false;
c.hide();
if(c.value()!=this._value){this.trigger("change",{value:c.value()});
}this.trigger("deactivate");
},barElement:function(){return this.barInput.element;
},cellElement:function(){return this.cellInput.element;
},focus:function(c){c=c||"cell";
if(c==="cell"){this.cellInput.element.focus();
this.cellInput.end();
}else{this.barInput.element.focus();
}},isActive:function(){return this._active;
},isFiltered:function(){return this.barInput.popup.visible()||this.cellInput.popup.visible();
},canInsertRef:function(d){var c=this.activeEditor();
return c&&c.canInsertRef(d);
},highlightedRefs:function(){var c=this.activeEditor();
var d=[];
if(c){d=c.highlightedRefs();
}return d;
},scale:function(){this.cellInput.scale();
},position:function(c){this.cellInput.position(c);
},value:function(c){if(c===undefined){return this.barInput.value();
}if(c===null){c="";
}this._value=c;
this.barInput.value(c);
this.cellInput.value(c);
}});
a.spreadsheet.SheetEditor=b;
})(kendo);
})();
(function(){(function(e,g){var a=e.jQuery;
var i=e.ui.Widget;
var j=e.spreadsheet.Workbook;
var d=e.spreadsheet.Controller;
var h=e.spreadsheet.View;
var b={recalc:true,selection:true,activeCell:true,layout:true,sheetSelection:true,resize:true};
var c={wrapper:"k-widget k-spreadsheet"};
var f=e.ui.Widget.extend({init:function(k,l){i.fn.init.call(this,k,l);
this.element.addClass(f.classNames.wrapper);
this._view=new h(this.element,{toolbar:this.options.toolbar});
this._workbook=new j(this.options);
this._controller=new d(this._view,this._workbook);
this._autoRefresh=true;
this._workbook.bind("change",this._workbookChange.bind(this));
this._resize();
this._view.workbook(this._workbook);
this.refresh();
},_resize:function(){this._view._resize();
},_workbookChange:function(k){if(this._autoRefresh){this.refresh(k);
}},activeSheet:function(k){return this._workbook.activeSheet(k);
},moveSheetToIndex:function(l,k){return this._workbook.moveSheetToIndex(l,k);
},insertSheet:function(k){return this._workbook.insertSheet(k);
},sheets:function(){return this._workbook.sheets();
},removeSheet:function(k){return this._workbook.removeSheet(k);
},sheetByName:function(k){return this._workbook.sheetByName(k);
},sheetIndex:function(k){return this._workbook.sheetIndex(k);
},sheetByIndex:function(k){return this._workbook.sheetByIndex(k);
},renameSheet:function(l,k){return this._workbook.renameSheet(l,k);
},refresh:function(k){if(!k){k=b;
}this._view.sheet(this._workbook.activeSheet());
this._controller.sheet(this._workbook.activeSheet());
this._workbook.refresh(k);
this._view.refresh(k);
this._controller.refresh();
this._view.render();
this.trigger("render");
return this;
},openDialog:function(k,l){return this._view.openDialog(k,l);
},autoRefresh:function(k){if(k!==g){this._autoRefresh=k;
if(k===true){this.refresh();
}return this;
}return this._autoRefresh;
},toJSON:function(){return this._workbook.toJSON();
},fromJSON:function(k){if(k.sheets){this._workbook.destroy();
this._workbook=new j(a.extend({},this.options,k));
this._workbook.bind("change",this._workbookChange.bind(this));
this._view.workbook(this._workbook);
this._controller.workbook(this._workbook);
this.activeSheet(this.activeSheet());
}else{this.refresh();
}},destroy:function(){e.ui.Widget.fn.destroy.call(this);
this._workbook.destroy();
this._controller.destroy();
this._view.destroy();
},options:{name:"Spreadsheet",toolbar:true,sheetsbar:true,rows:200,columns:50,rowHeight:20,columnWidth:64,headerHeight:20,headerWidth:32},events:["render"]});
e.spreadsheet.ALL_REASONS=b;
e.ui.plugin(f);
a.extend(true,f,{classNames:c});
})(window.kendo);
})();
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b){b();
});
