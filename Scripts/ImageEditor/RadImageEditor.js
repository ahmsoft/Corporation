Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,b){b.ImageEditor.CommandList={Open:function(e,d,c){e._closeToolsPanelAndSaveCommand(d);
},Undo:function(f,d,c){var g=c&&c.get_item?c.get_item():null;
var e=(!g||g._isDropDownItem()||!g._isDropDownChild())?1:g.get_index()+1;
if(d=="Undo"){f.undo(e);
}else{if(d=="Redo"){f.redo(e);
}}},Reset:function(e,d,c){e.resetChanges();
e._closeToolsPanelAndSaveCommand(d);
},Crop:function(e,d,c){e.executeCommand(d);
},InvertColor:function(e,d,c){if(!e.useCanvas()){return;
}var f=new b.ImageEditor.Filters.InvertColorFilter();
e.applyFilter(f);
},Sepia:function(e,d,c){if(!e.useCanvas()){return;
}var f=new b.ImageEditor.Filters.SepiaFilter();
e.applyFilter(f);
},Greyscale:function(f,d,c){if(!f.useCanvas()){return;
}var e=new b.ImageEditor.Filters.GreyscaleFilter();
f.applyFilter(e);
},Blur:function(f,e,c){if(!f.useCanvas()){return;
}var d=new b.ImageEditor.Filters.BlurFilter();
f.applyFilter(d);
},Sharpen:function(e,d,c){if(!e.useCanvas()){return;
}var f=new b.ImageEditor.Filters.SharpenFilter();
e.applyFilter(f);
},ZoomIn:function(e,d,c){e.zoomIn();
},ZoomOut:function(e,d,c){e.zoomOut();
},FlipVertical:function(e,d,c){e.flipVertical();
},FlipHorizontal:function(e,d,c){e.flipHorizontal();
},RotateRight:function(e,d,c){e.rotateRight90();
},RotateLeft:function(e,d,c){e.rotateLeft90();
}};
b.ImageEditor.CommandList.Redo=b.ImageEditor.CommandList.Undo;
b.ImageEditor.CommandList.DrawCircle=b.ImageEditor.CommandList.DrawRectangle=b.ImageEditor.CommandList.Line=b.ImageEditor.CommandList.Pencil=b.ImageEditor.CommandList.HueSaturation=b.ImageEditor.CommandList.BrightnessContrast=b.ImageEditor.CommandList.Resize=b.ImageEditor.CommandList.Export=b.ImageEditor.CommandList.Save=b.ImageEditor.CommandList.Print=b.ImageEditor.CommandList.Zoom=b.ImageEditor.CommandList.Opacity=b.ImageEditor.CommandList.Rotate=b.ImageEditor.CommandList.Flip=b.ImageEditor.CommandList.AddText=b.ImageEditor.CommandList.InsertImage=b.ImageEditor.CommandList.Crop;
})($telerik.$,Telerik.Web.UI);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.IImageOperation=function(){};
b.IImageOperation.prototype={execute:function(){},undo:function(){},toString:function(){},fromString:function(d){},fromData:function(d){},canUndo:function(){},get_name:function(){},get_text:function(){},get_image:function(){},dispose:function(){}};
b.IImageOperation.registerInterface("Telerik.Web.UI.ImageEditor.IImageOperation");
b.ImageOperation=function(){this._index=-1;
};
b.ImageOperation.prototype={getIsClientOperation:function(){return true;
},get_index:function(){return this._index;
},set_index:function(d){this._index=d;
}};
b.ImageOperation.registerClass("Telerik.Web.UI.ImageEditor.ImageOperation",null);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.Matrix3x3=function(e){for(var f=0,d=0;
f<3;
f++){for(var g=0;
g<3;
g++,d++){this["m"+(f+1)+(g+1)]=e[d];
}}};
b.Matrix3x3.prototype={m11:1,m12:0,m13:0,m21:0,m22:1,m23:0,m31:0,m32:0,m33:1,multiply:function(d){return new b.Matrix3x3([this.m11*d.m11+this.m12*d.m21+this.m13*d.m31,this.m11*d.m12+this.m12*d.m22+this.m13*d.m32,this.m11*d.m13+this.m12*d.m23+this.m13*d.m33,this.m21*d.m11+this.m22*d.m21+this.m23*d.m31,this.m21*d.m12+this.m22*d.m22+this.m23*d.m32,this.m21*d.m13+this.m22*d.m23+this.m23*d.m33,this.m31*d.m11+this.m32*d.m21+this.m33*d.m31,this.m31*d.m12+this.m32*d.m22+this.m33*d.m32,this.m31*d.m13+this.m32*d.m23+this.m33*d.m33]);
},multiplyVector:function(d){return[this.m11*d[0]+this.m12*d[1]+this.m13,this.m21*d[0]+this.m22*d[1]+this.m23];
},equals:function(d){return this.m11==d.m11&&this.m12==d.m12&&this.m13==d.m13&&this.m21==d.m21&&this.m22==d.m22&&this.m23==d.m23&&this.m31==d.m31&&this.m32==d.m32&&this.m33==d.m33;
},clone:function(){return new b.Matrix3x3([this.m11,this.m12,this.m13,this.m21,this.m22,this.m23,this.m31,this.m32,this.m33]);
}};
b.Matrix3x3.registerClass("Telerik.Web.UI.ImageEditor.Matrix3x3");
b.Matrix3x3.identityMatrix=new b.Matrix3x3([1,0,0,0,1,0,0,0,1]);
b.Matrix3x3.rotate90Matrix=new b.Matrix3x3([0,1,0,-1,0,0,0,0,1]);
b.Matrix3x3.rotate180Matrix=new b.Matrix3x3([-1,0,0,0,-1,0,0,0,1]);
b.Matrix3x3.rotate270Matrix=new b.Matrix3x3([0,-1,0,1,0,0,0,0,1]);
b.Matrix3x3.flipXMatrix=new b.Matrix3x3([-1,0,0,0,1,0,0,0,1]);
b.Matrix3x3.flipYMatrix=new b.Matrix3x3([1,0,0,0,-1,0,0,0,1]);
b.Matrix3x3.getScaleMatrix=function(d){return new b.Matrix3x3([d,0,0,0,d,0,0,0,1]);
};
b.Matrix2x2=function(d){this.m11=d[0];
this.m12=d[1];
this.m21=d[2];
this.m22=d[3];
};
b.Matrix2x2.prototype={m11:1,m12:0,m21:1,m22:0,multiply:function(d){return new b.Matrix2x2([this.m11*d.m11+this.m12*d.m21,this.m11*d.m12+this.m12*d.m22,this.m21*d.m11+this.m22*d.m21,this.m21*d.m12+this.m22*d.m22]);
},multiplyVector:function(d){return[this.m11*d[0]+this.m12*d[1],this.m21*d[0]+this.m22*d[1]];
},equals:function(d){return this.m11==d.m11&&this.m12==d.m12&&this.m21==d.m21&&this.m22==d.m22;
},clone:function(){return new b.Matrix2x2([this.m11,this.m12,this.m21,this.m22]);
}};
b.Matrix2x2.registerClass("Telerik.Web.UI.ImageEditor.Matrix2x2");
b.Matrix2x2.identityMatrix=new b.Matrix2x2([1,0,0,1]);
b.Matrix2x2.rotate90Matrix=new b.Matrix2x2([0,-1,1,0]);
b.Matrix2x2.rotate180Matrix=new b.Matrix2x2([-1,0,0,-1]);
b.Matrix2x2.rotate270Matrix=new b.Matrix2x2([0,1,-1,0]);
b.Matrix2x2.flipXMatrix=new b.Matrix2x2([-1,0,0,1]);
b.Matrix2x2.flipYMatrix=new b.Matrix2x2([1,0,0,-1]);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){a.registerEnum(b,"FlipDirection",{None:0,Vertical:1,Horizontal:2,Both:3});
a.registerEnum(b,"Rotation",{None:0,Rotate90:1,Rotate180:2,Rotate270:3});
a.registerEnum(b,"AllowedSavingLocation",{ClientAndServer:0,Client:1,Server:2});
a.registerEnum(b,"ToolBarMode",{Default:0,Docked:1});
a.registerEnum(b,"ToolBarPosition",{Top:0,Right:1,Bottom:2,Left:3});
a.registerEnum(b,"CanvasMode",{Automatic:0,Yes:1,No:2});
b.Canvas=function(d){var e=d;
if(typeof(d)=="string"){e=$get(d)||this.createCanvasElement(d);
}this.initialize(e);
};
b.Canvas.prototype={initialize:function(d){this._canvasElement=d||document.createElement("canvas");
},dispose:function(){this._canvasElement=null;
},supportsCanvas:function(){return !!(this._canvasElement.getContext);
},createCanvasElement:function(d){if(!this._canvasElement){this._canvasElement=document.createElement("canvas");
}this._canvasElement.setAttribute("id",d);
return this._canvasElement;
},get_canvas:function(){return this._canvasElement;
},get_context:function(){return this._canvasElement.getContext("2d");
},get_size:function(){var d=this._canvasElement;
return{width:d.width,height:d.height};
},set_size:function(f,e){var d=this._canvasElement;
d.width=f;
d.height=e;
},clone:function(){var d=this._canvasElement;
var e=document.createElement("canvas");
e.width=d.width;
e.height=d.height;
var f=e.getContext("2d");
f.drawImage(d,0,0);
return new b.Canvas(e);
},getImageDataAll:function(){var d=this.get_context();
var e=this.get_size();
return d.getImageData(0,0,e.width,e.height);
},cloneImageData:function(){var f=this.get_context();
var h=this.getImageDataAll();
var j=h.data;
var d=f.createImageData(h);
var e=d.data;
for(var g=0,k=j.length;
g<k;
g++){e[g]=j[g];
}return d;
}};
b.Canvas.registerClass("Telerik.Web.UI.ImageEditor.Canvas",null);
b.ImageText=function(){};
a.registerControlProperties(b.ImageText,{fontFamily:"Verdana",fontSize:12,color:"#000000",text:"",lineHeight:0});
b.ImageText.registerClass("Telerik.Web.UI.ImageEditor.ImageText",null);
b.extendMethod=function(e,g,d){var f=e[g];
e[g]=function(){d.apply(this,arguments);
f.apply(this,arguments);
};
};
b.normalizeColorValue=function(d){return d>255?255:d<0?0:d;
};
b.CancelEventArgs=function(e,d){b.CancelEventArgs.initializeBase(this);
this._domEvent=e;
this._commandName=d;
};
b.CancelEventArgs.prototype={get_commandName:function(){return this._commandName;
},set_commandName:function(d){this._commandName=d;
},get_domEvent:function(){return this._domEvent;
}};
b.CancelEventArgs.registerClass("Telerik.Web.UI.ImageEditor.CancelEventArgs",Sys.CancelEventArgs);
b.ImageChangeCancelEventArgs=function(f,e,d,g){b.ImageChangeCancelEventArgs.initializeBase(this,[f,e]);
this._argument=d;
this._updateUI=g;
};
b.ImageChangeCancelEventArgs.prototype={get_argument:function(){return this._argument;
},set_argument:function(d){this._argument=d;
},get_updateUI:function(){return this._updateUI;
},set_updateUI:function(d){this._updateUI=d;
}};
b.ImageChangeCancelEventArgs.registerClass("Telerik.Web.UI.ImageEditor.ImageChangeCancelEventArgs",b.CancelEventArgs);
b.EventArgs=function(e,d){b.EventArgs.initializeBase(this);
this._domEvent=e;
this._commandName=d;
};
b.EventArgs.prototype={get_commandName:function(){return this._commandName;
},set_commandName:function(d){this._commandName=d;
},get_domEvent:function(){return this._domEvent;
}};
b.EventArgs.registerClass("Telerik.Web.UI.ImageEditor.EventArgs",Sys.EventArgs);
b.ImageChangeEventArgs=function(e,d,f){b.ImageChangeEventArgs.initializeBase(this,[e,d]);
this._operation=f;
};
b.ImageChangeEventArgs.prototype={get_imageOperation:function(){return this._operation;
},set_imageOperation:function(d){this._operation=d;
}};
b.ImageChangeEventArgs.registerClass("Telerik.Web.UI.ImageEditor.ImageChangeEventArgs",b.EventArgs);
b.SavingEventArgs=function(f,d,e){b.SavingEventArgs.initializeBase(this);
this._saveAction=f;
this._fileName=d;
};
b.SavingEventArgs.prototype={get_saveAction:function(){return this._saveAction;
},get_fileName:function(){return this._fileName;
},set_fileName:function(d){this._fileName=d;
},get_overwrite:function(){return true;
}};
b.SavingEventArgs.registerClass("Telerik.Web.UI.ImageEditor.SavingEventArgs",Sys.CancelEventArgs);
b.SavedEventArgs=function(e,f,g,d){b.SavedEventArgs.initializeBase(this);
this._fileName=e;
this._isSaved=f;
this._message=g;
this._argument=d;
};
b.SavedEventArgs.prototype={get_fileName:function(){return this._fileName;
},get_isSaved:function(){return this._isSaved;
},get_argument:function(){return this._argument;
},get_message:function(){return this._message;
}};
b.SavedEventArgs.registerClass("Telerik.Web.UI.ImageEditor.SavedEventArgs",Sys.EventArgs);
b.ShortCutCancelEventArgs=function(d,e){b.ShortCutCancelEventArgs.initializeBase(this);
this._domEvent=d;
this._shortCut=e;
};
b.ShortCutCancelEventArgs.prototype={get_shortCut:function(){return this._shortCut;
},get_domEvent:function(){return this._domEvent;
}};
b.ShortCutCancelEventArgs.registerClass("Telerik.Web.UI.ImageEditor.ShortCutCancelEventArgs",Sys.CancelEventArgs);
b.ServerOperationCompletedArgs=function(e,d){b.ServerOperationCompletedArgs.initializeBase(this);
this.set_serverData(e);
this.set_context(d);
};
a.registerControlProperties(b.ServerOperationCompletedArgs,{serverData:null,context:null});
b.ServerOperationCompletedArgs.registerClass("Telerik.Web.UI.ImageEditor.ServerOperationCompletedArgs",Sys.CancelEventArgs);
b.DialogLoadedEventArgs=function(d){b.DialogLoadedEventArgs.initializeBase(this);
this.set_widget(d);
};
a.registerControlProperties(b.DialogLoadedEventArgs,{widget:null});
b.DialogLoadedEventArgs.registerClass("Telerik.Web.UI.ImageEditor.DialogLoadedEventArgs",Sys.EventArgs);
b.StatusBar=function(d,e){this._element=d;
this._parentID=e.get_id();
this._imageEditor=e;
this._zoomRatio=null;
this.initialize();
};
b.StatusBar.prototype={initialize:function(){if(!this.get_element()){return;
}var d=this._imageEditor.getEditableImage();
if(d){this.setValue(d.get_zoomLevel(),"zoom");
var e=d.getImage();
if(e){this.updateSize(e.width,e.height);
}this._attachHandlers(true);
}},dispose:function(){if(!this.get_element()){return;
}this._attachHandlers(false);
},_attachHandlers:function(e){var d=this._imageEditor.getEditableElement();
if(d){if(e){this._mouseMoveDelegate=Function.createDelegate(this,this._mouseMove);
$addHandler(d,"mousemove",this._mouseMoveDelegate);
this._mouseOutDelegate=Function.createDelegate(this,this._mouseOut);
$addHandler(d,"mouseout",this._mouseOutDelegate);
}else{$removeHandler(d,"mousemove",this._mouseMoveDelegate);
this._mouseMoveDelegate=null;
$removeHandler(d,"mouseout",this._mouseOutDelegate);
this._mouseOutDelegate=null;
}}},_mouseMove:function(d){if(this._zoomRatio==null){this._zoomRatio=100/this._imageEditor.getEditableImage().get_zoomLevel();
this._viewPort=this._imageEditor.get_viewport();
}var e=this._getMousePos(d.rawEvent);
var f=this._imageEditor.get_left();
var g=this._imageEditor.get_top();
if($telerik.isSafari){f-=1;
g-=1;
}if($telerik.isIE6||$telerik.isIE7){f+=2;
g+=2;
}this.updatePosition(Math.floor((e.x-f+this._viewPort.scrollLeft)*this._zoomRatio),Math.floor((e.y-g+this._viewPort.scrollTop)*this._zoomRatio));
},_getMousePos:function(d){var f=0;
var g=0;
if(d.pageX||d.pageY){f=d.pageX;
g=d.pageY;
}else{if(d.clientX||d.clientY){f=d.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;
g=d.clientY+document.body.scrollTop+document.documentElement.scrollTop;
}}return{x:f,y:g};
},_mouseOut:function(d){this.updatePosition("-","-");
this._zoomRatio=null;
},get_element:function(){return this._element;
},get_coorX:function(){if(!this._X){this._X=this._getChildElement("sbX");
}return this._X;
},get_coorY:function(){if(!this._Y){this._Y=this._getChildElement("sbY");
}return this._Y;
},get_zoom:function(){if(!this._zoom){this._zoom=this._getChildElement("sbZoom");
}return this._zoom;
},get_width:function(){if(!this._width){this._width=this._getChildElement("sbW");
}return this._width;
},get_height:function(){if(!this._height){this._height=this._getChildElement("sbH");
}return this._height;
},get_lastAction:function(){if(!this._lastAction){this._lastAction=this._getChildElement("sbAction");
}return this._lastAction;
},setValue:function(f,e){var d=this["get_"+e]();
if(d){d.innerHTML=f;
}if(f&&f.indexOf&&f.indexOf("Resize")!=-1){this._updateSizeInternal();
}},_updateSizeInternal:function(){var d=this._imageEditor.getEditableImage();
if(d){this.setValue(d.get_width(),"width");
this.setValue(d.get_height(),"height");
}},updateSize:function(e,d){if(typeof(e)=="undefined"||e==null||d==null||typeof(d)=="undefined"){this._updateSizeInternal();
return;
}this.setValue(e,"width");
this.setValue(d,"height");
},updatePosition:function(d,e){this.setValue(d,"coorX");
this.setValue(e,"coorY");
},_getChildElement:function(d){return $get(this._parentID+"_"+d,this.get_element());
}};
b.StatusBar.registerClass("Telerik.Web.UI.ImageEditor.StatusBar",null);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b,d){b.IEditableImage=function(e,g,f){};
b.IEditableImage.prototype={changeOpacity:function(f,e){},resize:function(g,e,f){},rotate:function(g,e,f){},flip:function(f,e,g){},crop:function(e){},addText:function(f,g,e){},insertImage:function(g,h,f,e){},reset:function(e){},zoomBestFit:function(g,e,f){},zoom:function(f,e){},saveOnClient:function(e){},doServerOperation:function(g,h,f,e){},applyChangesOnServer:function(h,f,e,g){},getCanvas:function(){},mergeCanvas:function(e){}};
b.IEditableImage.registerInterface("Telerik.Web.UI.ImageEditor.IEditableImage");
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b,d){b.EditableImageBase=function(e,g,f){b.EditableImageBase.initializeBase(this);
this._image=e;
this._xmlHttpPanel=g;
this._imageEditor=f;
this.initialize();
};
b.EditableImageBase.prototype={initialize:function(){b.EditableImageBase.callBaseMethod(this,"initialize");
this._flipH=false;
this._flipV=false;
this._zoomLevel=100;
this._canDoServerOperation=true;
},dispose:function(){this._attachToImageLoad(false);
this._image=null;
b.EditableImageBase.callBaseMethod(this,"dispose");
},getImage:function(){return this._image;
},getImageEditor:function(){return this._imageEditor;
},getXmlHttpPanel:function(){return this._xmlHttpPanel;
},getCanvasElement:function(){return null;
},getCanvasContext:function(){return null;
},isImageLoaded:function(){var e=this.getImage();
return !((e.width===d)||(e.src!=""&&(e.complete!==d)&&e.complete===false));
},raiseEvent:function(g,e){var f=this.get_events().getHandler(g);
if(f){f(this,e||Sys.EventArgs.Empty);
}},get_zoomLevel:function(){return this._zoomLevel;
},get_url:function(){return this._getSrcAttr();
},_getSrcAttr:function(){return this.getImage().getAttribute("src");
},get_serverUrl:function(){return this._serverUrl;
},set_serverUrl:function(e){this._serverUrl=e;
},get_imageKey:function(){return a(this.getImage()).data("key");
},set_imageKey:function(f){var e=a(this.getImage());
if(f===d){e.removeData("key");
}else{e.data("key",f);
}},get_width:function(){},get_height:function(){},get_opacity:function(){},get_flipDirection:function(){},set_flipDirection:function(e){},get_rotationAngle:function(){},zoomBestFit:function(g,e,f){if(!f){f=100;
}var i=g/this.get_width();
var j=e/this.get_height();
var h=Math.min(i,j);
if(h<f/100){this.zoom(Math.floor(h*100)-1);
}else{this.zoom(f);
}},_applyOperation:function(e){e.execute();
return e;
},_getIsHorizontal:function(){return true;
},_getFlipDirections:function(f){var g=(f==b.FlipDirection.Vertical||f==b.FlipDirection.Both);
var e=(f==b.FlipDirection.Horizontal||f==b.FlipDirection.Both);
return(this._getIsHorizontal()?{flipV:g,flipH:e}:{flipV:e,flipH:g});
},_getFlipDirection:function(e,f){return(e&&f?b.FlipDirection.Both:(e?b.FlipDirection.Horizontal:(f?b.FlipDirection.Vertical:b.FlipDirection.None)));
},_getRotationFromAngle:function(e){return e?(e==90?b.Rotation.Rotate90:(e==180?b.Rotation.Rotate180:(e==270?b.Rotation.Rotate270:b.Rotation.None))):b.Rotation.None;
},_getAngleFromRotation:function(f){var e;
switch(f){case b.Rotation.Rotate90:e=90;
break;
case b.Rotation.Rotate180:e=180;
break;
case b.Rotation.Rotate270:e=270;
break;
default:e=0;
}return e;
},_imageLoadedHandler:function(e){this._raiseImageReloadEvent();
},_raiseImageReloadEvent:function(){this.raiseEvent("imageReload");
},_attachToImageLoad:function(e){if(e){this._imageLoadedDelegate=Function.createDelegate(this,this._imageLoadedHandler);
$addHandler(this.getImage(),"load",this._imageLoadedDelegate);
}else{$removeHandler(this.getImage(),"load",this._imageLoadedDelegate);
delete this._imageLoadedDelegate;
}},_raiseServerOperationCompleted:function(f,e){var g=new b.ServerOperationCompletedArgs(f,e);
this.raiseEvent("serverOperationCompleted",g);
return g;
},_serializeData:function(e){var f={Value:typeof(e)=="string"?e:Sys.Serialization.JavaScriptSerializer.serialize(e)};
return Sys.Serialization.JavaScriptSerializer.serialize(f);
},_readJson:function(e){return Sys.Serialization.JavaScriptSerializer.deserialize(e);
},_constructDownloadParams:function(g){var f=this._getExtFromFileNameObj(g);
var i=window.encodeURIComponent(g.name||g);
var e=f?String.format("{0}&ext={1}",i,f):i;
var h=e?"&fileName="+e:"";
return String.format("{0}&dkey={1}",h,this._getDownloadKey());
},_getExtFromFileNameObj:function(e){return e&&e.ext;
},_getDownloadKey:function(){return"";
},_alertMessage:function(e){if(e){alert(e);
}},_appendCacheBuster:function(e){return e+(e.indexOf("?")==-1?"?c=":"&c=")+Math.random();
}};
a.registerControlEvents(b.EditableImageBase,["imageReload","serverOperationCompleted","serverSaved"]);
b.EditableImageBase.registerClass("Telerik.Web.UI.ImageEditor.EditableImageBase",Sys.Component);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){c.EditableCanvas=function(e,g,f){c.EditableCanvas.initializeBase(this,[e,g]);
this.options=a.extend({canUndo:true,imageFormat:null,id:this._getDefaultId()},f||{});
this._createCanvasElement();
if(this._image.getAttribute("src")!=""){this._loadImageInCanvas();
}this._storeInitialState();
};
c.EditableCanvas.prototype={initialize:function(){c.EditableCanvas.callBaseMethod(this,"initialize");
this._rotationAngle=0;
},dispose:function(){this._image=null;
this._canvasImage=null;
this._initialStateData=null;
},changeOpacity:function(f,e){if(e){e.set_currentOpacity(f);
}else{e=new c.OpacityOperation(this,f,this._imageOpacity);
}this._imageOpacity=f;
return this._applyOperation(e);
},resize:function(h,e,f){if(f){f.set_size(h,e);
}else{f=new b.ResizeOperation(this.getCanvasContext(),{canUndo:this.options.canUndo,width:h,height:e});
}var g=this._applyOperation(f);
this.zoom(this.get_zoomLevel(),true);
return g;
},rotate:function(i,e,f){e=this._computeAngle(i,e);
var h=e-this._rotationAngle;
if(h<0){h=h+360;
}if(f){f.set_rotationAngle(h);
}else{f=new b.RotateOperation(this,{canUndo:this.options.canUndo,rotationAngle:h,imageRotationAngle:e});
}var g=this._applyOperation(f);
this.zoom(this.get_zoomLevel(),true);
this._rotationAngle=e;
return g;
},_computeAngle:function(f,e){if(f!=null&&typeof(f)!="undefined"){return this._getAngleFromRotation(f);
}else{if(e==null||typeof(e)=="undefined"||(e!=0&&e!=90&&e!=180&&e!=270)){return 0;
}}return e;
},flip:function(f,e,g){var h=this._getFlipDirections(f);
h.flipH=(this._flipH!=h.flipH);
h.flipV=(this._flipV!=h.flipV);
var i=this._getFlipDirection(h.flipH,h.flipV);
if(g){g.set_flipDirection(i);
}else{g=new b.FlipOperation(this,{canUndo:this.options.canUndo,direction:i});
}this.set_flipDirection(f);
return this._applyOperation(g);
},crop:function(g){var e=new b.CropOperation(this.getCanvasContext(),{canUndo:this.options.canUndo,bounds:g});
var f=this._applyOperation(e);
this.zoom(this.get_zoomLevel(),true);
return f;
},addText:function(g,h,f){f.set_fontSize(f.get_fontSize()+"px");
var e=new b.AddTextOperation(this.getCanvasContext(),{canUndo:this.options.canUndo,x:g,y:h,text:f});
return this._applyOperation(e);
},insertImage:function(m,n,k,i){var g=i.length;
var l,e;
if(g>0){var j=i[g-1];
if(j.get_width&&j.get_height){l=i[g-1].get_width();
e=i[g-1].get_height();
}}var f=this._createImageToInsert();
this._insertImageOperation=new b.InsertImageOperation(this.getCanvasContext(),{canUndo:this.options.canUndo,image:f,bounds:{x:m,y:n,width:l,height:e}});
f.src=k;
this._imgToInsert=f;
return this._insertImageOperation;
},_createImageToInsert:function(){var e=new Image();
this._insertImageLoadDelegate=Function.createDelegate(this,this._insertImageLoadHandler);
$addHandler(e,"load",this._insertImageLoadDelegate);
return e;
},_insertImageLoadHandler:function(f){this._applyOperation(this._insertImageOperation);
$removeHandler(this._imgToInsert,"load",this._insertImageLoadDelegate);
delete this._insertImageLoadDelegate;
this._insertImageOperation=null;
this._imgToInsert=null;
},mergeCanvas:function(e,f){var g=new b.MergeCanvasOperation(this.getCanvasContext(),{canUndo:this.options.canUndo,canvas:e,name:f});
var h=this._applyOperation(g);
return h;
},reset:function(e){this._restoreInitialState();
},forceCurrentZoom:function(){this.zoom(this.get_zoomLevel(),true);
},zoom:function(g,f){var e=this.get_zoomLevel();
g=isNaN(g)?e:g;
if(f||g!=e){this._zoomLevel=g;
this.scaleCanvasBy(g/100);
}},scaleCanvasBy:function(h){var e=this.getCanvasElement();
var g={width:e.width*h+"px",height:e.height*h+"px"};
var f=this.setCanvasCss(g);
f.trigger("zoom",g);
},setCanvasCss:function(f){var e=this.getCanvasElement();
return $telerik.$("canvas.__telerik_drawable_canvas",e.parentNode).add(e).css(f);
},saveOnClient:function(f){var e=this._constructDownloadParams(f);
var g=document.location+"";
g=g.substring(0,g.lastIndexOf("/")+1)+"Telerik.Web.UI.WebResource.axd?type=iec"+e;
this._downloadImg(g);
},_downloadImg:function(f){var e=document.createElement("input");
e.type="hidden";
e.setAttribute("name","base64");
e.setAttribute("value",this.getBase64());
var g=document.createElement("form");
g.method="post";
g.action=f;
g.appendChild(e);
document.body.appendChild(g);
g.submit();
document.body.removeChild(g);
},doServerOperation:function(g,h,f,e){},applyChangesOnServer:function(h,f,e,g){this._applyChangesOnServer_Canvas(h,f,e,g);
},applyFilter:function(e,f){if(f&&b.FilterOperation.isInstanceOfType(f)){f.options.filter=e;
}else{f=new b.FilterOperation(this.getCanvasContext(),{canUndo:this.options.canUndo,filter:e});
}return this._applyOperation(f);
},executeFilter:function(f){var e=f.initialData?this._canvasContext.createImageData(this.get_width(),this.get_height()):this.getImageDataAll();
f.execute(e);
this._canvasContext.putImageData(e,0,0);
},getCanvasElement:function(){return this._canvasElement;
},getCanvasContext:function(){if(!this._canvasContext){this._canvasContext=this._canvasElement.getContext("2d");
}return this._canvasContext;
},getCanvas:function(){return this.getCanvasElement();
},getImageDataAll:function(){var e=this.getCanvasContext();
var f=this._canvasWrapper.get_size();
return e.getImageData(0,0,f.width,f.height);
},isImageLoaded:function(){return this._canvasLoaded;
},isImageLoading:function(e){return(e.width===d)||(e.src!=""&&(e.complete!==d)&&e.complete===false);
},getDataUrl:function(g){var i=new c.Canvas(this._canvasElement);
var e=i.clone().get_canvas();
var h=this.getCanvasElement();
if(h.style.opacity!=""){var f=e.getContext("2d");
f.save();
f.globalAlpha=h.style.opacity;
f.clearRect(0,0,h.width,h.height);
f.drawImage(h,0,0);
f.restore();
}return e.toDataURL(g);
},getBase64:function(f){var e=this.getDataUrl(f);
return e.substring(e.indexOf("base64,")+7);
},getMimeTypeByExt:function(e){if(!e){return"";
}e=e.toLowerCase();
switch(e){case"jpg":e="jpeg";
case"png":case"jpeg":return"image/"+e;
default:return"image/png";
}},get_width:function(){return this._canvasElement.width;
},get_height:function(){return this._canvasElement.height;
},get_opacity:function(){return this._imageOpacity;
},get_flipDirection:function(){return this._getFlipDirection(this._flipH,this._flipV);
},set_flipDirection:function(f){var e=this._getFlipDirections(f);
this._flipH=e.flipH;
this._flipV=e.flipV;
},get_rotationAngle:function(){return this._rotationAngle;
},get_rotation:function(){return this._getRotationFromAngle(this.get_rotationAngle());
},_applyChangesOnServer_Canvas:function(i,g,e,h){var f=i?this._constructSaveImageData(g,h):{};
this._doServerOperation(a.extend({name:"SaveCanvas",key:this.get_imageKey()},f),Function.createDelegate(this,this._finishSave),null);
},_finishSave:function(e,h){var g=h.alertMessage;
var f=!g;
this.raiseEvent("serverSaved",new c.SavedEventArgs(h.fileName,f,g,h.args));
},_constructSaveImageData:function(g,i){var f=this._getExtFromFileNameObj(g);
var h=this.getMimeTypeByExt(f);
var e={base64:this.getBase64(h),overwrite:i==true?"1":"0",fName:typeof(g)=="string"?g:f?g.name:""};
if(f){e.ext=f;
}return e;
},_getExtFromFileNameObj:function(e){return(e&&e.ext)||this.options.imageFormat;
},_getDownloadKey:function(){return 2;
},_doServerOperation:function(g,e,h){if(!this._canDoServerOperation){return;
}this._canDoServerOperation=false;
var f=this._serializeData(g);
var i=Function.createDelegate(this,Function.createCallback(this._finishOperation,e));
WebForm_DoCallback(this._xmlHttpPanel._uniqueId,f,i,{data:g},function(){},false);
},_finishOperation:function(h,f,e){this._canDoServerOperation=true;
var g=this._readJson(h);
if(this._raiseServerOperationCompleted(g,f).get_cancel()){return;
}if(typeof(e)=="function"){e.call(this,f.data,g);
}this._alertMessage(g.alertMessage);
},_createCanvasElement:function(){var f=this._getCanvasWrapper();
var e=f.get_canvas();
if(!f.supportsCanvas()){e.innerHTML="<p style='font-size:25px;'>"+$telerik.htmlEncode(this.options.canvasNotSupportedString)+"</p>";
this.getImage().style.display="none";
}this._canvasElement=e;
},_loadImageInCanvas:function(){var e=new Image();
a(e).on("load",a.proxy(this._loadImageInCanvasHandler,this));
e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
e.src=this._image.src;
this._canvasImage=e;
},_loadImageInCanvasHandler:function(){this._setImageInCanvas();
this._raiseImageReloadEvent();
a(this._canvasImage).off("load",this._loadImageInCanvasHandler);
this._canvasImage=null;
},_setImageInCanvas:function(){var f=this._canvasImage;
if(!this._canvasWrapper.supportsCanvas()){return;
}this._canvasWrapper.set_size(f.width||10,f.height||10);
var e=this.getCanvasContext();
e.drawImage(f,0,0);
this._canvasLoaded=true;
},_getCanvasWrapper:function(){if(!this._canvasWrapper){this._canvasWrapper=new c.Canvas(this.options.id);
}return this._canvasWrapper;
},_setOpacity:function(f){var e=this.getCanvasElement();
e.style.opacity=f/100;
this._imageOpacity=f;
},_storeInitialState:function(){this._storeInitialStateDelegate=Function.createDelegate(this,this._storeInitialStateLoadHandler);
if(this.isImageLoaded()){this._storeInitialStateDelegate();
}else{this.add_imageReload(this._storeInitialStateDelegate);
}this._imageOpacity=100;
},_storeInitialStateLoadHandler:function(){var e=this.getCanvasContext();
this._initialStateData=e.getImageData(0,0,this.get_width(),this.get_height());
this.remove_imageReload(this._storeInitialStateDelegate);
},_storeOpacityImageMap:function(){var e=this.getCanvasElement();
var j=[];
var f=this.getCanvasContext();
var g=f.getImageData(0,0,e.width,e.height).data;
for(var h=3;
h<g.length;
h+=4){j.push(g[h]);
}e.opacityImageMap=j;
},_restoreInitialState:function(){var g=this._initialStateData;
var e=this.getCanvasElement();
e.width=g.width;
e.height=g.height;
this.zoom(100,true);
this._rotationAngle=0;
this.set_flipDirection(c.FlipDirection.None);
this._resetCanvasCss();
this._imageOpacity=100;
var f=this.getCanvasContext();
f.putImageData(this._initialStateData,0,0);
},_resetCanvasCss:function(){var e=this.getCanvasElement().style;
e.opacity=e.width=e.height="";
},_getDefaultId:function(){return this._getDefaultPrefixId()+"_canvas";
},_getDefaultPrefixId:function(){var e=this.getImage();
return e.id||("editableImage"+(c.EditableCanvas._idCounter++)+"_");
}};
c.EditableCanvas._idCounter=1;
c.EditableCanvas.registerClass("Telerik.Web.UI.ImageEditor.EditableCanvas",c.EditableImageBase,c.IEditableImage);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b,d){b.EditableImage=function(e,g,f){b.EditableImage.initializeBase(this,[e,g,f]);
};
b.EditableImage.prototype={initialize:function(){b.EditableImage.callBaseMethod(this,"initialize");
this._attachToImageLoad(true);
this._setOriginalSwapImageOperation();
this._width=null;
this._height=null;
this._opacity=null;
this._rotationAngle=null;
this._viewMatrix=b.Matrix3x3.identityMatrix.clone();
this._reloadEventCallbacks=[];
this._customInitialize();
},dispose:function(){b.EditableImage.callBaseMethod(this,"dispose");
},getCanvas:function(){return this.getImage();
},_customInitialize:function(){if($telerik.isIE&&!$telerik.isIE9Mode){this._image.style.filter="flipH flipV progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=100) progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingmethod='auto expand')";
this._image.filters.item("flipH").enabled=0;
this._image.filters.item("flipV").enabled=0;
}},changeOpacity:function(f,e){if(e){e.set_currentOpacity(f);
}else{e=new b.OpacityOperation(this,f,this.get_opacity());
}return this._applyOperation(e);
},resize:function(h,e,f){if(f){f.set_size(h,e);
}else{f=new b.ResizeOperation(this,h,e);
}var g=this._applyOperation(f);
this._isResized=false;
return g;
},rotate:function(g,e,f){if(f){f.set_rotation(g,e);
}else{f=new b.RotateOperation(this,g,e);
}return this._applyOperation(f);
},flip:function(f,e,g){if(g){g.set_flipDirection(f);
}else{g=new b.FlipOperation(this,f,e);
}return this._applyOperation(g);
},crop:function(f){var e=new b.CropOperation(this,"",f);
this._doServerOperation(a.extend({name:"Crop",key:this.get_imageKey()},f),function(){},e);
return e;
},addText:function(g,h,f){var e=new b.AddTextOperation(this,"");
this._doServerOperation({name:"AddText",key:this.get_imageKey(),x:g,y:h,text:f.get_text(),font:f.get_fontFamily(),color:f.get_color(),size:f.get_fontSize()},null,e);
return e;
},insertImage:function(h,i,g,f){var e=new b.InsertImageOperation(this,"");
if(!f){f=[];
}this._doServerOperation({name:"InsertImage",key:this.get_imageKey(),value:g,arrayOps:this._imageEditor._operationSerializer.serializeOperationStack(f),x:h,y:i},null,e);
return e;
},reset:function(e){var g=this._getOriginalSwapImageOperation();
var f=a(this.getImage());
f.data("key",d);
f.attr("src","");
this._resetCSS();
this._doServerOperation({name:"Reset"},Function.createDelegate(this,this._finishReset),g);
},_finishReset:function(){this._width=null;
this._height=null;
this._applySize("","");
},_resetCSS:function(){this._flipV=false;
this._flipH=false;
this._rotationAngle=0;
this._opacity=100;
this._width=null;
this._height=null;
this._zoomLevel=100;
this._applySize("","");
this._changeOpacity();
this._flip();
this._rotate();
},zoomBestFit:function(g,e,f){b.EditableImage.callBaseMethod(this,"zoomBestFit",[g,e,f]);
},zoom:function(i,e){i=(i==null||typeof(i)=="undefined")?this.get_zoomLevel():i;
if(!e&&i==this._zoomLevel){return;
}this._zoomLevel=i;
var h=i/100;
var g=this._getWidth()*h;
var f=this._getHeight()*h;
this._updateTransformOrigin(this.getImage(),this.get_rotationAngle(),g,f);
this._applySize(g,f);
},get_width:function(){if(this._getIsHorizontal()){return this._getWidth();
}else{return this._getHeight();
}},_getWidth:function(){if(this._width==null){var e=this.getImage();
var f=e.style.OTransform;
if($telerik.isOpera&&(f.indexOf("90deg")!=-1||f.indexOf("270deg")!=-1)){this._width=e.height;
}else{this._width=e.width;
}}return this._width;
},get_height:function(){if(this._getIsHorizontal()){return this._getHeight();
}else{return this._getWidth();
}},_getHeight:function(){if(this._height==null){var e=this.getImage();
var f=e.style.OTransform;
if($telerik.isOpera&&(f.indexOf("90deg")!=-1||f.indexOf("270deg")!=-1)){this._height=e.width;
}else{this._height=e.height;
}}return this._height;
},get_opacity:function(){if(this._opacity==null){var g=this.getImage();
var f=($telerik.isIE9Mode)?null:g.filters;
if(f){var e=f.item("DXImageTransform.Microsoft.Alpha");
if(e){this._opacity=e.opacity;
}}else{this._opacity=(g.style.opacity==""||g.style.MozOpacity=="")?100:parseInt((g.style.opacity||g.style.MozOpacity)*100,10);
}}return this._opacity;
},get_flipDirection:function(){var g=this._getIsHorizontal();
var e=g?this._flipH:this._flipV;
var f=g?this._flipV:this._flipH;
return this._getFlipDirection(e,f);
},_getAbsFlipDirection:function(){return this._getFlipDirection(this._flipH,this._flipV);
},get_rotationAngle:function(){if(this._rotationAngle==null){var j=($telerik.isIE9Mode)?null:this.getImage().filters;
if(j){var i=j.item("DXImageTransform.Microsoft.Matrix");
if(i){var g=Math.acos(i.M11);
var e=Math.round((g*360)/(2*Math.PI));
var f=Math.round((Math.asin(i.M21)*360)/(2*Math.PI));
e=f==-90?270:e;
this._rotationAngle=e;
}}else{var l=this.getImage().style.transform;
var k=0;
if(l&&l.indexOf("rotate")!=-1){var h=l.substring(l.indexOf("rotate(")+7,l.indexOf("deg"));
k=parseInt(h,10);
}this._rotationAngle=k;
}}return this._rotationAngle;
},get_rotation:function(){return this._getRotationFromAngle(this.get_rotationAngle());
},get_viewMatrix:function(){return this._viewMatrix;
},set_viewMatrix:function(e){this._viewMatrix=e;
},saveOnClient:function(f){var h=this.get_url();
if(h){var e=this._constructDownloadParams(f);
if(h.indexOf("Telerik.Web.UI.WebResource.axd?type=iec")!=-1){this.downloadUrl(h+e+"1");
}else{var g=document.location+"";
g=g.substring(0,g.lastIndexOf("/")+1);
this.downloadUrl(g+"Telerik.Web.UI.WebResource.axd?type=iec"+e+this._imageEditor._downloadKey);
}}},downloadUrl:function(e){document.location=e;
},applyChangesOnServer:function(h,f,e,g){this._applyChangesOnServer_Img(h,f,e,g);
},_applyChangesOnServer_Img:function(j,g,e,i){this._clientSave={c:e,n:g};
var f=j==true?this._constructSaveImageData(g,i):{};
var h=new b.SwapImageOperation(this,"");
h._canUndo=false;
this._doServerOperation(a.extend({name:"Save",key:this.get_imageKey()},f),Function.createDelegate(this,this._finishSave),h);
if(j||e){this.getImage().src="";
this._resetCSS();
}},_finishSave:function(){},_constructSaveImageData:function(f,h){var g=f&&f.ext;
var e={save:"1",overwrite:h==true?"1":"0",fName:typeof(f)=="string"?f:g?f.name:""};
if(g){e.ext=f.ext;
}return e;
},_setInternalSize:function(f,e){this._width=f;
this._height=e;
},_setSize:function(f,e){this._isResized=true;
if(this._getIsHorizontal()){this._setInternalSize(f,e);
}else{this._setInternalSize(e,f);
}this._applySize(f,e);
this._updateTransformOrigin(this.getImage(),this.get_rotationAngle(),parseInt(f,10),parseInt(e,10));
this.zoom(this.get_zoomLevel(),this._isResized);
},_applySize:function(f,e){this.getImage().style.width=f==""?"":f+"px";
this.getImage().style.height=e==""?"":e+"px";
},_setOpacity:function(e){this._opacity=e;
this._changeOpacity();
},_changeOpacity:function(g,i){if(!g){g=this.getImage();
}if(typeof(i)=="undefined"||i==null){i=this._opacity;
}var f=($telerik.isIE9Mode)?null:g.filters;
if(f){var e=f.item("DXImageTransform.Microsoft.Alpha");
if(e){e.opacity=i;
}}else{var h=(i/100);
g.style.opacity=h;
g.style.MozOpacity=h;
}},_setFlipDirection:function(g,e){var f=this._getFlipDirections(g);
if(e||this._flipV==this._flipH){this._flipV=f.flipV;
this._flipH=f.flipH;
}else{if(f.flipH==f.flipV){this._flipH=this._flipV=f.flipH;
}else{this._flipV=(this._flipV||f.flipV);
this._flipH=(this._flipH||f.flipH);
}}this._flip(null,this._flipH,this._flipV);
},_flip:function(h,e,g){if(!h){h=this.getImage();
}var f=($telerik.isIE9Mode)?null:h.filters;
var i=this.get_rotationAngle();
if(e==null||typeof(e)=="undefined"){e=this._flipH;
g=this._flipV;
}if(f){f.item("flipH").enabled=e?1:0;
f.item("flipV").enabled=g?1:0;
}else{this._updateCssTransform(e,g,i,h,true);
}},_updateCssTransform:function(e,f,k,h,i){if(!h){h=this.getImage();
}var n=h.width;
var g=h.height;
var j=h.style.OTransform;
if($telerik.isOpera&&(j.indexOf("90deg")!=-1||j.indexOf("270deg")!=-1)){if(h.style.width){n=parseInt(h.style.width,10);
g=parseInt(h.style.height,10);
}else{var l=n;
n=g;
g=l;
}}this._updateTransformOrigin(h,k,n,g);
var m=k!=0?"rotate("+k+"deg)":"";
m+=e?" scaleX(-1)":"";
m+=f?" scaleY(-1)":"";
if(m=="rotate(90deg) scaleX(-1)"||m=="rotate(90deg) scaleX(-1) scaleY(-1)"){m+=" translateX("+(((g/n)-1)*100)+"%)";
}if(m=="rotate(270deg) scaleY(-1)"||m=="rotate(270deg) scaleX(-1) scaleY(-1)"){m+=" translateY("+(((n/g)-1)*100)+"%)";
}h.style.MozTransform=m;
h.style.OTransform=m;
h.style.WebkitTransform=m;
h.style.transform=m;
if($telerik.isIE9Mode){h.style["-ms-transform"]=m;
}this._updateViewMatrix(e,f,k);
},_updateTransformOrigin:function(f,g,i,e){if(f){var h=this._getTransformOrigin(g,i,e);
f.style.MozTransformOrigin=h;
f.style.OTransformOrigin=h;
f.style.WebkitTransformOrigin=h;
f.style.transformOrigin=h;
if($telerik.isIE9Mode){f.style["-ms-transform-origin"]=h;
}}},_getTransformOrigin:function(g,h,e){var f="50% 50%";
if(g==90){f=(e/2)+"px 50%";
}else{if(g==270){f="50% "+(h/2)+"px";
}}return f;
},_getIsHorizontal:function(){var e=this.get_rotationAngle();
return(e==0||e==180);
},_setRotationAngle:function(e){this._rotationAngle=e;
this._rotate();
},_rotate:function(j,l){if(!j){j=this.getImage();
}if(l==null||typeof(l)=="undefined"){l=this.get_rotationAngle();
}var i=this._getFlipDirections(this.get_flipDirection());
var h=($telerik.isIE9Mode)?null:j.filters;
if(h){var g=h.item("DXImageTransform.Microsoft.Matrix");
if(g){var f=Math.PI*2/360;
var k=l*f;
var e=Math.cos(k);
var m=Math.sin(k);
g.M11=e;
g.M12=-m;
g.M21=m;
g.M22=e;
}}else{this._updateCssTransform(i.flipH,i.flipV,l,j);
}},_transformBounds:function(f){var e=new Telerik.Web.UI.Bounds(f.x,f.y,f.width,f.height);
var j=this.get_viewMatrix();
var i=j.multiplyVector([e.x,e.y]);
var h=j.multiplyVector([e.x+e.width,e.y+e.height]);
var g=new Telerik.Web.UI.Bounds(Math.min(i[0],h[0]),Math.min(i[1],h[1]),Math.abs(h[0]-i[0]),Math.abs(h[1]-i[1]));
return g;
},_updateViewMatrix:function(e,f,j){e=e||this.flipH;
f=f||this.flipV;
j=j||this.get_rotationAngle();
var h=this.getImage();
var i=[h.width,h.height];
var g=[i[0]/2,i[1]/2];
var k=b.Matrix3x3.identityMatrix.clone();
this._addTranslation(k,j==90||j==270?[-g[1],-g[0]]:[-g[0],-g[1]]);
if(j){k=b.Matrix3x3["rotate"+j+"Matrix"].multiply(k);
}if(e){k=b.Matrix3x3.flipXMatrix.multiply(k);
}if(f){k=b.Matrix3x3.flipYMatrix.multiply(k);
}this._addTranslation(k,g);
this.set_viewMatrix(k);
},_applyViewTransformation:function(e){this.set_viewMatrix(e.multiply(this.get_viewMatrix()));
},_addTranslation:function(e,f){e.m13+=f[0];
e.m23+=f[1];
},_imageLoadedHandler:function(e){b.EditableImage.callBaseMethod(this,"_imageLoadedHandler",[e]);
if(this._clientSave&&this._clientSave.c){this.saveOnClient(this._clientSave.n);
this._clientSave={};
}},doServerOperation:function(j,k,i,e){if(!this._canDoServerOperation){return;
}var l=new b.SwapImageOperation(this,"");
var g=j||"Custom";
var h=k||g;
var f=i||"";
l.get_name=function(){return g;
};
l.get_text=function(){return h;
};
this._doServerOperation({name:g,key:this.get_imageKey(),commandArgument:f},e,l);
return l;
},_doServerOperation:function(g,e,h){if(!this._canDoServerOperation){return;
}this._canDoServerOperation=false;
g.clientOps=this._imageEditor._operationSerializer.serializeLastClientOperations(this._imageEditor._undoStack);
if(this._imageEditor){g.undoLimitKey=this._imageEditor._undoLimitKey;
this._imageEditor._undoLimitKey="";
this._imageEditor._lowerUndoBound=0;
}var f=this._serializeData(g);
var i=Function.createDelegate(this,Function.createCallback(this._finishOperation,e));
WebForm_DoCallback(this._xmlHttpPanel._uniqueId,f,i,{data:g,operation:h},function(){},false);
},_finishOperation:function(j,f,e){this._canDoServerOperation=true;
var g=this._readJson(j);
if(this._raiseServerOperationCompleted(g,f).get_cancel()){return;
}f.operation.set_key(g.key);
f.operation.set_src(g.url);
if(this._applyOperation(f.operation)){if(typeof(e)=="function"){e.call(this,f.data,g);
}}if(g.serverUrl){this.set_serverUrl(g.serverUrl);
}if(f.data.name=="Save"&&this._imageEditor){var h=true;
var i=g.alertMessage;
if(i&&!g.serverUrl){h=false;
}else{i=this._imageEditor._getMessage("SaveServer");
}this._imageEditor.raiseEvent("saved",new b.SavedEventArgs(g.fileName,h,i,g.args));
}this._alertMessage(g.alertMessage);
},_getOriginalSwapImageOperation:function(){if(typeof(this._originalSwapImageOperation)==="undefined"){this._originalSwapImageOperation=new b.SwapImageOperation(this,this._getSrcAttr());
this._originalSwapImageOperation._canUndo=false;
}return this._originalSwapImageOperation;
},_setOriginalSwapImageOperation:function(){var f=this._getSrcAttr();
var e=Function.createDelegate(this,function(){this._originalSwapImageOperation=new b.SwapImageOperation(this,f);
this._originalSwapImageOperation._canUndo=false;
this.remove_imageReload(e);
});
this.add_imageReload(e);
this._useCacheBuster();
},_useCacheBuster:function(){var f=this._getSrcAttr();
if(!f){return;
}if(f.indexOf("Telerik.Web.UI.WebResource.axd?type=iec")!=-1){return;
}var e=(f.indexOf("?")==-1?"?c=":"&c=")+Math.random();
this.getImage().src=f+e;
}};
b.EditableImage.registerClass("Telerik.Web.UI.ImageEditor.EditableImage",b.EditableImageBase,b.IEditableImage);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.ImageOperationSerializer=function(d){this.imageEditor=d;
};
b.ImageOperationSerializer.prototype={serializeOperationStack:function(d){return"["+d.join(",")+"]";
},serializeUndoStack:function(m,d){if(!d){return"[]";
}var h={};
var g=m.length;
for(var e=0;
e<g;
e++){var k=m[e];
if(k.get_name()=="Rotate"){k.set_index(1);
}h[k.get_name()]=k;
}var l="";
for(var j in h){var f=h[j];
if(f.getIsClientOperation()){l+=f.toString(d)+",";
}}l=l?"["+l.slice(0,-1)+"]":"[]";
return l;
},serializeLastClientOperations:function(d){return this.serializeClientOperations(this.getLastClientOperations(d));
},getLastClientOperations:function(g){var d=[];
for(var e=g.length-1;
e>=0;
e--){var f=g[e];
if(f.getIsClientOperation()){d.unshift(f);
}else{break;
}}return d;
},serializeClientOperations:function(k){var h={};
for(var e=0;
e<k.length;
e++){var g=k[e];
if(g.get_name()=="Rotate"){g.set_index(1);
}h[g.get_name()]=g;
}var d=this.imageEditor.getEditableImage();
var j="";
for(var f in h){j+=h[f].toString(d)+",";
}return j?"["+j.slice(0,-1)+"]":"[]";
},deserializeOperationStack:function(h){var g=[];
var d=this.deserializeJson(h);
for(var e=0,f=d.length;
e<f;
e++){g.push(this.deserializeOperation(d[e]));
}return g;
},deserializeOperation:function(e){var d=this.deserializeJson(e);
return this._initializeOperation(d);
},_initializeOperation:function(d){var e=this.createOperationByName(d.name);
e.fromData(d);
return e;
},createOperationByName:function(d){var e=this.getOperationClassByName(d);
if(e){return new e(this.imageEditor.getEditableImage());
}else{return null;
}},getOperationClassByName:function(d){return c.ImageEditor[d+"Operation"]||null;
},deserializeJson:function(d){return typeof(d)=="string"?Sys.Serialization.JavaScriptSerializer.deserialize(d):d;
}};
b.ImageOperationSerializer.registerClass("Telerik.Web.UI.ImageEditor.ImageOperationSerializer");
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI");
(function(a,b){$telerik.toImageEditor=function(c){return c;
};
$telerik.findImageEditor=$find;
Telerik.Web.UI.RadImageEditor=function(c){Telerik.Web.UI.RadImageEditor.initializeBase(this,[c]);
this._postbackButtonElement=null;
this._toolsPanel=null;
this._toolBarPanel=null;
this._toolGroups=[];
this._tools=null;
this._xmlHttpPanel=null;
this._currentCommand=null;
this._location=null;
this._height="500px";
this._width="750px";
this._enableResize=true;
this._isOurRequest=false;
this._shortCutManager=null;
this._originalDockToolbarWidth="600px";
this._tabIndex=0;
this._accessKey="";
this._undoLimitKey="";
this._downloadKey="";
this._lowerUndoBound=0;
this._imageFormat=null;
this._isDialogMoved=false;
this._canvasNotSupportedString="";
this._image=null;
this._editableImage=null;
this._undoStack=[];
this._redoStack=[];
this._operationSerializer=new b.ImageEditor.ImageOperationSerializer(this);
};
Telerik.Web.UI.RadImageEditor.prototype={initialize:function(){Telerik.Web.UI.RadImageEditor.callBaseMethod(this,"initialize");
this._attachToolbarHandlers(true);
this._attachToolbarPanelHandlers(true);
this._attachToolsPanelHandlers(true);
this._attachXmlHttpPanelHandlers(true);
this._attachPageRequestManagerHandlers();
var c=this.get_toolsPanel();
c._form.appendChild(c.get_element());
this._createIEditableImage();
this._prepareEditableEnvironment();
this._statusBar=new b.ImageEditor.StatusBar(this._getChildElement("SB"),this);
this._attachToImageLoad(true);
this._createUndoRedoStacks();
this._setRightToLeft();
this._configureToolbar();
this.set_height(this._getMaxHeight());
this.set_width(this.get_width());
this._makeResizable();
this._createDraggableImage();
this._createScrollToZoom();
this._registerShortcuts();
this.raiseEvent("load",Sys.EventArgs.Empty);
},dispose:function(){if(this._currentToolWidget){this._currentToolWidget.dispose();
this._currentToolWidget=null;
}if(this._statusBar){this._statusBar.dispose();
}this._attachShortcutHandlers(false);
this._shortCutManager=null;
this._detachToolbarButtonClicked();
Telerik.Web.UI.RadImageEditor.callBaseMethod(this,"dispose");
this._attachToImageLoad(false);
},repaint:function(){this.set_height(this._getMaxHeight());
this._configureToolbar();
},saveClientState:function(){var h=["currentCommand","imageKey","serverImageUrl","height","width","enableResize","toolBarPosition","isf"];
var j={};
var f=h.length;
for(var d=0;
d<f;
d++){var g=h[d];
j[g]=this["get_"+g]();
}this._saveUndoRedoClientState(j);
var c=this.getEditableImage();
var e=c.get_imageKey();
if(e){j.imageKey=e;
}if(this.get_serverImageUrl()!=c.get_serverUrl()){j.imageUrl=c.get_serverUrl();
}return Sys.Serialization.JavaScriptSerializer.serialize(j);
},_saveUndoRedoClientState:function(c){if(!this.useCanvas()){c.clientOps=this._operationSerializer.serializeLastClientOperations(this._undoStack);
}},_createIEditableImage:function(){this._editableImage=this.useCanvas()?new b.ImageEditor.EditableCanvas(this.getImage(),$find(this.get_id()+"_eiXHPanel"),{id:this.get_id()+"_canvas",imageFormat:this._imageFormat,canvasNotSupportedString:this._canvasNotSupportedString}):new b.ImageEditor.EditableImage(this.getImage(),$find(this.get_id()+"_eiXHPanel"),this);
this._editableImage.set_serverUrl(this.get_serverImageUrl());
this._attachEditableImageEvents();
},_configureToolbar:function(){var h=this._statusBar._element;
if(h&&Sys.UI.DomElement.containsCssClass(h.parentNode,"RadImageEditor")){a("div.rieZoneLeft").css("top","20px");
a("div.rieZoneRight").css("top","20px");
}this._handleToolbarExternalDOM();
this._attachToolbarButtonClicked();
this._localizeToolbar();
var k=this.get_toolBarPanel();
if(k){if(!k.get_dockZoneID()){k._form.appendChild(k.get_element());
}k.get_contentContainer().parentNode.setAttribute("colSpan","3");
var j=0;
var o=this.get_toolGroupsLength();
var l=this.get_toolGroups();
for(var e=0;
e<o;
e++){j+=l[e].get_element().offsetWidth;
}if(j>0){if(o>1){var m=parseInt(this.get_width(),10);
k.set_width((j>m?m:j));
}else{k._width=j+"px";
l[0].get_element().style.width="100%";
}this._originalDockToolbarWidth=k._width;
}}var d;
var c=null;
if(this.get_toolBarMode()==b.ImageEditor.ToolBarMode.Default){d="";
c=this.get_toolBarContainer();
}else{d="auto 5px";
}var p=this.get_viewport();
p.style.margin=d;
var n=this.get_toolBarPosition();
if(n==b.ImageEditor.ToolBarPosition.Top||n==b.ImageEditor.ToolBarPosition.Bottom){this._setToolbarOrientation(b.Orientation.Horizontal);
}else{this._setToolbarOrientation(b.Orientation.Vertical);
if(k){k.set_width(this._getVerticalDockWidth());
}if(c){this._setViewPortMargin(c,(this._getVerticalDockWidth()+4)+"px");
}else{var f=this.get_leftZone();
var g=this.get_rightZone();
if(f&&f.get_element().children.length>2){p.style.marginLeft=(this._getVerticalDockWidth()+4)+"px";
}else{if(g&&g.get_element().children.length>2){p.style.marginRight=(this._getVerticalDockWidth()+4)+"px";
}}}}},_localizeToolbar:function(){if(!this.supportsCanvas()){this._disableCanvasTools();
}},_disableCanvasTools:function(){var c=this._canvasNotSupportedString;
var d=this._disableParentSplitButton;
a.each(this.get_canvasTools(),function(e,f){f.set_enabled(false);
f.set_toolTip(c);
d(f,c);
});
},_disableParentSplitButton:function(g,c){var f=g.get_parent();
if(f.getDefaultButton){var d=f.get_buttons().toArray();
var e=a.grep(d,function(h){return h.get_isEnabled();
}).length>0;
if(!e){f.set_enabled(false);
f.set_toolTip(c);
}}},_handleToolbarExternalDOM:function(){a("div.RadToolBarDropDown").addClass("RadImageEditor");
},_attachToolbarButtonClicked:function(){var d=this.get_toolGroups();
var c=this._toolbarButtonClickDelegate=Function.createDelegate(this,this._toolButtonClick);
Array.forEach(d,function(e){e.add_buttonClicking(c);
});
},_detachToolbarButtonClicked:function(){var c=this._toolbarButtonClickDelegate;
Array.forEach(this.get_toolGroups(),function(d){d.remove_buttonClicking(c);
},this);
this._toolbarButtonClickDelegate=null;
},_toolButtonClick:function(h,c){var e=c.get_item();
var g=e.get_parent();
if(g.getDefaultButton&&g.getDefaultButton()){var d="rie"+g.getDefaultButton().get_commandName();
var f="rie"+e.get_commandName();
$telerik.$(g.get_linkElement()).removeClass(d).addClass(f);
}},_getVerticalDockWidth:function(){var c=this.get_rightZone();
var d=this.get_toolBarContainer().offsetWidth;
if(c){return c.get_element().offsetWidth;
}return d;
},_setRightToLeft:function(){var c=null;
var d=this.get_element();
if(d){c=$telerik.isRightToLeft(d);
}this._isRightToLeft=c;
if(c){Sys.UI.DomElement.addCssClass(d,"rieRtl");
}},requestToolWidget:function(c){var d=this.get_toolsLoadPanelType();
if(d=="AjaxPanel"){this.initAjaxRequest(c);
}else{if(d=="RadAjaxPanel"){this.initRadAjaxRequest(c);
}else{this.initCallback(c);
}}},initAjaxRequest:function(d,c){if(!this._isOurRequest||c){this._isOurRequest=true;
this._ajaxRequestInited=true;
this._showAjaxLoadingPanel();
__doPostBack(this.get_postbackButtonElement().getAttribute("name"),d);
}},initCallback:function(d,c){if(!this._isOurRequest||c){this._isOurRequest=true;
this._showAjaxLoadingPanel();
this.get_xmlHttpPanel().set_value(d);
}},initRadAjaxRequest:function(d,c){if(!this._isOurRequest||c){this._isOurRequest=true;
this._ajaxRequestInited=true;
this._showAjaxLoadingPanel();
this.get_ajaxPanel().ajaxRequest(d);
}},_showAjaxLoadingPanel:function(){var c=this.get_ajaxLoadingPanel();
if(c){c.get_element().style.paddingBottom="7px";
var d=this.get_toolsPanel();
d.get_contentContainer().style.minHeight="52px";
$telerik.getElementByClassName(d.get_element(),"rdMiddle","tr").id=this.get_id()+"_rdMiddle";
c.show(this.get_id()+"_rdMiddle");
}},openToolsPanel:function(){var c=this.get_toolsPanel();
if(!this._isDialogMoved||(c.get_top()==0&&c.get_left()==0)){var h=this.get_location();
var l=$telerik.getClientBounds();
var d=270;
if(this._renderMode===Telerik.Web.UI.RenderMode.Lite){var e=this.getFontSize();
c.get_element().style.fontSize=e+"px";
}var i=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);
var f=l.width+i;
var g=this._isRightToLeft?h.x-280:h.x+470;
if(f-(g)>d){c.set_left(g);
}else{c.set_left(i+10);
}var j=Math.max(document.documentElement.scrollTop,document.body.scrollTop);
var k=(h.y+70>j)?h.y+70:j+10;
c.set_top(k);
}c.set_closed(false);
},getFontSize:function(){var c=this.get_element();
return parseInt($telerik.getComputedStyle(c,"fontSize"),10);
},closeToolsPanel:function(){this.get_toolsPanel().set_closed(true);
},setToggleState:function(d,e){if(!d){return;
}if(d.get_checked){d.set_checked(e);
}else{var c=this.get_tools()[d];
if(c&&c.get_checked){c.set_checked(e);
}}},getImage:function(){if(!this._image){this._image=this._getChildElement("EditableImage");
}return this._image;
},getEditableImage:function(){return this._editableImage;
},getEditableElement:function(){return this.getCanvasElement()||this.getImage();
},fire:function(d,c){var f=c&&c.get_domEvent?c.get_domEvent():null;
var g=new b.ImageEditor.CancelEventArgs(f,d);
this.raiseEvent("commandExecuting",g);
if(g.get_cancel()){return;
}var e=b.ImageEditor.CommandList[d];
if(e){e(this,d,c);
}else{alert("Could not find the command "+d+". Please update your command list.");
}this.raiseEvent("commandExecuted",new b.ImageEditor.EventArgs(f,d));
},executeCommand:function(c){if(this._isOurRequest||this._isCommandOpen(c)){return;
}if(this._currentToolWidget&&!this._isCurrentCommand(c)){this._currentToolWidget.onClose();
this._currentToolWidget.dispose();
this._currentToolWidget=null;
}this.openToolsPanel();
this.setToggleState(c,true);
if(!this._currentToolWidget){this.requestToolWidget(c);
}this.set_currentCommand(c);
},_isCommandOpen:function(c){return this._isCurrentCommand(c)&&!this.get_toolsPanel().get_closed();
},_isCurrentCommand:function(c){return this._currentToolWidget&&this._currentToolWidget.get_name()==c;
},undo:function(c){this._undo(c||1);
},redo:function(c){this._redo(c||1);
},resetChanges:function(){var c=this._preExecuteOperation("Reset",true,false);
if(c.cancel){return;
}var d=this.getEditableImage();
this.set_imageKey("");
d.set_serverUrl(this.get_serverImageUrl());
this._clearCommandsToRedo();
this._clearCommandsToUndo();
this._enableDisableUndoRedoTools();
d.reset(this.get_clientImageUrl());
this.updateClientState();
this._statusBar.setValue("None","lastAction");
this._statusBar.setValue("100","zoom");
var e=this;
window.setTimeout(function(){e._statusBar._updateSizeInternal();
if(e._currentToolWidget){e._currentToolWidget.updateUI();
}},0);
this._executeOperation(null,false,false,{CommandName:"Reset"});
},changeImageOpacity:function(c,d){this._changeImageOpacity(c,true,d);
},flipImage:function(c,e,d){this._flipImage(c,true,e,d);
},flipHorizontal:function(){var c=this.getEditableImage().get_flipDirection();
switch(c){case b.ImageEditor.FlipDirection.None:c=b.ImageEditor.FlipDirection.Horizontal;
break;
case b.ImageEditor.FlipDirection.Horizontal:c=b.ImageEditor.FlipDirection.None;
break;
case b.ImageEditor.FlipDirection.Vertical:c=b.ImageEditor.FlipDirection.Both;
break;
default:c=b.ImageEditor.FlipDirection.Vertical;
break;
}this.flipImage(c,true);
},flipVertical:function(){var c=this.getEditableImage().get_flipDirection();
switch(c){case b.ImageEditor.FlipDirection.None:c=b.ImageEditor.FlipDirection.Vertical;
break;
case b.ImageEditor.FlipDirection.Horizontal:c=b.ImageEditor.FlipDirection.Both;
break;
case b.ImageEditor.FlipDirection.Vertical:c=b.ImageEditor.FlipDirection.None;
break;
default:c=b.ImageEditor.FlipDirection.Horizontal;
break;
}this.flipImage(c,true);
},rotateImage:function(c,d){this._rotateImage(c,true,d);
},rotateLeft90:function(){var c=this.getEditableImage().get_rotationAngle()-90;
if(c<0){c=c+360;
}this._rotateImage(null,true,true,c);
},rotateRight90:function(){var c=this.getEditableImage().get_rotationAngle()+90;
if(c==360){c=0;
}this._rotateImage(null,true,true,c);
},resizeImage:function(e,c,d){this._resizeImage(e,c,true,d);
},zoomImage:function(d,c){this._zoomImage(parseInt(d,10),c);
},zoomIn:function(){var c=parseInt(this.getEditableImage().get_zoomLevel()/50,10)*50+50;
if(c>this.get_upperZoomBound()){c=this.get_upperZoomBound();
}this.zoomImage(c,true);
},zoomOut:function(){var c=parseInt(this.getEditableImage().get_zoomLevel()/50,10)*50-50;
if(c<this.get_lowerZoomBound()){c=this.get_lowerZoomBound();
}this.zoomImage(c,true);
},zoomBestFit:function(){var c=this.getEditableImage();
if(c){var d=this.get_viewport();
c.zoomBestFit(d.offsetWidth,d.offsetHeight,this.get_upperZoomBound());
this._statusBar.setValue(c.get_zoomLevel(),"zoom");
this._executeOperation(null,false,true,{CommandName:"Zoom"});
}},insertImage:function(e,f,c,d){this._insertImage(e,f,c,d);
},applyFilter:function(d){var c=this._preExecuteOperation("Filter",{filter:d},false);
if(c.cancel){return;
}d=c.args.get_argument().filter;
this._applyFilter(d,true);
},saveImageOnClient:function(c){var d=this.get_allowedSavingLocation();
if(d==b.ImageEditor.AllowedSavingLocation.ClientAndServer||d==b.ImageEditor.AllowedSavingLocation.Client){this._applyChangesOnServer(true,false,c);
}},saveImageOnServer:function(c,d){var e=this.get_allowedSavingLocation();
if(e==b.ImageEditor.AllowedSavingLocation.ClientAndServer||e==b.ImageEditor.AllowedSavingLocation.Server){this._applyChangesOnServer(false,true,c,d);
}},applyChangesOnServer:function(){this._applyChangesOnServer();
},editImageOnServer:function(e,f,d,c){this._editImageOnServer(e,f,d,c);
},get_toolsPanel:function(){if(this._toolsPanel){return this._toolsPanel;
}else{this._toolsPanel=this._findChildControl("ToolsPanel");
return this._toolsPanel;
}},get_toolBarPanel:function(){if(this._toolBarPanel){return this._toolBarPanel;
}else{this._toolBarPanel=this._findChildControl("ToolbarPanel");
return this._toolBarPanel;
}},get_topZone:function(){if(this._topZone){return this._topZone;
}else{this._topZone=this._findChildControl("ZoneTop");
return this._topZone;
}},get_rightZone:function(){if(this._rightZone){return this._rightZone;
}else{this._rightZone=this._findChildControl("ZoneRight");
return this._rightZone;
}},get_bottomZone:function(){if(this._bottomZone){return this._bottomZone;
}else{this._bottomZone=this._findChildControl("ZoneBottom");
return this._bottomZone;
}},get_leftZone:function(){if(this._leftZone){return this._leftZone;
}else{this._leftZone=this._findChildControl("ZoneLeft");
return this._leftZone;
}},get_toolGroups:function(){var d=this.get_toolGroupsLength();
if(this._toolGroups.length!=d){for(var c=0;
c<d;
c++){Array.add(this._toolGroups,this._getToolbarControl(c));
}}return this._toolGroups;
},_getToolbarControl:function(c){if(this.get_toolBarMode()==b.ImageEditor.ToolBarMode.Default){return this._findChildControl("ToolGroup"+c);
}else{return this._findChildControl("ToolbarPanel_C_ToolGroup"+c);
}},get_tools:function(){if(!this._tools){this._tools={};
var f=this.get_toolGroups();
var g=f.length;
for(var c=0;
c<g;
c++){var h=f[c].get_allItems();
var e=h.length;
for(var d=0;
d<e;
d++){if(!h[d].get_isSeparator||!h[d].get_isSeparator()){this._tools[h[d].get_commandName()]=h[d];
}}}}return this._tools;
},_canvasToolNames:["Pencil","Line","DrawCircle","DrawRectangle","BrightnessContrast","HueSaturation","Greyscale","InvertColor","Sepia","Blur","Sharpen"],get_canvasTools:function(){var d=[];
var c=this._canvasToolNames;
var h=this.get_tools();
for(var e=0;
e<c.length;
e++){var f=c[e];
var g=h[f];
if(g){d.push(g);
}}return d;
},get_currentCommand:function(){return this._currentCommand;
},set_currentCommand:function(d){var c=this._currentCommand!=d;
this._currentCommand=d;
if(this.get_isInitialized()&&c){this._currentCommand=d;
}},get_currentToolWidget:function(){return this._currentToolWidget;
},set_currentToolWidget:function(c){this._currentToolWidget=c;
},get_xmlHttpPanel:function(){if(!this._xmlHttpPanel){this._xmlHttpPanel=$find(this.get_id()+"_ToolsPanel_C_XHPanel");
}return this._xmlHttpPanel;
},get_ajaxPanel:function(){if(!this._ajaxPanel){this._ajaxPanel=$find(this.get_id()+"_ToolsPanel_C_RadAjaxPanel");
}return this._ajaxPanel;
},get_ajaxLoadingPanel:function(){if(!this._ajaxLoadingPanel){this._ajaxLoadingPanel=this._findChildControl("RALP");
}return this._ajaxLoadingPanel;
},get_formDecorator:function(){if(!this._formDecorator){this._formDecorator=$find(this.get_id()+"_FormDecorator");
}return this._formDecorator;
},get_resizeHandle:function(){if(!this._resizeHandle){this._resizeHandle=this._getChildElement("ResizeHandle");
}return this._resizeHandle;
},get_toolBarContainer:function(){if(!this._toolBarContainer){this._toolBarContainer=$telerik.getElementByClassName(this.get_element(),"rieToolBar","div");
}return this._toolBarContainer;
},get_viewport:function(){if(!this._viewport){this._viewport=this._getChildElement("Viewport");
}return this._viewport;
},get_postbackButtonElement:function(){if(!this._postbackButtonElement){this._postbackButtonElement=$get(this.get_postbackButton());
}return this._postbackButtonElement;
},get_operationsToUndo:function(){return this._undoStack;
},get_operationsToRedo:function(){return this._redoStack;
},get_isUndoAvailable:function(){return(this._undoStack.length>this._lowerUndoBound);
},get_isRedoAvailable:function(){return(this._redoStack.length>0);
},get_enableResize:function(){return this._enableResize;
},set_enableResize:function(d){this._enableResize=d;
this._makeResizable();
var c=this.get_resizeHandle();
if(d){c.style.cursor="";
Sys.UI.DomElement.addCssClass(c,"rieResizeHandle");
}else{c.style.cursor="default";
Sys.UI.DomElement.removeCssClass(c,"rieResizeHandle");
}if(this.get_isInitialized()){this.updateClientState();
}},get_minHeight:function(){return 300;
},get_minWidth:function(){return 585;
},get_top:function(){return this.get_location().y;
},get_left:function(){return this.get_location().x;
},get_location:function(c){if(c||!this._location){this._location=!$telerik.isOpera?$telerik.getLocation(this.getEditableElement()):$telerik.originalGetLocation(this.getEditableElement());
}return this._location;
},get_height:function(){return this._height;
},set_height:function(d){if(d==""){return;
}var c=this.get_isInitialized();
if(d.toString().indexOf("%")>-1){this._height=parseInt(d,10)+"%";
if(c){this.get_viewport().style.height=this._height;
}}else{d=parseInt(d,10);
this._height=parseInt(d,10)+"px";
if(c){this.get_viewport().style.height=(d-this._getDeltaHeight())+"px";
}}this._setDockZonesMinHeight();
if(c){this.get_element().style.height="";
this.updateClientState();
}},get_width:function(){return this._width;
},set_width:function(c){if(c==""){return;
}if(c.toString().indexOf("%")>-1){this._width=parseInt(c,10)+"%";
}else{this._width=parseInt(c,10)+"px";
}if(this.get_isInitialized()){this.get_element().style.width=this._width;
this.updateClientState();
}if(this._width=="100%"){this.get_element().style.width="auto";
}},_createScrollToZoom:function(){var c=this.getEditableImage();
this._scrollToZoom=new b.ImageEditor.ScrollToZoom(this.get_viewport(),{maxZoomLevel:this.get_upperZoomBound(),minZoomLevel:this.get_lowerZoomBound(),getZoomLevel:a.proxy(c.get_zoomLevel,c),onZoom:a.proxy(this._scrollToZoomHandler,this)});
},_scrollToZoomHandler:function(c){this.zoomImage(c,true);
},_createDraggableImage:function(){var d=this.get_viewport();
var c=this;
this._scrollExtender=new b.TouchScrollExtender(d);
b.ImageEditor.extendMethod(this._scrollExtender,"_startDrag",function(){if(!this._dragCanceled){d.style.cursor="move";
}});
b.ImageEditor.extendMethod(this._scrollExtender,"_endDrag",function(){if(!this._dragCanceled){d.style.cursor="default";
c._focus(c.get_element());
}});
this._scrollExtender.initialize();
},_undo:function(c){if(c>this._undoStack.length-this._lowerUndoBound){c=this._undoStack.length-this._lowerUndoBound;
}if(c>this._undoStack.length){c=this._undoStack.length;
}var e=this._undoStack.splice(this._undoStack.length-c,c);
if(this._getLastServerOperation(e)){this._undoFromServerOperation(e);
}else{this._simpleUndo(e);
}var d=this._undoStack[this._undoStack.length-1];
this._statusBar.setValue((d?d.get_text():"None"),"lastAction");
this._statusBar._updateSizeInternal();
this.updateClientState();
if(this._currentToolWidget){this._currentToolWidget.updateUI();
}this._enableDisableUndoRedoTools();
},_simpleUndo:function(d){while(d.length){var c=d.pop();
c.undo();
this._redoStack.push(c);
this._updateUndoRedoDropDowns("Redo",c);
}if(this.useCanvas()){this._editableImage.forceCurrentZoom();
}},_undoFromServerOperation:function(h){for(var c=h.length-1;
c>=0;
c--){var g=h[c];
this._redoStack.push(g);
this._updateUndoRedoDropDowns("Redo",g);
}var d=this._operationSerializer.getLastClientOperations(this._undoStack);
var f=this._undoStack.length-d.length-1;
var e=f>-1?this._undoStack[f]:this.getEditableImage()._getOriginalSwapImageOperation();
d.unshift(e);
while(d.length){d.shift().execute();
}},_getLastServerOperation:function(e){for(var c=e.length-1;
c>=0;
c--){var d=e[c];
if(!d.getIsClientOperation()){return d;
}}return null;
},_redo:function(c){if(c>this._redoStack.length){c=this._redoStack.length;
}var d;
while(0<c--){d=this._redoStack.pop();
d.execute();
this._undoStack.push(d);
this._updateUndoRedoDropDowns("Undo",d);
}if(d){this._statusBar.setValue(d.get_text(),"lastAction");
}this.updateClientState();
if(this._currentToolWidget){this._currentToolWidget.updateUI();
}if(this.useCanvas()){this._editableImage.forceCurrentZoom();
}this._enableDisableUndoRedoTools();
},_updateUndoRedoDropDowns:function(d,e){var i=this.get_tools();
var k=i.Undo;
var g=i.Redo;
if(this._shouldModifyUndoRedoDropDowns&&k&&g){var j=k.get_buttons?k.get_buttons():null;
var f=g.get_buttons?g.get_buttons():null;
var c=(d=="Undo"||d==null)?j:f;
var h=d=="Redo"?j:f;
if(d!=null){window.setTimeout(function(){if(h){h.removeAt(0);
}},0);
}else{d="Undo";
}if(c){c.insert(0,this._createToolBarButton(e.get_text(),d));
}}},_createUndoRedoStacks:function(){this._enableDisableUndoRedoTools();
},_enableDisableUndoRedoTools:function(){var d=this.get_tools();
var e=d.Undo;
if(e){e.set_enabled(this.get_isUndoAvailable());
}var c=d.Redo;
if(c){c.set_enabled(this.get_isRedoAvailable());
}},_clearCommandsToRedo:function(){if(this.get_isRedoAvailable()){var d=this.get_tools();
var c=d?d.Redo:null;
if(c&&c.get_buttons){c.hideDropDown();
c.get_buttons().clear();
}this._redoStack.splice(0,this._redoStack.length);
}},_clearCommandsToUndo:function(){if(this.get_isUndoAvailable()){var c=this.get_tools();
var d=c?c.Undo:null;
if(d&&d.get_buttons){d.hideDropDown();
d.get_buttons().clear();
}this._undoStack.splice(0,this._undoStack.length);
}},_createUndoRedoDropDown:function(g,f,e){var c=g.get_buttons();
c.clear();
var d=f.length;
if(typeof(e)==="undefined"){e=0;
}while(e<d--){c.add(this._createToolBarButton(f[d].get_text(),g.get_commandName()));
}},_createToolBarButton:function(e,d){var c=new Telerik.Web.UI.RadToolBarButton();
c.set_text(e);
c.set_commandName(d);
return c;
},_changeImageOpacity:function(e,c,f){var d=this._preExecuteOperation("Opacity",e,f);
if(d.cancel){return;
}e=d.args.get_argument();
f=d.args.get_updateUI();
this._operation=this.getEditableImage().changeOpacity(e,this._operation);
this._executeOperation(this._operation,c,f);
},_flipImage:function(e,c,g,f){var d=this._preExecuteOperation("Flip",e,g);
if(d.cancel){return;
}e=d.args.get_argument();
g=d.args.get_updateUI();
this._operation=this.getEditableImage().flip(e,f,this._operation);
this._executeOperation(this._operation,c,g);
},_rotateImage:function(f,c,g,d){var e=this._preExecuteOperation("Rotate",f,g);
if(e.cancel){return;
}f=e.args.get_argument();
g=e.args.get_updateUI();
this._operation=this.getEditableImage().rotate(f,d,this._operation);
this._statusBar.updateSize();
this._executeOperation(this._operation,c,g);
},_resizeImage:function(h,f,c,g){var d=this._preExecuteOperation("Resize",{width:h,height:f},g);
if(d.cancel){return;
}h=d.args.get_argument().width;
f=d.args.get_argument().height;
g=d.args.get_updateUI();
var e=this.getEditableImage();
this._operation=e.resize(h,f,this._operation);
this._statusBar.updateSize(e.get_width(),e.get_height());
this._executeOperation(this._operation,c,g);
},_zoomImage:function(f,e){var c=this._preExecuteOperation("Zoom",f,e);
if(c.cancel){return;
}f=c.args.get_argument();
e=c.args.get_updateUI();
var d=this.getEditableImage();
d.zoom(f);
this._statusBar.setValue(d.get_zoomLevel(),"zoom");
this._executeOperation(null,false,e,{CommandName:"Zoom"});
},_cropImage:function(c){var d=this._preExecuteOperation("Crop",c,false);
if(d.cancel){return;
}c=d.args.get_argument();
var e=this.getEditableImage();
this._executeOperation(e.crop(c),true,true);
},addTextToImage:function(f,g,e){var c=this._preExecuteOperation("AddText",{x:f,y:g,text:e},false);
if(c.cancel){return;
}f=c.args.get_argument().x;
g=c.args.get_argument().y;
e=c.args.get_argument().text;
var d=this.getEditableImage();
this._executeOperation(d.addText(f,g,e),true,true);
},_insertImage:function(g,h,f,e){var c=this._preExecuteOperation("InsertImage",{x:g,y:h,value:f,operations:e},false);
if(c.cancel){return;
}g=c.args.get_argument().x;
h=c.args.get_argument().y;
f=c.args.get_argument().value;
e=c.args.get_argument().operations;
var d=this.getEditableImage();
this._executeOperation(d.insertImage(g,h,f,e),true,true);
},_applyFilter:function(e,c,f){var d=this.getEditableImage();
this._operation=d.applyFilter(e,this._operation);
this._executeOperation(this._operation,c,f);
},_drawOnCanvas:function(e,c,g,f){var d=this._preExecuteOperation(f,e,g);
if(d.cancel){return;
}e=d.args.get_argument();
this._operation=this.getEditableImage().mergeCanvas(e,f);
this._executeOperation(this._operation,c,g);
},_editImageOnServer:function(f,g,e,c){if(this.useCanvas()){return;
}var h=this.getEditableImage();
if(!h._canDoServerOperation){return;
}var d=this._preExecuteOperation(f,{commandArgument:e,commandText:g},false);
if(d.cancel){return;
}e=d.args.get_argument().commandArgument;
g=d.args.get_argument().commandText;
this._executeOperation(h.doServerOperation(f,g,e,c),true,true);
},_applyChangesOnServer:function(g,h,e,f){var c=g||h;
var d=new b.ImageEditor.SavingEventArgs(c?(g?"SaveClient":"SaveServer"):"ApplyChanges",e,f);
this.raiseEvent("saving",d);
if(d.get_cancel()){return false;
}e=d.get_fileName();
if(this.useCanvas()){this._applyChangesOnServer_Canvas(g,h,e,f,d);
}else{this._applyChangesOnServer_Img(g,h,e,f,d);
}},_applyChangesOnServer_Canvas:function(g,h,e,f,c){var d=this.getEditableImage();
if(h){d.applyChangesOnServer(h,e,g,f);
}else{if(g){d.saveOnClient(e);
this.raiseEvent("saved",new b.ImageEditor.SavedEventArgs(e,true,this._getMessage(c.get_saveAction())));
}}},_applyChangesOnServer_Img:function(h,i,e,g,c){var d=this.getEditableImage();
var f=this._undoStack.length!=0&&this._undoStack[this._undoStack.length-1].getIsClientOperation();
if(f||i){d.applyChangesOnServer(i,e,h,g);
this._clearCommandsToRedo();
this._clearCommandsToUndo();
this._enableDisableUndoRedoTools();
}else{if(h){d.saveOnClient(e);
this.raiseEvent("saved",new b.ImageEditor.SavedEventArgs(e,true,this._getMessage(c.get_saveAction())));
}}},_getMessage:function(c){switch(c){case"SaveClient":return"The image was saved successfully on the client";
case"SaveServer":return"The image was saved successfully on the server";
default:return"Changes applied successfully";
}},_preExecuteOperation:function(d,f,i){var c=new b.ImageEditor.ImageChangeCancelEventArgs(null,d,f,i);
this.raiseEvent("imageChanging",c);
if(c.get_cancel()){if(this._currentToolWidget){this._currentToolWidget.updateUI();
}return{cancel:true,args:c};
}var g=this._undoStack.length;
var h=this.get_undoLimit();
var e=g>=h?this._undoStack[g-h]:null;
if(e&&!e.getIsClientOperation()){this._undoLimitKey=e.get_key();
}return{cancel:false,args:c};
},_executeOperation:function(f,c,g,d){if(c){this._updateUndoRedoDropDowns(null,f);
var h=this.get_undoLimit();
if(h!=0&&this._undoStack.length>=h+this._lowerUndoBound){this._lowerUndoBound++;
var i=this.get_tools()["Undo"];
if(i&&i.get_buttons){i.get_buttons().removeAt(h);
}}this._undoStack.push(f);
this._statusBar.setValue(f.get_text(),"lastAction");
this._clearCommandsToRedo();
this._enableDisableUndoRedoTools();
this._operation=null;
this.updateClientState();
}if(g&&this._currentToolWidget){this._currentToolWidget.updateUI();
}var e=new b.ImageEditor.ImageChangeEventArgs(null,d?d.CommandName:f.get_name(),f);
this.raiseEvent("imageChanged",e);
},_closeToolsPanelAndSaveCommand:function(c){this.closeToolsPanel();
this.set_currentCommand(c);
},_getMaxHeight:function(){var f=this.get_toolBarPanel();
if(f&&f.get_dockZoneID()==""){return this._height;
}var c=this._getDeltaHeight();
var d=parseInt(this.get_height(),10)-c;
var e=this._getToolbarControl(0);
var g=e?e.get_element().parentNode.offsetHeight:null;
if(g&&g>d){d=g+c+(f?10:0);
}return d>parseInt(this._height,10)?d:this._height;
},_attachToolbarHandlers:function(e){var f=this.get_toolGroups();
if(e){var d=f.length;
for(var c=0;
c<d;
c++){f[c].add_buttonClicking(Function.createDelegate(this,this._preventToolbarButtonClick));
f[c].add_buttonClicked(Function.createDelegate(this,this._toolBarButtonClicked));
f[c].add_dropDownOpening(Function.createDelegate(this,this._undoRedoToolOpening));
}}},_preventToolbarButtonClick:function(d,c){c.set_cancel(this._isOurRequest);
},_toolBarButtonClicked:function(d,c){var e=c.get_item();
this.fire(e.get_commandName(),c);
},_undoRedoToolOpening:function(e,c){var f=c.get_item();
var d=f.get_commandName();
if(!this._shouldModifyUndoRedoDropDowns){if(d=="Undo"){this._createUndoRedoDropDown(f,this.get_operationsToUndo(),this._lowerUndoBound);
this._shouldModifyUndoRedoDropDowns=true;
}else{if(d=="Redo"){this._createUndoRedoDropDown(f,this.get_operationsToRedo());
this._shouldModifyUndoRedoDropDowns=true;
}}this._setDropDownCssClass();
}},_setDropDownCssClass:function(){var d=this.get_tools();
var e=d.Undo;
var c=d.Redo;
if(e){if(e.get_buttons){Sys.UI.DomElement.addCssClass(e.get_dropDownElement(),"rieDropDown");
}}if(c){if(c.get_buttons){Sys.UI.DomElement.addCssClass(c.get_dropDownElement(),"rieDropDown");
}}},_attachToolbarPanelHandlers:function(c){var d=this.get_toolBarPanel();
if(c&&d){d.add_dragEnd(Function.createDelegate(this,this._onToolbarDragEnd));
d.add_enterZone(Function.createDelegate(this,this._onEnterZone));
d.add_leaveZone(Function.createDelegate(this,this._onLeaveZone));
}},_onEnterZone:function(d,c){this._setViewPortMargin(c.dockZone.get_element(),(this._getVerticalDockWidth()+4)+"px");
},_onLeaveZone:function(d,c){this._setViewPortMargin(c.dockZone.get_element(),"5px");
},_setViewPortMargin:function(c,d){if(Sys.UI.DomElement.containsCssClass(c,"rieZoneLeft")){this.get_viewport().style.marginLeft=d;
}else{if(Sys.UI.DomElement.containsCssClass(c,"rieZoneRight")){this.get_viewport().style.marginRight=d;
}}},_onToolbarDragEnd:function(f,c){var i=f.get_dockZoneID();
if(i){var h=this.get_viewport();
var d=i.indexOf("ZoneRight")!=-1;
var g=this.get_toolBarPosition();
if(d||i.indexOf("ZoneLeft")!=-1){if(g==b.ImageEditor.ToolBarPosition.Top||g==b.ImageEditor.ToolBarPosition.Bottom){this._originalDockToolbarWidth=f._width;
}f._width=this._getVerticalDockWidth()+"px";
this._setToolbarOrientation(b.Orientation.Vertical);
var e=f.get_element().offsetHeight;
if(e>parseInt(h.style.height,10)){this.set_height(e+this._getDeltaHeight());
}g=d?b.ImageEditor.ToolBarPosition.Right:b.ImageEditor.ToolBarPosition.Left;
}else{if(f.get_dockZone().get_fitDocks()){f._width=this._originalDockToolbarWidth;
}else{f.set_width(this._originalDockToolbarWidth);
}this._setToolbarOrientation(b.Orientation.Horizontal);
g=i.indexOf("ZoneTop")!=-1?b.ImageEditor.ToolBarPosition.Top:b.ImageEditor.ToolBarPosition.Bottom;
}this.set_toolBarPosition(g);
}this.updateClientState();
this._focus(this.get_element());
},get_isf:function(){var c=this.get_toolBarPanel();
if(c){return(c.get_dockZoneID()==""?"1":"0");
}return"0";
},_setToolbarOrientation:function(e){var f=this.get_toolGroups();
if(f){var d=f.length;
for(var c=0;
c<d;
c++){var g=f[c];
g.set_orientation(e);
}}},_attachToolsPanelHandlers:function(c){var d=this.get_toolsPanel();
if(c&&d){d.add_command(Function.createDelegate(this,this._toolsPanelEventHandler));
d.add_dragEnd(Function.createDelegate(this,this._onDockDragEnd));
}},_onDockDragEnd:function(d,c){this._isDialogMoved=true;
this._focus(this.get_element());
},_toolsPanelEventHandler:function(d,c){if(c.command.get_name()=="Close"){if(d.get_closed()){this._toolsPanelClosed(d,c);
}else{this._toolsPanelOpen(d,c);
}}},_toolsPanelClosed:function(f,c){var d=this.get_currentCommand();
this.setToggleState(d,false);
this.set_currentCommand(null);
var g=this.get_currentToolWidget();
if(g){g.onClose();
}var e=new b.ImageEditor.EventArgs(null,d);
this.raiseEvent("toolsDialogClosed",e);
},_toolsPanelOpen:function(d,c){var e=this.get_currentToolWidget();
if(e){e.onOpen();
}},_attachXmlHttpPanelHandlers:function(c){this._ToolsPanelResponseEndedDelegate=Function.createDelegate(this,this._xmlPanelResponseEnded);
var d=this.get_xmlHttpPanel();
if(c&&d){d.add_responseEnded(this._ToolsPanelResponseEndedDelegate);
}},_xmlPanelResponseEnded:function(d,c){if(this._isOurRequest){this._hideAjaxLoadingPanel();
var e=this._createToolWidget(this.get_currentCommand());
this._currentToolWidget=e;
this._setupToolPanel();
this._currentToolWidget.updateUI();
this.raiseEvent("dialogLoaded",new b.ImageEditor.DialogLoadedEventArgs(e));
}this._isOurRequest=false;
},_hideAjaxLoadingPanel:function(){var c=this.get_ajaxLoadingPanel();
if(c){var d=this.get_toolsPanel();
d.get_contentContainer().style.minHeight="";
this.get_ajaxLoadingPanel().hide(this.get_id()+"_rdMiddle");
}},_attachPageRequestManagerHandlers:function(){var c=Sys.WebForms.PageRequestManager.getInstance();
if(c){this._beginRequestDelegate=Function.createDelegate(this,this._beginRequest);
c.add_beginRequest(this._beginRequestDelegate);
var d=this.get_toolsLoadPanelType();
if(d=="AjaxPanel"||d=="RadAjaxPanel"){this._handleToolAjaxLoadDelegate=Function.createDelegate(this,this._handleToolAjaxLoad);
c.add_endRequest(this._handleToolAjaxLoadDelegate);
}}},_attachToImageLoad:function(c){if(c){if(this._editableImage.isImageLoaded()){this.raiseImageLoadEvent();
}this._imageLoadedDelegate=Function.createDelegate(this,this._imageLoadedHandler);
this._editableImage.add_imageReload(this._imageLoadedDelegate);
}else{this._editableImage.remove_imageReload(this._imageLoadedDelegate);
delete this._imageLoadedDelegate;
}},_attachEditableImageEvents:function(){this._editableImageServerSavedDelegate=Function.createDelegate(this,this._editableImageServerSavedHandler);
this._editableImage.add_serverSaved(this._editableImageServerSavedDelegate);
},_detachEditableImageEvents:function(){this._editableImage.remove_serverSaved(this._editableImageServerSavedDelegate);
delete this._editableImageServerSavedDelegate;
},_imageLoadedHandler:function(d){this.raiseImageLoadEvent();
if(this._statusBar){var c=this.getEditableImage();
if(c){this._statusBar.updateSize(c.get_width(),c.get_height());
}if(this._currentToolWidget&&this._currentToolWidget.get_name()=="Resize"){this._currentToolWidget.updateUI();
}}this.updateClientState();
},_editableImageServerSavedHandler:function(d,c){var e=c.message||this._getMessage("SaveServer");
var f=new b.ImageEditor.SavedEventArgs(c.get_fileName(),c.get_isSaved(),e,c.get_argument());
this.raiseEvent("saved",f);
},raiseImageLoadEvent:function(){this.raiseEvent("imageLoad",Sys.EventArgs.Empty);
},_beginRequest:function(e,c){if(!this._ajaxRequestInited){var d=this.get_element();
d.appendChild(this.get_toolsPanel().get_element());
var f=this.get_toolBarPanel();
if(f&&!f.get_dockZoneID()){d.appendChild(f.get_element());
}e.remove_beginRequest(this._beginRequestDelegate);
this._beginRequestDelegate=null;
}this._ajaxRequestInited=false;
},_handleToolAjaxLoad:function(f,c){try{$telerik.evalScripts(this.get_toolsPanel().get_element(),this._ToolsPanelResponseEndedDelegate);
}catch(d){}},_getDeltaHeight:function(){var e=this.get_resizeHandle().parentNode;
var i=this.get_toolBarContainer();
var f=this._getChildElement("SB");
var k=b.ImageEditor.ToolBarPosition;
var j=this.get_toolBarPosition();
var c=0;
var h=this._getToolbarControl(0);
var g=h?h.get_element():null;
var d;
if(g!=null){d=g.style.cssFloat;
g.style.cssFloat="none";
}c=(j==k.Top||j==k.Bottom?i.offsetHeight:0)+(this.get_toolBarMode()==b.ImageEditor.ToolBarMode.Docked?this.get_bottomZone().get_element().offsetHeight:0)+e.offsetHeight+(f&&f.parentNode.className!=e.className?f.offsetHeight:0);
if(d){g.style.cssFloat=d;
}return c;
},_setDockZonesMinHeight:function(){var d=this._findChildControl("ZoneRight");
var c=this._findChildControl("ZoneLeft");
if(c){d.get_element().style.minHeight=this.get_viewport().style.height;
c.get_element().style.minHeight=this.get_viewport().style.height;
}},_setupToolPanel:function(){var d=this.get_toolsPanel();
d.set_title(this._currentToolWidget.get_text()||"Tool Dialog");
var c=parseInt(d.get_width(),10);
if(c==180){d.set_width(270);
}else{if(c==220){d.set_width(360);
}else{if(c==200){d.set_width(310);
}}}},_createToolWidget:function(c){return new Telerik.Web.UI.ImageEditor[this.get_currentCommand()](this);
},_makeResizable:function(){if(this._resizeExtender){this._resizeExtender.dispose();
this._resizeExtender=null;
}if(this.get_enableResize()){var c={};
if(this._isRightToLeft){c={sw:this.get_resizeHandle()};
}else{c={se:this.get_resizeHandle()};
}this._resizeExtender=new Telerik.Web.UI.ResizeExtender(this,this.get_element(),c);
this._resizeExtender._autoScrollEnabled=false;
}},onResizeStart:function(){Sys.UI.DomElement.addCssClass(this.get_element(),"rieTopLeftZero");
this._deltaHeight=this._getDeltaHeight()+2;
this.raiseEvent("resizeStart",Sys.EventArgs.Empty);
},onResizeEnd:function(){var c=this.get_element();
Sys.UI.DomElement.removeCssClass(c,"rieTopLeftZero");
c.style.top="";
c.style.left="";
this._height=c.style.height;
this._width=c.style.width;
this.updateClientState();
c.style.height="";
this._setDockZonesMinHeight();
if(this._isRightToLeft){this.get_location(true);
}this.raiseEvent("resizeEnd",new Sys.EventArgs());
},onResizing:function(c){var d=this.get_viewport();
if(c.width<this.get_minWidth()){return false;
}if(c.height<this.get_minHeight()){return false;
}d.style.height=(c.height-this._deltaHeight)+"px";
},addShortCut:function(c,d){if(this._shortCutManager){this._shortCutManager.addShortCut(c,d);
}},removeShortCut:function(c){if(this._shortCutManager){this._shortCutManager.removeShortCut(c);
}},setShortCut:function(c,d){if(this._shortCutManager){this._shortCutManager.setShortCut(c,d);
}},_getDefaultShortCuts:function(){var c=[["Undo","CTRL+Z / CMD+Z"],["Redo","CTRL+Y / CMD+Y"],["CloseToolsPanel","ESC"],["SetToolFocus","F10 / CMD+F10"]];
return c;
},_registerShortcuts:function(f){var d=this;
this._attachShortcutHandlers(f!==false);
if(!this._shortCutManager){var e=this._getDefaultShortCuts().concat(this.get_shortcuts());
a(e).map(function(g,h){h[1]=d._parseShortCut(h[1]);
return h;
});
this._shortCutManager=new b.ShortCutManager(e);
}var c=this.get_element();
c.setAttribute("tabIndex",this._tabIndex.toString());
if(this._accessKey){c.setAttribute("accessKey",this._accessKey);
}},_parseShortCut:function(g){var e=(g+"").replace(/\s/g,""),d=Telerik.Web.Platform;
if(e.indexOf("/")!=-1&&e.indexOf("CMD")!=-1&&e.match(/CTRL|F[\d]/)){var f=e.split("/"),c=f[0].indexOf("CMD")>-1;
if(d&&d.mac){e=c?f[0]:f[1];
}else{e=c?f[1]:f[0];
}}return e;
},_attachShortcutHandlers:function(c){if(c){this._keyDownDelegate=Function.createDelegate(this,this._keyDown);
$addHandler(this.get_element(),"keydown",this._keyDownDelegate);
}else{$removeHandler(this.get_element(),"keydown",this._keyDownDelegate);
this._keyDownDelegate=null;
}},_keyDown:function(c){var f=this._shortCutManager.isShortCutHit(c.rawEvent);
if(!f){return;
}var d=new b.ImageEditor.ShortCutCancelEventArgs(c.rawEvent,f);
this.raiseEvent("shortCutHit",d);
if(!d.get_cancel()){var g=f.get_name();
switch(g){case"CloseToolsPanel":this.closeToolsPanel();
break;
case"SetToolFocus":this._focusToolbar();
break;
default:this.fire(g);
break;
}}$telerik.cancelRawEvent(c.rawEvent);
return false;
},_focusToolbar:function(){var c=this.get_toolBarContainer();
c.setAttribute("tabIndex","0");
this._focus(c);
},_focus:function(c){try{if(c.setActive){c.setActive();
}else{if(c.focus){c.focus();
}}return true;
}catch(d){return false;
}},_prepareEditableEnvironment:function(){var c=a(this.getImage());
if(this.useCanvas()){c.after(this._editableImage.getCanvasElement());
c.hide();
}},getCanvasElement:function(){return this.getEditableImage().getCanvasElement();
},getCanvasContext:function(){return this.getEditableImage().getCanvasContext();
},getBase64:function(c){return this.getEditableImage().getBase64();
},getDataURL:function(c){return this.getEditableImage().getDataUrl();
},useCanvas:function(){var c=this.get_canvasMode();
if(c==b.ImageEditor.CanvasMode.No){return false;
}var d=this.supportsCanvas();
if(c==b.ImageEditor.CanvasMode.Yes){return true;
}return d;
},supportsCanvas:function(){if(!this._ourCanvasObject){this._ourCanvasObject=new b.ImageEditor.Canvas();
}return this._ourCanvasObject.supportsCanvas();
}};
a.registerControlProperties(b.RadImageEditor,{postbackButton:null,toolGroupsLength:0,imageKey:"",serverImageUrl:"",clientImageUrl:"",allowedSavingLocation:b.ImageEditor.AllowedSavingLocation.ClientAndServer,toolsLoadPanelType:"",shortcuts:[],toolBarMode:b.ImageEditor.ToolBarMode.Default,toolBarPosition:b.ImageEditor.ToolBarPosition.Top,defaultInsertedImageUrl:"",undoLimit:0,lowerZoomBound:25,upperZoomBound:400,canvasMode:b.ImageEditor.CanvasMode.Automatic});
a.registerControlEvents(b.RadImageEditor,["load","imageLoad","dialogLoaded","resizeStart","resizeEnd","commandExecuting","commandExecuted","imageChanging","imageChanged","saving","saved","toolsDialogClosed","shortCutHit"]);
Telerik.Web.UI.RadImageEditor.registerClass("Telerik.Web.UI.RadImageEditor",Telerik.Web.UI.RadWebControl);
})($telerik.$,Telerik.Web.UI);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.CanvasOperationBase=function(e,f){this.context=e;
this.options=a.extend({coreFactory:new c.GraphicsCore.CanvasGraphicsCoreFactory(),canUndo:false},f||{});
this._canUndo=false;
this._undoRedoGraphicsCore=this.options.coreFactory.getEditGraphicsCore(this.context);
};
b.CanvasOperationBase.prototype={execute:function(){this.storeState();
this._canUndo=this.options.canUndo;
},undo:function(){this.restoreState();
this._canUndo=false;
},toString:function(){},fromString:function(e){},fromData:function(e){},canUndo:function(){return this._canUndo;
},get_name:function(){},get_text:function(){return this.get_name();
},get_image:function(){},getIsClientOperation:function(){return true;
},dispose:function(){this.context=null;
},_stateContext:null,storeState:function(){if(this.options.canUndo){this._stateContext=this._undoRedoGraphicsCore.cloneCanvas();
}},restoreState:function(){if(this.options.canUndo){this._undoRedoGraphicsCore.clearCanvas();
this._undoRedoGraphicsCore.insertImage(this._stateContext.canvas,0,0);
}}};
b.CanvasOperationBase.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.CanvasOperationBase",null,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.AddTextOperation=function(e,f){b.AddTextOperation.initializeBase(this,[e,f]);
this.options=a.extend({text:new c.ImageText(),x:0,y:0},this.options);
this.graphicsCore=this.options.coreFactory.getDrawTextGraphicsCore(this.context);
};
b.AddTextOperation.prototype={execute:function(){b.AddTextOperation.callBaseMethod(this,"execute");
var f=this.options.text;
var e=f.get_color();
this.graphicsCore.setFillColor(e);
this.graphicsCore.setColor(e);
this.graphicsCore.set_fontFamily(f.get_fontFamily());
this.graphicsCore.set_fontSize(f.get_fontSize());
this.graphicsCore.set_baseline("top");
this.graphicsCore.fillText(f.get_text(),this.options.x,this.options.y,f.get_lineHeight());
},get_name:function(){return"AddText";
}};
b.AddTextOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.AddTextOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.CropOperation=function(e,f){b.CropOperation.initializeBase(this,[e,f]);
this.options=a.extend({bounds:new Telerik.Web.UI.Bounds(0,0,e.canvas.width,e.canvas.height)},this.options);
this.graphicsCore=this.options.coreFactory.getEditGraphicsCore(this.context);
this.originalSize={width:this.context.canvas.width,height:this.context.canvas.height};
};
b.CropOperation.prototype={execute:function(){b.CropOperation.callBaseMethod(this,"execute");
var e=this.options.bounds;
this.graphicsCore.cropCanvas(e.x,e.y,e.x+e.width,e.y+e.height);
},undo:function(){this.context.canvas.width=this.originalSize.width;
this.context.canvas.height=this.originalSize.height;
b.CropOperation.callBaseMethod(this,"undo");
},get_name:function(){return"Crop";
}};
b.CropOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.CropOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.FilterOperation=function(e,f){b.FilterOperation.initializeBase(this,[e,f]);
this.options=a.extend({filter:c.Filters.EmptyPixelFilter.Instance},this.options);
};
b.FilterOperation.prototype={execute:function(){b.FilterOperation.callBaseMethod(this,"execute");
var e=this.context.canvas;
var f=this.context.getImageData(0,0,e.width,e.height);
this.options.filter.execute(f);
this.context.putImageData(f,0,0);
},get_name:function(){return this.options.filter.get_name();
},get_title:function(){return this.get_name();
}};
b.FilterOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.FilterOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,d,b,c,e){b.FlipOperation=function(f,g){this.editableImage=f;
b.FlipOperation.initializeBase(this,[f.getCanvasContext(),g]);
this.options=a.extend({direction:d.FlipDirection.None},this.options);
this.core=this.options.coreFactory.getEditGraphicsCore(this.context);
};
b.FlipOperation.prototype={execute:function(){this.originalFlip=this.editableImage.get_flipDirection();
b.FlipOperation.callBaseMethod(this,"execute");
this.core.flip(this.options.direction);
},undo:function(){b.FlipOperation.callBaseMethod(this,"undo");
this.editableImage.set_flipDirection(this.originalFlip);
},get_name:function(){return"Flip";
},get_text:function(){return this.get_name()+" "+this.get_flipDirectionText();
},set_flipDirection:function(f){this.options.direction=f;
},get_flipDirection:function(){return this.options.direction||d.FlipDirection.None;
},get_flipDirectionText:function(){var f="";
switch(this.get_flipDirection()){case d.FlipDirection.None:f="None";
break;
case d.FlipDirection.Horizontal:f="Horizontal";
break;
case d.FlipDirection.Vertical:f="Vertical";
break;
default:f="Both";
break;
}return f;
}};
b.FlipOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.FlipOperation",b.CanvasOperationBase,d.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.InsertImageOperation=function(e,f){b.InsertImageOperation.initializeBase(this,[e,f]);
this.options=a.extend({image:null,bounds:new Telerik.Web.UI.Bounds(0,0,this.context.canvas.width,this.context.canvas.height)},this.options);
this.graphicsCore=this.options.coreFactory.getEditGraphicsCore(this.context);
};
b.InsertImageOperation.prototype={execute:function(){b.InsertImageOperation.callBaseMethod(this,"execute");
var e=this.options;
this.graphicsCore.insertImage(e.image,e.bounds.x,e.bounds.y,e.bounds.width,e.bounds.height);
},get_name:function(){return"InsertImage";
},get_title:function(){return this.get_name();
}};
b.InsertImageOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.InsertImageOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.MergeCanvasOperation=function(e,f){b.MergeCanvasOperation.initializeBase(this,[e,f]);
this.options=a.extend({canvas:null,name:"Merge Canvas"},this.options);
this.graphicsCore=this.options.coreFactory.getEditGraphicsCore(this.context);
};
b.MergeCanvasOperation.prototype={execute:function(){b.MergeCanvasOperation.callBaseMethod(this,"execute");
var f=this.options;
var e=f.canvas;
this.graphicsCore.insertImage(e,0,0,e.width,e.height);
},get_name:function(){return this.options.name;
},get_title:function(){return this.get_name();
}};
b.MergeCanvasOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.MergeCanvasOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.OpacityOperation=function(e,f){b.OpacityOperation.initializeBase(this,[e,f]);
this.options=a.extend({opacity:100},this.options);
this.graphicsCore=this.options.coreFactory.getEditGraphicsCore(e);
this.filter=new c.Filters.OpacityFilter({opacity:this.options.opacity/100,opacityImageMap:e.canvas.opacityImageMap});
};
b.OpacityOperation.prototype={execute:function(){b.OpacityOperation.callBaseMethod(this,"execute");
var e=this.context.canvas;
var f=this.context.getImageData(0,0,e.width,e.height);
this.filter.execute(f);
this.context.putImageData(f,0,0);
},get_name:function(){return"Opacity";
},get_text:function(){return this.get_name()+" "+this.options.opacity+"%";
}};
b.OpacityOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.OpacityOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,c,b,d){b.ResizeOperation=function(e,f){b.ResizeOperation.initializeBase(this,[e,f]);
if(e){this.options=a.extend({width:e.canvas.width,height:e.canvas.height},this.options);
this._saveOriginalSize();
}this.graphicsCore=this.options.coreFactory.getEditGraphicsCore(this.context);
};
b.ResizeOperation.prototype={execute:function(){var e=this.options;
b.ResizeOperation.callBaseMethod(this,"execute");
this.graphicsCore.resizeCanvas(e.width,e.height);
},undo:function(){this.context.canvas.width=this.originalSize.width;
this.context.canvas.height=this.originalSize.height;
b.ResizeOperation.callBaseMethod(this,"undo");
},_saveOriginalSize:function(){this.originalSize={width:this.context.canvas.width,height:this.context.canvas.height};
},set_size:function(f,e){this._saveOriginalSize();
this.options.width=f;
this.options.height=e;
},get_width:function(){return this.options.width;
},get_height:function(){return this.options.height;
},get_name:function(){return"Resize";
},get_text:function(){return this.get_name()+" "+this.options.width+"x"+this.options.height+"px";
}};
b.ResizeOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.ResizeOperation",b.CanvasOperationBase,c.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.CanvasOperations");
(function(a,d,b,c,e){b.RotateOperation=function(f,g){this.editableImage=f;
b.RotateOperation.initializeBase(this,[f.getCanvasContext(),g]);
this.options=a.extend({rotationAngle:0,imageRotationAngle:0},this.options);
this.core=this.options.coreFactory.getEditGraphicsCore(this.context);
};
b.RotateOperation.prototype={execute:function(){this._saveDimensions();
b.RotateOperation.callBaseMethod(this,"execute");
var f=this._getRotationFromAngle(this.get_rotationAngle());
this.core.rotateCanvas(f);
this.editableImage._rotationAngle=this.options.imageRotationAngle;
},undo:function(){this.context.canvas.width=this.originalSize.width;
this.context.canvas.height=this.originalSize.height;
this.editableImage._rotationAngle=this.originalAngle;
b.RotateOperation.callBaseMethod(this,"undo");
},get_name:function(){return"Rotate";
},get_text:function(){return this.get_name()+" "+this.get_rotationAngle()+" deg";
},get_rotationAngle:function(){return this.options.rotationAngle;
},set_rotationAngle:function(f){this.options.rotationAngle=f;
},_saveDimensions:function(){this.originalSize={width:this.context.canvas.width,height:this.context.canvas.height};
this.originalAngle=this.editableImage.get_rotationAngle();
},_getRotationFromAngle:function(f){var g;
switch(f){case 90:g=d.Rotation.Rotate90;
break;
case 180:g=d.Rotation.Rotate180;
break;
case 270:g=d.Rotation.Rotate270;
break;
default:g=d.Rotation.None;
}return g;
}};
b.RotateOperation.registerClass("Telerik.Web.UI.ImageEditor.CanvasOperations.RotateOperation",b.CanvasOperationBase,d.IImageOperation);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.CanvasOperations,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b,d){b.DraggableResizeBox=function(e){this.set_element(e);
this._cropBounds=null;
this._boxElement=null;
this._createUI();
};
b.DraggableResizeBox.prototype={_createUI:function(){var e=a("<div class='rieDraggableResizeBox'>");
this._appendHandle(e);
this._jBoxElement=e;
this._boxElement=e[0];
this.get_element().appendChild(this._boxElement);
this._setInitialPosition();
this._initializeResizable();
this._initializeDraggable();
},_initializeResizable:function(){var h=this;
var e=h._boxElement;
var f={liveResize:true,useTinyHandles:true,ownerDocument:e.ownerDocument,appendHandleToElement:true,handleSize:6};
var g=h._resizable=new c.Widgets.Resizable(e,f);
h._resizeStartDelegate=Function.createDelegate(h,h._resizableOnResizeStart);
g.add_resizeStart(h._resizeStartDelegate);
h._resizingDelegate=Function.createDelegate(h,h._resizableOnResizing);
g.add_resizing(h._resizingDelegate);
},_resizableOnResizeStart:function(f,e){this._offset=this.getPosition();
this._size=this.getSize();
},_resizableOnResizing:function(n,e){var p=this;
var g=e.get_delta();
var l=p._offset;
var o=p._size;
var f=p.get_constraints();
var m=p.get_sizeRatio();
var h=e.get_direction();
if(m){p._applyRatio(m,e);
}else{var i=h.indexOf("N")>-1;
var j=h.indexOf("W")>-1;
if(!j&&l.left+o.width+g.x>f.width){g.x=f.width-(l.left+o.width);
}if(!i&&l.top+o.height+g.y>f.height){g.y=f.height-(l.top+o.height);
}if(j&&l.left+g.x<f.x){g.x=l.left*(-1);
}if(i&&l.top+g.y<f.y){g.y=l.top*(-1);
}}var k=p._calculateBounds(o,l,g,h);
p._raiseResizeEvent(k);
},_applyRatio:function(k,e){var m=this;
var j=m._offset;
var l=m._size;
var f=m.get_constraints();
var g=e.get_delta();
var h=e.get_direction();
var i=m._isOutsideBounds;
if(h=="NE"){g.y=g.x/k*(-1);
while(i(g,h,j,l,f)){g.x--;
g.y=g.x/k*(-1);
}}else{if(h=="W"){g.y=g.x/k*(-1);
while(i(g,h,j,l,f)){g.x++;
g.y=g.x/k*(-1);
}}else{if(h=="N"){g.x=g.y*k*(-1);
while(i(g,h,j,l,f)){g.y++;
g.x=g.y*k*(-1);
}}else{if(h=="SW"){g.x=g.y*k*(-1);
while(i(g,h,j,l,f)){g.y--;
g.x=g.y*k*(-1);
}}else{if(h=="S"||h=="SE"){g.x=g.y*k;
while(i(g,h,j,l,f)){g.y--;
g.x=g.y*k;
}}else{if(h=="E"){g.y=g.x/k;
while(i(g,h,j,l,f)){g.x--;
g.y=g.x/k;
}}else{if(h=="NW"){g.x=g.y*k;
while(i(g,h,j,l,f)){g.y++;
g.x=g.y*k;
}}}}}}}}},_isOutsideBounds:function(f,g,j,k,e){var h=g.indexOf("N")>-1;
var i=g.indexOf("W")>-1;
return(!i&&j.left+k.width+f.x>e.width)||(!h&&j.top+k.height+f.y>e.height)||(i&&j.left+f.x<e.x)||(h&&j.top+f.y<e.y);
},_calculateBounds:function(k,j,f,g){var h=g.indexOf("N")>-1;
var i=g.indexOf("W")>-1;
var e=new c.Bounds(j.left,j.top,k.width,k.height);
if(h){e.y+=f.y;
e.height+=f.y*(-1);
}else{e.height+=f.y;
}if(i){e.x+=f.x;
e.width+=f.x*(-1);
}else{e.width+=f.x;
}return e;
},_initializeDraggable:function(){var h=this;
var e=h._boxElement;
var g={offsetElement:h.get_element(),ownerDocument:e.ownerDocument};
var f=h._draggable=new c.Widgets.Draggable(e,g);
h._draggingDelegate=Function.createDelegate(h,h._draggableOnDragging);
f.add_dragging(h._draggingDelegate);
},_draggableOnDragging:function(i,e){var f=i._element;
var h=e.get_newPosition();
var g=new c.Bounds(h.x,h.y,f.offsetWidth,f.offsetHeight);
this._raiseResizeEvent(g);
},_raiseDragEvent:function(g,f,i){var j=this,h=j._jsOwner;
if(h&&h["on"+g]){var e=f;
if(!e){e={};
}e.element=j._element;
e.ownerEvent=i;
e.eventIdetifier=j._getTouchEventIdentifier(i);
return h["on"+g](e);
}return true;
},_appendHandle:function(e){e.append(a("<div class='rieDraggableBoxMove'>"));
},_setInitialPosition:function(){var e=a(this.get_element());
this.setBounds({x:e.scrollLeft(),y:e.scrollTop(),width:50,height:50});
},_raiseResizeEvent:function(g){var e=new Sys.EventArgs();
var f=this.getBounds();
e.getBounds=function(){return f;
};
e.get_value=function(){return g;
};
this.raiseEvent("boundsChanged",e);
},show:function(){this.setVisible(true);
},hide:function(){this.setVisible(false);
},dispose:function(){this.disposeResizableWidget();
this.disposeDraggableWidget();
if(this._boxElement.parentNode){this._boxElement.parentNode.removeChild(this._boxElement);
}this._boxElement=this._jBoxElement=null;
},disposeResizableWidget:function(){var e=this;
if(e._resizable){e._resizable.remove_resizing(e._resizingDelegate);
e._resizable.remove_resizeStart(e._resizeStartDelegate);
e._resizable.dispose();
e._resizable=e._resizingDelegate=e._resizeStartDelegate=e._offset=e._size=d;
}},disposeDraggableWidget:function(){var e=this;
if(e._draggable){e._draggable.remove_dragging(e._draggingDelegate);
e._draggable.dispose();
e._draggable=e._draggingDelegate=d;
}},setVisible:function(g){var e=this._boxElement;
e.style.visibility=g?"visible":"hidden";
var f=$telerik.getScrollOffset(e.parentNode);
$telerik.setLocation(e,f);
},getBounds:function(){var e=this.getPosition();
var f=this.getSize();
return new Telerik.Web.UI.Bounds(e.left,e.top,f.width,f.height);
},getPosition:function(){var f=this._jBoxElement.position();
var e=this._jBoxElement.parent();
var g={left:e.scrollLeft(),top:e.scrollTop()};
return{left:f.left+g.left,top:f.top+g.top};
},getSize:function(){return{width:this._jBoxElement.outerWidth(),height:this._jBoxElement.outerHeight()};
},setBounds:function(e){if(e.width<2){e.width=2;
}if(e.height<2){e.height=2;
}$telerik.setBounds(this._boxElement,e);
},get_constraints:function(){return this._constraints;
},set_constraints:function(f){this._constraints=f;
var g=this._draggable;
if(g){var h=g._element;
var e=function(i){return parseFloat($telerik.getComputedStyle(h,"border-"+i+"-width",0));
};
g.set_constraints({minX:f.x,minY:f.y,maxX:f.width-e("left")-e("right"),maxY:f.height-e("top")-e("bottom")});
}},get_maxWidth:function(){var e=this.getBounds();
var f=this.get_constraints();
return f.width-e.x;
},get_maxHeight:function(){var e=this.getBounds();
var f=this.get_constraints();
return f.height-e.y;
},add_boundsChanged:function(e){a(this).bind("boundsChanged",e);
},remove_boundsChanged:function(e){a(this).unbind("boundsChanged",e);
},raiseEvent:function(f,e){a(this).trigger(f,[e]);
},get_sizeRatio:function(){return this._ratio;
},set_sizeRatio:function(e){this._ratio=e;
}};
a.registerControlProperties(b.DraggableResizeBox,{element:null});
b.DraggableResizeBox.registerClass("Telerik.Web.UI.ImageEditor.DraggableResizeBox");
b.DraggableImageResizeBox=function(e){this._imageElement=null;
this._jImageElement=null;
this.IsImageBroken=false;
b.DraggableImageResizeBox.initializeBase(this,[e]);
};
b.DraggableImageResizeBox.prototype={dispose:function(){this.attachHandlers(false);
this._imageElement=this._jImageElement=null;
b.DraggableImageResizeBox.callBaseMethod(this,"dispose");
},_appendHandle:function(e){var f=a("<div class='rieDraggableBoxMove rieDraggableBoxImage'>");
this._jImageElement=a("<img alt='Insert clip art' style='width:100%; height:100%;'>");
f.append(this._jImageElement);
e.append(f);
this._imageElement=this._jImageElement[0];
this.attachHandlers(true);
},_imageLoadHandler:function(f){this.IsImageBroken=false;
this._setInitialSize();
},_imageErrorHandler:function(f){this.IsImageBroken=true;
},_setInitialSize:function(){this._jImageElement.css("width","");
this._jImageElement.css("height","");
this.setSize({width:this._imageElement.width,height:this._imageElement.height});
this._jImageElement.css("width","100%");
this._jImageElement.css("height","100%");
this._raiseResizeEvent(true);
},attachHandlers:function(f){var e=this._imageElement;
if(f){this._imageLoadDelegate=Function.createDelegate(this,this._imageLoadHandler);
$addHandler(e,"load",this._imageLoadDelegate);
this._imageErrorDelegate=Function.createDelegate(this,this._imageErrorHandler);
if($telerik.useAttachEvent(e)){e.attachEvent("onerror",this._imageErrorDelegate);
}else{if(e.addEventListener){e.addEventListener("error",this._imageErrorDelegate,false);
}}}else{$removeHandler(e,"load",this._imageLoadDelegate);
delete this._imageLoadDelegate;
if($telerik.useDetachEvent(e)){e.detachEvent("onerror",this._imageErrorDelegate);
}else{if(e.removeEventListener){e.removeEventListener("error",this._imageErrorDelegate,false);
}}delete this._imageErrorDelegate;
}},set_src:function(e){this._jImageElement.attr("src",e);
this._setInitialSize();
},get_src:function(){if(this._jImageElement){return this._jImageElement.attr("src");
}},setSize:function(e){if(e.width<2){e.width=2;
}if(e.height<2){e.height=2;
}$telerik.setSize(this._boxElement,e);
},get_imageElement:function(){return this._imageElement;
},get_jImageElement:function(){return this._jImageElement;
}};
b.DraggableImageResizeBox.registerClass("Telerik.Web.UI.ImageEditor.DraggableImageResizeBox",b.DraggableResizeBox);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b,d){b.DraggableTextBox=function(e){this.set_container(e);
this._textSettings=new b.ImageText();
this._createUI();
};
b.DraggableTextBox.prototype={dispose:function(){this._disposeResizableWidget();
this._boxContent.remove();
this._boxElement.remove();
this._boxElement=this._boxContent=null;
},_disposeResizableWidget:function(){var f=this;
var e=f._draggable;
if(e){e.remove_dragging(f._draggingDelegate);
e.dispose();
f._draggingDelegate=f._draggable=d;
}},get_text:function(){return this._textSettings.get_text();
},set_text:function(h){this._textSettings.set_text(h);
try{var g=this._formatTextToHtml();
this._boxContent.html(g);
this._updateTextSize();
}catch(f){}},get_textSettings:function(){return this._textSettings;
},set_textSettings:function(e){this._textSettings=e;
this.set_text(e.get_text());
this._updateTextAppearance();
},get_fontFamily:function(){return this._textSettings.get_fontFamily();
},set_fontFamily:function(e){this._textSettings.set_fontFamily(e);
this._updateTextAppearance();
},get_fontSize:function(){return this._textSettings.get_fontSize();
},set_fontSize:function(e){this._textSettings.set_fontSize(e);
this._updateTextAppearance();
},get_color:function(){return this._textSettings.get_color();
},set_color:function(e){this._textSettings.set_color(e);
this._updateTextCss();
},get_lineHeight:function(){this._textSettings.get_lineHeight();
},set_lineHeight:function(e){this._textSettings.set_lineHeight(e);
},get_bounds:function(){var e=this._boxElement;
return new Telerik.Web.UI.Bounds(parseInt(e.css("left"),10),parseInt(e.css("top"),10),parseInt(e.css("width"),10),parseInt(e.css("height"),10));
},set_bounds:function(e){this.set_position(e);
this.set_size(e);
},get_size:function(){var e=this._boxElement;
return{width:parseInt(e.css("width"),10),height:parseInt(e.css("height"),10)};
},set_size:function(e){this._boxElement.css({width:e.width,height:e.height});
},get_position:function(){var e=this._boxElement;
return{x:parseInt(e.css("left"),10),y:parseInt(e.css("top"),10)};
},set_position:function(e){this._boxElement.css({top:e.y,left:e.x});
},show:function(){this._setVisible("visible");
},hide:function(){this._setVisible("hidden");
},add_boundsChanged:function(e){a(this).bind("boundsChanged",e);
},remove_boundsChanged:function(e){a(this).unbind("boundsChanged",e);
},_createUI:function(){this._createBox();
this.set_text(this.get_text());
this._initializeDraggable();
},_createBox:function(){this._boxElement=a('<div class="rieDraggableTextBox"/>');
this._boxContent=a('<span class="rieDraggableTextBoxContent"/>');
this._boxElement.append(this._boxContent);
a(this.get_container()).append(this._boxElement);
},_initializeDraggable:function(){var f=this;
var e=f._draggable=new c.Widgets.Draggable(f._boxElement[0],{offsetElement:f.get_container()});
f._draggingDelegate=Function.createDelegate(f,f._draggableOnDragging);
e.add_dragging(f._draggingDelegate);
},_draggableOnDragging:function(g,e){var f=e.get_newPosition();
a(this).trigger("boundsChanged",a.extendEventArgs(new Sys.EventArgs(),{position:{x:f.x,y:f.y}}));
},_updateTextAppearance:function(){this._updateTextCss();
this._updateTextSize();
},_updateTextCss:function(){this._boxContent.css({fontFamily:this._textSettings.get_fontFamily(),fontSize:this._textSettings.get_fontSize(),color:this._textSettings.get_color()});
},_updateTextBounds:function(){this.set_bounds(this._getUpdatedTextBounds());
},_updateTextSize:function(){this.set_size(this._getUpdatedTextBounds());
},_getUpdatedTextBounds:function(){this._boxElement.css({width:65536});
var e=$telerik.getBounds(this._boxContent[0]);
e.width+=parseInt(this._boxElement.css("padding-left"),10)+parseInt(this._boxElement.css("padding-right"),10)+1;
e.height+=parseInt(this._boxElement.css("padding-top"),10)+parseInt(this._boxElement.css("padding-bottom"),10)+1;
return e;
},_setVisible:function(e){this._boxElement.css({visibility:e});
},_formatTextToHtml:function(){return this.get_text().replace(/\n/g,"<br/>");
}};
a.registerControlProperties(b.DraggableTextBox,{container:a("body")[0]});
b.DraggableTextBox.registerClass("Telerik.Web.UI.ImageEditor.DraggableTextBox");
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.DrawTools");
(function(a,b,c,e){var d=Telerik.Web.BrowserFeatures;
b.BaseDrawTool=function(f,g){this.context=f;
this.canvasDocument=f.canvas.ownerDocument;
this.options=g;
this.drawableContext=null;
this._drawableOffset={x:0,y:0};
this._ieTouchActionManager=new Telerik.Web.UI.Helpers.IETouchActionManager();
this.isDrawing=false;
this.draggables=[];
};
b.BaseDrawTool.prototype={mousedown:function(f){this._removeResizeHandles();
this._calculateCanvasConstants();
this.invokeDrawMethod("start",f);
this.isDrawing=(f.button!=Sys.UI.MouseButton.rightButton);
if(!this.isDrawing){this.recreateDrawableCanvas();
}},mousemove:function(f){if(this.isDrawing){this.invokeDrawMethod("draw",f);
}},mouseup:function(f){if(this.isDrawing){this.invokeDrawMethod("end",f);
this.onEnd(this,f);
this._finishDraw();
this.isDrawing=false;
}},invokeDrawMethod:function(h,g){$telerik.cancelRawEvent(g.rawEvent||g);
var f=this._extractUsefulData(g);
this[h](f);
},start:function(){},draw:function(){},end:function(){},onEnd:function(){},positionHandles:function(){},setupDrawCanvas:function(){this._createEmptyDrawCanvas();
this.attachEvents();
},clearCanvas:function(){this.hideOpacityBackground();
this.recreateDrawableCanvas();
},recreateDrawableCanvas:function(){this._removeDrawableCanvas();
this.setupDrawCanvas();
},showOpacityBackground:function(){if(this.opacityBackgroundNode){return;
}var f=this._createOpacityBackground();
var g=this.drawableContext.canvas;
g.parentNode.insertBefore(f,g);
},hideOpacityBackground:function(){if(this.opacityBackgroundNode){this._removeOpacityBackground();
}},attachEvents:function(){if(!this.drawableContext){return;
}var f=a(this.drawableContext.canvas);
var g=a(this.canvasDocument);
this.mousedownHandler=Function.createDelegate(this,this.mousedown);
this.mousemoveHandler=Function.createDelegate(this,this.mousemove);
this.mouseupHandler=Function.createDelegate(this,this.mouseup);
f.onEvent("down",this.mousedownHandler);
g.onEvent("move",this.mousemoveHandler);
g.onEvent("up",this.mouseupHandler);
f.on("zoom",$telerik.$.proxy(this._onCanvasZoom,this));
},detachEvents:function(){if(!this.drawableContext){return;
}var f=a(this.drawableContext.canvas);
var g=a(this.canvasDocument);
f.offEvent("down",this.mousedownHandler);
g.offEvent("move",this.mousemoveHandler);
g.offEvent("up",this.mouseupHandler);
f.off("zoom");
this.mousedownHandler=this.mousemoveHandler=this.mouseupHandler=null;
},dispose:function(){this.hideOpacityBackground();
this._removeDrawableCanvas();
this._ieTouchActionManager.dispose();
this.context=null;
this.drawableContext=null;
this.canvasDocument=null;
this.opacityBackgroundNode=null;
},_extractUsefulData:function(f){var h=this._drawableOffset;
var i=$telerik.getEventLocation(f);
var g={x:i.pageX-h.x,y:i.pageY-h.y};
var j=this._zoom;
return{x:g.x/j.x,y:g.y/j.y};
},_getScroll:function(){var f=!d.msPointerEvents;
if(f){return{x:$telerik.getDocumentElementScrollLeft(),y:$telerik.getDocumentElementScrollTop()};
}else{return{x:0,y:0};
}},_finishDraw:function(){this._lastDelta=new c.Geometry.Point(0,0);
},_onCanvasZoom:function(){this._calculateCanvasConstants();
this._resizeOpacityBackground();
this._changeDraggableConstraints();
this.positionHandles();
},_calculateCanvasConstants:function(){var g=b.ToolsDom;
var f=this.drawableContext.canvas;
this._drawableOffset=g.calculateOffset(f);
this._zoom=g.getCanvasZoom(f);
},_getCanvasConstraints:function(){var f=this.drawableContext.canvas;
var h=this._resizeHandleHalfSize;
var i=this._viewport2doc(new c.Geometry.Point(0,0));
var g=this._viewport2doc(this._zoomCanvasPos(new c.Geometry.Point(f.width,f.height)));
return{minX:i.x-h,minY:i.y-h,maxX:g.x+h,maxY:g.y+h};
},_getPosFromDraggingArgs:function(f){return this._zoom2canvas(this._doc2viewport(f.get_newPosition()));
},_getNextSmallDelta:function(f){var g=c.Geometry.Point.toPoint(f._delta);
g.reverse(this._lastDelta);
this._lastDelta=c.Geometry.Point.toPoint(f._delta);
return this._zoom2canvas(g);
},_doc2viewport:function(h){var g=this._drawableOffset;
var f=this._resizeHandleHalfSize;
return new c.Geometry.Point((h.x-g.x+f),(h.y-g.y+f));
},_viewport2doc:function(g){var f=this._drawableOffset;
return new c.Geometry.Point(g.x+f.x,g.y+f.y);
},_zoomCanvasPos:function(f){var g=this._zoom;
return new c.Geometry.Point((f.x*g.x),(f.y*g.y));
},_zoom2canvas:function(f){var g=this._zoom;
return new c.Geometry.Point((f.x/g.x),(f.y/g.y));
},_createEmptyDrawCanvas:function(){var g=b.ToolsDom;
var f=g.createDrawableCanvas(this.context.canvas);
this._ieTouchActionManager.element=f;
this._ieTouchActionManager.allowUserTouch();
g.preventViewportOverflow(f.parentNode);
this.drawableContext=f.getContext("2d");
this._calculateCanvasConstants();
},_removeDrawableCanvas:function(){if(!this.drawableContext){return;
}this.detachEvents();
this._ieTouchActionManager.restore();
var f=this.drawableContext.canvas;
var g=b.ToolsDom;
g.restoreViewportOverflow(f.parentNode);
g.remove(f);
this._removeResizeHandles();
},_createResizeHandle:function(h){var f=b.ToolsDom;
h.canvas=this.drawableContext.canvas;
h.container=h.canvas.parentNode;
h.constraints=this._getCanvasConstraints();
var g=f.createResizeHandle(h);
this.draggables.push(g);
if(!this._resizeHandleHalfSize){this._resizeHandleHalfSize=b.ToolsDom.getHandleHalfSize(g._element);
}return g;
},_createMoveHandle:function(g){a.extend(g,{width:21,height:21,border:"3px solid black"});
var f=this._createResizeHandle(g);
f.add_dragEnd(Function.createDelegate(this,this._moveEnd));
return f;
},_moveEnd:function(){this._lastDelta=new c.Geometry.Point(0,0);
},positionResizeHandle:function(f,h){var i=this._zoomCanvasPos(h);
var g=this._resizeHandleHalfSize;
a(f._element).css({left:i.x-g,top:i.y-g});
},_changeDraggableConstraints:function(){var f=this._getCanvasConstraints();
for(var g=0;
g<this.draggables.length;
g++){this.draggables[g].set_constraints(f);
}},_removeResizeHandles:function(){var f=b.ToolsDom;
while(this.draggables.length){f.removeDraggable(this.draggables.pop());
}},_createOpacityBackground:function(){this.opacityBackgroundNode=b.ToolsDom.createOpacityBackground(this.context.canvas);
return this.opacityBackgroundNode;
},_resizeOpacityBackground:function(){var f=this.drawableContext.canvas.style;
b.ToolsDom.resizeOpacityBackground(this.opacityBackgroundNode,f);
},_removeOpacityBackground:function(){b.ToolsDom.remove(this.opacityBackgroundNode);
this.opacityBackgroundNode=null;
}};
b.BaseDrawTool.registerClass("Telerik.Web.UI.ImageEditor.DrawTools.BaseDrawTool");
})($telerik.$,Telerik.Web.UI.ImageEditor.DrawTools,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.DrawTools");
(function(a,b,c,d){b.CircleTool=function(e,f){b.CircleTool.initializeBase(this,[e,f]);
};
b.CircleTool.prototype={defaultFillColor:"transparent",defaultColor:"#000",defaultLineSize:1,setupDrawCanvas:function(){b.CircleTool.callBaseMethod(this,"setupDrawCanvas");
var f=this.graphics?this.graphics.get_fillColor():this.defaultFillColor;
var e=this.graphics?this.graphics.get_color():null;
var g=this.graphics?this.graphics.get_thickness():null;
this.graphics=this.options.coreFactory.getDrawGraphicsCore(this.drawableContext);
this.editGraphics=this.options.coreFactory.getEditGraphicsCore(this.drawableContext);
this.setFillColor(f);
if(e){this.setColor(e);
}if(g){this.setLineSize(g);
}},start:function(e){this.startPos=c.Geometry.Point.toPoint(e);
this.model=new c.Geometry.Circle(this.startPos);
},draw:function(e){this.model.radius=this.model.center.distanceTo(e);
this.drawModel();
},end:function(e){this.draw(e);
this.showResizeHandles();
},drawModel:function(){this.editGraphics.clearCanvas();
var e=this.model;
this.graphics.fillCircle(e.center.x,e.center.y,e.radius);
this.graphics.drawCircle(e.center.x,e.center.y,e.radius);
},drawEditModel:function(){this.positionHandles();
this.drawModel();
},positionHandles:function(){var f=this.model;
var e=f.center;
var g=f.radius;
this.positionResizeHandle(this.nDraggable,new c.Geometry.Point(e.x,e.y-g));
this.positionResizeHandle(this.sDraggable,new c.Geometry.Point(e.x,e.y+g));
this.positionResizeHandle(this.wDraggable,new c.Geometry.Point(e.x-g,e.y));
this.positionResizeHandle(this.eDraggable,new c.Geometry.Point(e.x+g,e.y));
this.positionResizeHandle(this.moveDraggable,e);
},setFillColor:function(e){this.graphics.set_fillColor(e||this.defaultFillColor);
},setColor:function(e){this.graphics.set_color(e||this.defaultColor);
},setLineSize:function(e){this.graphics.set_thickness(e||this.defaultLineSize);
},showResizeHandles:function(){var f=this.model;
var e=f.center;
var h=f.radius;
var g={dragging:Function.createDelegate(this,this._dragging)};
this.nDraggable=this._createResizeHandle(a.extend({x:e.x,y:e.y-h},g));
this.sDraggable=this._createResizeHandle(a.extend({x:e.x,y:e.y+h},g));
this.wDraggable=this._createResizeHandle(a.extend({x:e.x-h,y:e.y},g));
this.eDraggable=this._createResizeHandle(a.extend({x:e.x+h,y:e.y},g));
this.moveDraggable=this._createMoveHandle({x:e.x,y:e.y,dragging:Function.createDelegate(this,this._moving)});
},_dragging:function(f,e){e.set_cancel(true);
this.model.radius=this.model.center.distanceTo(this._getPosFromDraggingArgs(e));
this.drawEditModel();
},_moving:function(g,e){e.set_cancel(true);
var f=this._getNextSmallDelta(e);
this.model.translate(f);
this.drawEditModel();
}};
b.CircleTool.registerClass("Telerik.Web.UI.ImageEditor.DrawTools.CircleTool",b.BaseDrawTool);
})($telerik.$,Telerik.Web.UI.ImageEditor.DrawTools,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.DrawTools");
(function(a,b,c,d){b.LineTool=function(e,f){b.LineTool.initializeBase(this,[e,f]);
};
b.LineTool.prototype={defaultColor:"#000",defaultLineSize:1,setupDrawCanvas:function(){b.LineTool.callBaseMethod(this,"setupDrawCanvas");
var e=this.graphics?this.graphics.get_color():null;
var f=this.graphics?this.graphics.get_thickness():null;
this.graphics=this.options.coreFactory.getDrawGraphicsCore(this.drawableContext);
this.editGraphics=this.options.coreFactory.getEditGraphicsCore(this.drawableContext);
if(e){this.setColor(e);
}if(f){this.setLineSize(f);
}},start:function(e){this.startPos=e;
this.model=new c.Geometry.Line(this.startPos);
},draw:function(e){this.model.end=c.Geometry.Point.toPoint(e);
this.drawModel();
},end:function(e){this.draw(e);
this.showResizeHandles();
},drawModel:function(){this.editGraphics.clearCanvas();
var e=this.model;
this.graphics.drawLine(e.start.x,e.start.y,e.end.x,e.end.y);
},drawEditModel:function(){this.positionHandles();
this.drawModel();
},positionHandles:function(){var e=this.model;
this.positionResizeHandle(this.startDraggable,e.start);
this.positionResizeHandle(this.moveDraggable,e.getCenter());
this.positionResizeHandle(this.endDraggable,e.end);
},showResizeHandles:function(f){var h=this.model;
var i=this._zoomCanvasPos(h.start);
var g=this._zoomCanvasPos(h.end);
this.startDraggable=this._createResizeHandle({x:i.x,y:i.y,dragging:Function.createDelegate(this,this._dragStartHandler)});
var e=this.model.getCenter();
this.moveDraggable=this._createMoveHandle({x:e.x,y:e.y,dragging:Function.createDelegate(this,this._moving)});
this.endDraggable=this._createResizeHandle({x:g.x,y:g.y,dragging:Function.createDelegate(this,this._dragEndHandler)});
},_dragStartHandler:function(f,e){e.set_cancel(true);
this.model.start=this._getPosFromDraggingArgs(e);
this.drawEditModel();
},_moving:function(g,e){e.set_cancel(true);
var f=this._getNextSmallDelta(e);
this.model.translate(f);
this.drawEditModel();
},_dragEndHandler:function(f,e){e.set_cancel(true);
this.model.end=this._getPosFromDraggingArgs(e);
this.drawEditModel();
},setColor:function(e){this.graphics.set_color(e||this.defaultColor);
},setLineSize:function(e){this.graphics.set_thickness(e||this.defaultLineSize);
}};
b.LineTool.registerClass("Telerik.Web.UI.ImageEditor.DrawTools.LineTool",b.BaseDrawTool);
})($telerik.$,Telerik.Web.UI.ImageEditor.DrawTools,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.DrawTools");
(function(a,b,c){b.PencilTool=function(d,e){b.PencilTool.initializeBase(this,[d,e]);
};
b.PencilTool.prototype={defaultColor:"#000",setupDrawCanvas:function(){b.PencilTool.callBaseMethod(this,"setupDrawCanvas");
var d=this.graphics?this.graphics.get_color():null;
var e=this.graphics?this.graphics.get_thickness():null;
this.graphics=this.options.coreFactory.getDrawPathGraphicsCore(this.drawableContext);
if(d){this.setColor(d);
}if(e){this.setLineSize(e);
}},start:function(d){this.graphics.beginPath();
this.graphics.moveTo(d.x,d.y);
this.graphics.set_lineCap("round");
},draw:function(d){this.graphics.lineTo(d.x,d.y);
this.graphics.draw();
},end:function(d){this.draw(d);
},setColor:function(d){this.graphics.set_color(d||this.defaultColor);
},setLineSize:function(d){this.graphics.set_thickness(d||this.defaultLineSize);
}};
b.PencilTool.registerClass("Telerik.Web.UI.ImageEditor.DrawTools.PencilTool",b.BaseDrawTool);
})($telerik.$,Telerik.Web.UI.ImageEditor.DrawTools);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.DrawTools");
(function(a,b,c,d){b.RectangleTool=function(e,f){b.RectangleTool.initializeBase(this,[e,f]);
};
b.RectangleTool.prototype={defaultFillColor:"transparent",defaultColor:"#000",defaultLineSize:1,setupDrawCanvas:function(){b.RectangleTool.callBaseMethod(this,"setupDrawCanvas");
var f=this.graphics?this.graphics.get_fillColor():this.defaultFillColor;
var e=this.graphics?this.graphics.get_color():null;
var g=this.graphics?this.graphics.get_thickness():null;
this.graphics=this.options.coreFactory.getDrawGraphicsCore(this.drawableContext);
this.editGraphics=this.options.coreFactory.getEditGraphicsCore(this.drawableContext);
this.setFillColor(f);
if(e){this.setColor(e);
}if(g){this.setLineSize(g);
}},start:function(e){this.startPos=c.Geometry.Point.toPoint(e);
this.model=new c.Geometry.Rectangle(this.startPos);
},draw:function(e){this.model.end=c.Geometry.Point.toPoint(e);
this.drawModel();
},end:function(e){this.draw(e);
this.showResizeHandles();
},drawModel:function(){this.editGraphics.clearCanvas();
var e=this.model;
this.graphics.fillRect(e.start.x,e.start.y,e.end.x,e.end.y);
this.graphics.drawRect(e.start.x,e.start.y,e.end.x,e.end.y);
},drawEditModel:function(){this.positionHandles();
this.drawModel();
},positionHandles:function(){var e=this.model;
this.positionResizeHandle(this.nwDraggable,e.start);
this.positionResizeHandle(this.neDraggable,new c.Geometry.Point(e.end.x,e.start.y));
this.positionResizeHandle(this.swDraggable,new c.Geometry.Point(e.start.x,e.end.y));
this.positionResizeHandle(this.seDraggable,e.end);
this.positionResizeHandle(this.moveDraggable,e.getCenter());
},showResizeHandles:function(){var g=this.model;
var f=this.drawableContext.canvas.parentNode;
this.nwDraggable=this._createResizeHandle({x:g.start.x,y:g.start.y,container:f,dragging:Function.createDelegate(this,this._nwDragging)});
this.neDraggable=this._createResizeHandle({x:g.end.x,y:g.start.y,container:f,dragging:Function.createDelegate(this,this._neDragging)});
this.swDraggable=this._createResizeHandle({x:g.start.x,y:g.end.y,container:f,dragging:Function.createDelegate(this,this._swDragging)});
this.seDraggable=this._createResizeHandle({x:g.end.x,y:g.end.y,container:f,dragging:Function.createDelegate(this,this._seDragging)});
var e=this.model.getCenter();
this.moveDraggable=this._createMoveHandle({x:e.x,y:e.y,dragging:Function.createDelegate(this,this._moving)});
},setFillColor:function(e){this.graphics.set_fillColor(e||this.defaultFillColor);
},setColor:function(e){this.graphics.set_color(e||this.defaultColor);
},setLineSize:function(e){this.graphics.set_thickness(e||this.defaultLineSize);
},_nwDragging:function(f,e){e.set_cancel(true);
this.model.start=this._getPosFromDraggingArgs(e);
this.drawEditModel();
},_neDragging:function(f,e){e.set_cancel(true);
var g=this._getPosFromDraggingArgs(e);
this.model.end.x=g.x;
this.model.start.y=g.y;
this.drawEditModel();
},_swDragging:function(f,e){e.set_cancel(true);
var g=this._getPosFromDraggingArgs(e);
this.model.start.x=g.x;
this.model.end.y=g.y;
this.drawEditModel();
},_seDragging:function(f,e){e.set_cancel(true);
this.model.end=this._getPosFromDraggingArgs(e);
this.drawEditModel();
},_moving:function(g,e){e.set_cancel(true);
var f=this._getNextSmallDelta(e);
this.model.translate(f);
this.drawEditModel();
}};
b.RectangleTool.registerClass("Telerik.Web.UI.ImageEditor.DrawTools.RectangleTool",b.BaseDrawTool);
})($telerik.$,Telerik.Web.UI.ImageEditor.DrawTools,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.DrawTools");
(function(a,b,c){b.ToolsDom={createDrawableCanvas:function(f){var e=f.parentNode;
var d=f.cloneNode(true);
d.id+="_drawable";
d.className="__telerik_drawable_canvas";
d.style.position="absolute";
d.style.left=0;
d.style.top=0;
e.appendChild(d);
return d;
},createResizeHandle:function(g){var f=$telerik.$("<div>").css({width:g.width||23,height:g.height||23,background:"#aaa",border:g.border||"1px solid black",position:"absolute",opacity:0.4}).appendTo(g.container);
var e=this.getHandleHalfSize(f[0]);
f.css({top:g.y-e,left:g.x-e});
var d=new Telerik.Web.UI.Widgets.Draggable(f[0],{constraints:g.constraints||{minX:0,minY:0,maxX:g.canvas.width,maxY:g.canvas.height}});
if(typeof(g.dragging)=="function"){d.add_dragging(g.dragging);
}return d;
},removeDraggable:function(d){var e=d._element;
d.dispose();
this.remove(e);
},createOpacityBackground:function(e){var d=a("<div class='rieOpacityBackground'>");
var f=e.tagName?this.getCanvasSize(e):e;
return this.resizeOpacityBackground(d,f);
},resizeOpacityBackground:function(d,e){return a(d).css({width:e.width,height:e.height})[0];
},preventViewportOverflow:function(d){var e=d.style;
if($telerik.isTouchDevice){a(d).data("originalOverflow",e.overflow);
e.overflow="hidden";
}},restoreViewportOverflow:function(e){var d=a(e).data("originalOverflow");
if(d!==c){e.style.overflow=d;
}},getHandleHalfSize:function(e){var d=$telerik.getBorderWidth(e,Telerik.Web.BoxSide.Left);
var f=e.offsetWidth;
return Math.ceil((f+d)/2);
},getCanvasZoom:function(d){return{x:(parseInt(d.style.width,10)/d.width)||1,y:(parseInt(d.style.height,10)/d.height)||1};
},getCanvasSize:function(d){return{width:parseInt(d.style.width,10)||d.width,height:parseInt(d.style.height,10)||d.height};
},calculateOffset:function(d){return $telerik.getLocation(d);
},remove:function(d){if(!d.parentNode){return;
}d.parentNode.removeChild(d);
}};
})($telerik.$,Telerik.Web.UI.ImageEditor.DrawTools);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,b,c){b.IPixelFilter=function(d){};
b.IPixelFilter.prototype={execute:function(d){},get_name:function(){}};
b.IPixelFilter.registerInterface("Telerik.Web.UI.ImageEditor.Filters.IPixelFilter");
})($telerik.$,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,e){b.ConvolutionMatrixFilter=function(f){this._matrix=f.matrix;
this._offset=f.offset||0;
};
b.ConvolutionMatrixFilter.prototype={execute:function(v){var q=this._matrix;
var t=this._offset;
var g=d(q);
var x=v.data;
var A=v.width;
var p=q.length;
var r=Math.sqrt(p);
var u=parseInt(r/2,10);
var s=[];
var y=0;
var z;
var f;
for(var h=0;
h<x.length;
h++){if((h+1)%4===0){continue;
}s=[];
y=0;
for(var o=0;
o<p;
o++){z=parseInt(o/r,10);
f=o%r;
s.push(x[h+A*(z-u)*4+(f-u)*4]||x[h]);
}for(var l=0;
l<s.length;
l++){y+=s[l]*q[l];
}y/=g;
if(t){y+=t;
}v.data[h]=y;
}},get_name:function(){return"ConvolutionMatrixFilter";
}};
b.ConvolutionMatrixFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.ConvolutionMatrixFilter",null,b.IPixelFilter);
function d(f){var h=0,g=f.length;
while(g--){h+=f[g];
}return h;
}})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.BlurFilter=function(e){e=a.extend({matrix:[1,2,1,2,4,2,1,2,1]},e||{});
b.BlurFilter.initializeBase(this,[e]);
};
b.BlurFilter.prototype={get_name:function(){return"BlurFilter";
}};
b.BlurFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.BlurFilter",b.ConvolutionMatrixFilter,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.BrightnessContrastFilter=function(e){this.options=a.extend({brightness:0,contrast:1,initialData:null},e||{});
};
b.BrightnessContrastFilter.prototype={execute:function(e){var f=(this.options.initialData||e).data;
if($telerik.isOpera&&this.options.contrast>0.9){this.iterateSafe(f,e.data);
}else{this.iterate(f,e.data);
}},iterate:function(h,j){var f=this.options.contrast;
var e=this.options.brightness+127;
for(var g=0;
g<j.length;
g+=4){j[g]=(h[g]-127)*f+e;
j[g+1]=(h[g+1]-127)*f+e;
j[g+2]=(h[g+2]-127)*f+e;
}},iterateSafe:function(m,n){var h=this.options.contrast;
var f=this.options.brightness+127;
for(var k=0;
k<n.length;
k+=4){var l=(m[k]-127)*h+f;
var j=(m[k+1]-127)*h+f;
var e=(m[k+2]-127)*h+f;
n[k]=l>255?255:l<0?0:l;
n[k+1]=j>255?255:j<0?0:j;
n[k+2]=e>255?255:e<0?0:e;
}},get_name:function(){return"Brightness-Contrast";
}};
b.BrightnessContrastFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.BrightnessContrastFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.BrightnessFilter=function(e){this.options=a.extend({value:0,initialData:null},e||{});
};
b.BrightnessFilter.prototype={execute:function(g){var j=(this.options.initialData||g).data;
var h=g.data;
var e=this.options.value;
for(var f=0;
f<h.length;
f+=4){h[f]=j[f]+e;
h[f+1]=j[f+1]+e;
h[f+2]=j[f+2]+e;
}},get_name:function(){return String.format("Brightness {0}{1}",this.options.value<0?"-":"",this.options.value);
}};
b.BrightnessFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.BrightnessFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.ContrastFilter=function(e){this.options=a.extend({value:0,initialData:null},e||{});
};
b.ContrastFilter.prototype={execute:function(g){var j=(this.options.initialData||g).data;
var h=g.data;
var e=this.options.value;
for(var f=0;
f<h.length;
f+=4){h[f]=((j[f]-127)*e+127);
h[f+1]=((j[f+1]-127)*e+127);
h[f+2]=((j[f+2]-127)*e+127);
}},get_name:function(){return String.format("Contrast {0}{1}",this.options.value<0?"-":"",this.options.value);
}};
b.ContrastFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.ContrastFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,b,c){b.EmptyPixelFilter=function(d){};
b.EmptyPixelFilter.prototype={execute:function(d){},get_name:function(){return"EmptyFilter";
}};
b.EmptyPixelFilter.registerInterface("Telerik.Web.UI.ImageEditor.Filters.EmptyPixelFilter");
b.EmptyPixelFilter.Instance=new b.EmptyPixelFilter();
})($telerik.$,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.GreyscaleFilter=function(e){};
b.GreyscaleFilter.prototype={execute:function(j){var l,f,e;
var k=j.data;
var m;
for(var h=0;
h<k.length;
h+=4){l=k[h];
f=k[h+1];
e=k[h+2];
m=0.35*k[h]+0.5*k[h+1]+0.15*k[h+2];
k[h]=m;
k[h+1]=m;
k[h+2]=m;
}},get_name:function(){return"Greyscale";
}};
b.GreyscaleFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.GreyscaleFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,f){b.HueSaturationFilter=function(g){this.options=a.extend({hue:0,saturation:0,initialData:null},g||{});
};
b.HueSaturationFilter.prototype={execute:function(g){var h=(this.options.initialData||g).data;
this.iterate(h,g.data);
},iterate:function(w,x){var o=this.options.hue/60;
var k=o!=0&&o!=1;
var u=this.options.saturation/100;
for(var p=0;
p<x.length;
p+=4){var q=w[p],l=w[p+1],j=w[p+2];
if(q==l&&l==j){continue;
}var n=e(q,l,j);
var m=n[0];
var t=n[1];
var y=n[2];
if(k){m+=o;
m%=6;
}t+=u;
t=Math.min(1,Math.max(0,t));
d(m,t,y,x,p);
}},get_name:function(){return"HueSaturation";
}};
b.HueSaturationFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.HueSaturationFilter",null,b.IPixelFilter);
function e(q,l,i){var o=Math.max(q,l,i),p=Math.min(q,l,i);
var t=q/255;
var m=l/255;
var j=i/255;
var n,u,w=o;
var k=o-p;
u=o==0?0:k/o;
if(k==0){n=0;
}else{k/=255;
switch(o){case q:n=(m-j)/k+(l<i?6:0);
break;
case l:n=(j-t)/k+2;
break;
case i:n=(t-m)/k+4;
break;
}}return[n,u,w];
}function d(n,z,C,B,u){var y,m,k;
var o=Math.floor(n);
var l=n-o;
var w=C*(1-z);
var x=C*(1-l*z);
var A=C*(1-(1-l)*z);
switch(o%6){case 0:y=C,m=A,k=w;
break;
case 1:y=x,m=C,k=w;
break;
case 2:y=w,m=C,k=A;
break;
case 3:y=w,m=x,k=C;
break;
case 4:y=A,m=w,k=C;
break;
case 5:y=C,m=w,k=x;
break;
}B[u]=y;
B[u+1]=m;
B[u+2]=k;
}})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.InvertColorFilter=function(e){};
b.InvertColorFilter.prototype={execute:function(f){var g=f.data;
for(var e=0;
e<g.length;
e+=4){g[e]=255-g[e];
g[e+1]=255-g[e+1];
g[e+2]=255-g[e+2];
}},get_name:function(){return"InvertColor";
}};
b.InvertColorFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.InvertColorFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,b,c){b.OpacityFilter=function(d){this.options=a.extend({opacity:1,opacityImageMap:null},d||{});
};
b.OpacityFilter.prototype={execute:function(h){var d,e;
var f=this.options.opacity;
var g=this.options.opacityImageMap;
var k=h.data;
if(!!g){for(d=0,e=0;
d<k.length;
d+=4,e++){k[d+3]=parseInt(g[e]*f,10);
}}else{for(d=3;
d<k.length;
d+=4){k[d]*=f;
}}},get_name:function(){return String.format("Opacity {0}%",this.options.opacity*100);
}};
b.OpacityFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.OpacityFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.SepiaFilter=function(e){};
b.SepiaFilter.prototype={execute:function(j){var k=j.data;
for(var h=0;
h<k.length;
h+=4){var l=k[h];
var f=k[h+1];
var e=k[h+2];
k[h]=((l*0.393+f*0.769+e*0.189)*0.85)+5;
k[h+1]=((l*0.349+f*0.6860000000000001+e*0.168)*0.85)-15;
k[h+2]=((l*0.272+f*0.534+e*0.131)*0.85)-5;
}},get_name:function(){return"Sepia";
}};
b.SepiaFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.SepiaFilter",null,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Filters");
(function(a,c,b,d){b.SharpenFilter=function(e){e=a.extend({matrix:[0,-2,0,-2,12,-2,0,-2,0]},e||{});
b.SharpenFilter.initializeBase(this,[e]);
};
b.SharpenFilter.prototype={get_name:function(){return"SharpenFilter";
}};
b.SharpenFilter.registerClass("Telerik.Web.UI.ImageEditor.Filters.SharpenFilter",b.ConvolutionMatrixFilter,b.IPixelFilter);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.Filters);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Geometry");
(function(a,b,c){b.Circle=function(d,e){this.center=b.Point.toPoint(d);
this.radius=e||0;
};
b.Circle.prototype={getCenter:function(){return this.center;
},translate:function(d){this.center.translate(d);
}};
})($telerik.$,Telerik.Web.UI.ImageEditor.Geometry);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Geometry");
(function(a,b,c){b.Line=function(e,d){this.start=b.Point.toPoint(e);
this.end=b.Point.toPoint(d);
};
b.Line.prototype={distance:function(){return this.start.distanceTo(this.end);
},getCenter:function(){var f=this.start;
var d=this.end;
return new b.Point(f.x+Math.ceil((d.x-f.x)/2),f.y+Math.ceil((d.y-f.y)/2));
},translate:function(d){this.start.translate(d);
this.end.translate(d);
}};
})($telerik.$,Telerik.Web.UI.ImageEditor.Geometry);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Geometry");
(function(a,b,c){b.Point=function(d,e){this.x=d;
this.y=e;
};
b.Point.prototype={distanceTo:function(d){return b.Point.distance(this,d);
},translate:function(d){this.x+=d.x;
this.y+=d.y;
},reverse:function(d){this.x-=d.x;
this.y-=d.y;
}};
b.Point.toPoint=function(d){return d?new b.Point(d.x,d.y):new b.Point(0,0);
};
b.Point.distance=function(f,g){var d=Math.abs(f.x-g.x);
var e=Math.abs(f.y-g.y);
return Math.sqrt((d*d)+(e*e));
};
})($telerik.$,Telerik.Web.UI.ImageEditor.Geometry);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.Geometry");
(function(a,b,c){b.Rectangle=function(e,d){this.start=b.Point.toPoint(e);
this.end=b.Point.toPoint(d);
};
b.Rectangle.prototype={getCenter:function(){var f=this.start;
var d=this.end;
return new b.Point(f.x+Math.ceil((d.x-f.x)/2),f.y+Math.ceil((d.y-f.y)/2));
},translate:function(d){this.start.translate(d);
this.end.translate(d);
}};
})($telerik.$,Telerik.Web.UI.ImageEditor.Geometry);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.IDrawGraphicsCore=function(){};
b.IDrawGraphicsCore.prototype={drawLine:function(f,g,d,e){},drawRect:function(f,g,d,e){},fillRect:function(f,g,d,e){},clearRect:function(f,g,d,e){},drawCircle:function(d,e,f){},fillCircle:function(d,e,f){},set_color:function(d){},get_color:function(){},set_fillColor:function(d){},get_fillColor:function(){},set_thickness:function(d){},get_thickness:function(){},set_lineCap:function(d){},get_lineCap:function(){}};
b.IDrawGraphicsCore.registerInterface("Telerik.Web.UI.ImageEditor.GraphicsCore.IDrawGraphicsCore");
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.IDrawPathGraphicsCore=function(){};
b.IDrawPathGraphicsCore.prototype={beginPath:function(d,e){},moveTo:function(d,e){},lineTo:function(d,e){},draw:function(){},endPath:function(){},set_color:function(d){},get_color:function(){},set_fillColor:function(d){},get_fillColor:function(){},set_thickness:function(d){},get_thickness:function(){},set_lineCap:function(d){},get_lineCap:function(){}};
b.IDrawPathGraphicsCore.registerInterface("Telerik.Web.UI.ImageEditor.GraphicsCore.IDrawPathGraphicsCore");
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.IDrawTextGraphicsCore=function(){};
b.IDrawTextGraphicsCore.prototype={get_fontFamily:function(){},set_fontFamily:function(d){},get_fontStyle:function(){},set_fontStyle:function(d){},get_fontSize:function(){},set_fontSize:function(d){},get_baseline:function(){},set_baseline:function(d){},fillText:function(d,e,f){},drawText:function(d,e,f){},setColor:function(d){},setFillColor:function(d){}};
b.IDrawTextGraphicsCore.registerInterface("Telerik.Web.UI.ImageEditor.GraphicsCore.IDrawTextGraphicsCore");
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.IEditGraphicsCore=function(){};
b.IEditGraphicsCore.prototype={resizeCanvas:function(e,d){},rotate:function(d){},rotateCanvas:function(d){},flip:function(d){},cropCanvas:function(f,g,d,e){},insertImage:function(e,g,h,f,d){},clearCanvas:function(d){}};
b.IEditGraphicsCore.registerInterface("Telerik.Web.UI.ImageEditor.GraphicsCore.IEditGraphicsCore");
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,c,b,d){b.IGraphicsCoreFactory=function(){};
b.IGraphicsCoreFactory.prototype={getEditGraphicsCore:function(e){},getDrawGraphicsCore:function(e){},getDrawPathGraphicsCore:function(e){},getDrawTextGraphicsCore:function(e){}};
b.IGraphicsCoreFactory.registerInterface("Telerik.Web.UI.ImageEditor.GraphicsCore.IGraphicsCoreFactory");
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.CanvasDrawGraphicsCore=function(d){this.context=d;
};
b.CanvasDrawGraphicsCore.prototype={drawLine:function(g,h,e,f){var d=this.context;
d.beginPath();
d.moveTo(g,h);
d.lineTo(e,f);
d.closePath();
d.stroke();
},drawRect:function(g,h,e,f){var d=this._normalizeRectDims(g,h,e,f);
this.context.strokeRect(d.x,d.y,d.width,d.height);
},fillRect:function(g,h,e,f){var d=this._normalizeRectDims(g,h,e,f);
this.context.fillRect(d.x,d.y,d.width,d.height);
},clearRect:function(g,h,e,f){var d=this._normalizeRectDims(g,h,e,f);
this.context.clearRect(d.x,d.y,d.width,d.height);
},drawCircle:function(d,e,g){var f=this.context;
f.beginPath();
f.arc(d,e,g,0,360,false);
f.stroke();
f.closePath();
},fillCircle:function(d,e,g){var f=this.context;
f.beginPath();
f.arc(d,e,g,0,360,false);
f.stroke();
f.fill();
f.closePath();
},set_color:function(d){this.context.strokeStyle=d;
},get_color:function(){return this.context.strokeStyle;
},set_fillColor:function(d){this.context.fillStyle=d;
},get_fillColor:function(){return this.context.fillStyle;
},set_thickness:function(d){this.context.lineWidth=d;
},get_thickness:function(){return this.context.lineWidth;
},set_lineCap:function(d){this.context.lineCap=d;
},get_lineCap:function(){return this.context.lineCap;
},_normalizeRectDims:function(f,g,d,e){if(f>d){var h=d;
d=f;
f=h;
}if(g>e){var i=e;
e=g;
g=i;
}return{x:f,y:g,width:d-f,height:e-g};
}};
b.CanvasDrawGraphicsCore.registerClass("Telerik.Web.UI.ImageEditor.GraphicsCore.CanvasDrawGraphicsCore",null,b.IDrawGraphicsCore);
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.CanvasDrawPathGraphicsCore=function(d){this.context=d;
};
b.CanvasDrawPathGraphicsCore.prototype={beginPath:function(d,e){this.context.beginPath();
},moveTo:function(d,e){this.context.moveTo(d,e);
},lineTo:function(d,e){this.context.lineTo(d,e);
},draw:function(){this.context.stroke();
},endPath:function(){this.context.closePath();
},set_color:function(d){this.context.strokeStyle=d;
},get_color:function(){return this.context.strokeStyle;
},set_fillColor:function(d){this.context.fillStyle=d;
},get_fillColor:function(){return this.context.fillStyle;
},set_thickness:function(d){this.context.lineWidth=d;
},get_thickness:function(){return this.context.lineWidth;
},set_lineCap:function(d){this.context.lineCap=d;
},get_lineCap:function(){return this.context.lineCap;
}};
b.CanvasDrawPathGraphicsCore.registerInterface("Telerik.Web.UI.ImageEditor.GraphicsCore.CanvasDrawPathGraphicsCore");
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,b,c){b.CanvasDrawTextGraphicsCore=function(d){this.context=d;
this._collectDefaultFont();
};
b.CanvasDrawTextGraphicsCore.prototype={fillText:function(g,j,k,f){this.context.font=this._joinFontValues();
this.context.textBaseline=this.get_baseline();
var h=g.split("\n");
for(var e=0;
e<h.length;
e++){var d=k+e*f;
this.context.fillText(h[e],j,d);
}},drawText:function(d,e,f){this.context.font=this._joinFontValues();
this.context.textBaseline=this.get_baseline();
this.context.strokeText(d,e,f);
},setColor:function(d){this.context.strokeStyle=d;
},setFillColor:function(d){this.context.fillStyle=d;
},_joinFontValues:function(){return[this.get_fontStyle(),this.get_fontSize(),this.get_fontFamily()].join(" ").trim();
},_collectDefaultFont:function(){var d=["fontStyle","fontSize","fontFamily"];
var e=this.context.font.split(" ");
while(e.length){this["set_"+d.pop()](e.pop());
}}};
a.registerControlProperties(b.CanvasDrawTextGraphicsCore,{fontFamily:"",fontStyle:"",fontSize:"",baseline:""});
b.CanvasDrawTextGraphicsCore.registerClass("Telerik.Web.UI.ImageEditor.GraphicsCore.CanvasDrawTextGraphicsCore",null,b.IDrawTextGraphicsCore);
})($telerik.$,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,c,b,d){b.CanvasEditGraphicsCore=function(e){this.context=e;
};
b.CanvasEditGraphicsCore.prototype={resizeCanvas:function(h,f){var e=this.cloneCanvas();
var i=h/this.context.canvas.width;
var g=f/this.context.canvas.height;
this.setCanvasSize(h,f);
this.context.save();
this.context.scale(i,g);
this._drawNewCanvas(e.canvas);
this.context.restore();
},rotate:function(e){var f=this.cloneCanvas();
this._crossbrowserRotate(e,f.canvas);
},rotateCanvas:function(g){var e=g==c.Rotation.Rotate90?90:g==c.Rotation.Rotate180?180:g==c.Rotation.Rotate270?270:0;
if($telerik.isFirefox||$telerik.isIE){for(var f=e/90;
f>0;
f--){this._rotateCanvas(90);
}}else{this._rotateCanvas(e);
}},flip:function(e){this.context.save();
var f=this.cloneCanvas();
if(e==c.FlipDirection.Horizontal){this.context.setTransform(-1,0,0,1,this.context.canvas.width,0);
}if(e==c.FlipDirection.Vertical){this.context.setTransform(1,0,0,-1,0,this.context.canvas.height);
}if(e==c.FlipDirection.Both){this.context.setTransform(-1,0,0,-1,this.context.canvas.width,this.context.canvas.height);
}this._drawNewCanvas(f.canvas);
this.context.restore();
},cropCanvas:function(i,j,f,g){if(i>f){return this.cropCanvas(f,j,i,g);
}if(j>g){return this.cropCanvas(i,g,f,j);
}var k=f-i;
var h=g-j;
var e=this.cloneCanvas();
this.setCanvasSize(k,h);
this.context.drawImage(e.canvas,-i,-j);
},insertImage:function(f,h,i,g,e){if(g&&!isNaN(g)&&e&&!isNaN(e)){this.context.drawImage(f,h,i,g,e);
}else{this.context.drawImage(f,h,i);
}},clearCanvas:function(f){var e=this.context.canvas;
if(f){var g=this.context.fillStyle;
this.context.fillStyle=f;
this.context.fillRect(0,0,e.width,e.height);
this.context.fillStyle=g;
}else{this.context.clearRect(0,0,e.width+1,e.height+1);
}},_rotateCanvas:function(e){var f=this.cloneCanvas();
if(e==90||e==270){this.setCanvasSize(this.context.canvas.height,this.context.canvas.width);
}this._rotate(e,f.canvas);
},_crossbrowserRotate:function(f,g){if($telerik.isFirefox||$telerik.isIE){var e=f;
for(;
e>90;
e-=90,g=this.cloneCanvas().canvas){this._rotate(90,g);
}this._rotate(e,g);
}else{this._rotate(f,g);
}},_rotate:function(e,g){var i=this.context.canvas.width/2;
var h=this.context.canvas.height/2;
var f=e%360;
this.context.save();
this.context.translate(i,h);
this.context.rotate(this.deg2rad(f));
this.context.translate(-(g.width/2),-(g.height/2));
this._drawNewCanvas(g);
this.context.restore();
},_drawNewCanvas:function(e){this.clearCanvas();
this.context.drawImage(e,0,0);
},degRad:180/Math.PI,radDeg:Math.PI/180,rad2deg:function(e){return e*this.degRad;
},deg2rad:function(e){return e*this.radDeg;
},cloneCanvas:function(){var e=document.createElement("canvas");
e.width=this.context.canvas.width;
e.height=this.context.canvas.height;
var f=e.getContext("2d");
f.drawImage(this.context.canvas,0,0);
return f;
},setCanvasSize:function(f,e){this.context.canvas.width=f;
this.context.canvas.height=e;
}};
b.CanvasEditGraphicsCore.registerClass("Telerik.Web.UI.ImageEditor.GraphicsCore.CanvasEditGraphicsCore",null,b.IEditGraphicsCore);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor.GraphicsCore");
(function(a,c,b,d){b.CanvasGraphicsCoreFactory=function(){};
b.CanvasGraphicsCoreFactory.prototype={getEditGraphicsCore:function(e){return new b.CanvasEditGraphicsCore(e);
},getDrawGraphicsCore:function(e){return new b.CanvasDrawGraphicsCore(e);
},getDrawPathGraphicsCore:function(e){return new b.CanvasDrawPathGraphicsCore(e);
},getDrawTextGraphicsCore:function(e){return new b.CanvasDrawTextGraphicsCore(e);
}};
b.CanvasGraphicsCoreFactory.registerClass("Telerik.Web.UI.ImageEditor.GraphicsCore.CanvasGraphicsCoreFactory",null,b.IDrawGraphicsCore);
})($telerik.$,Telerik.Web.UI.ImageEditor,Telerik.Web.UI.ImageEditor.GraphicsCore);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.ScrollToZoom=function(d,e){this.element=d;
this.setOptions(e);
this.currentZoomLevel=100;
this._scroller=new c.Widgets.MouseScroll(d,Function.createDelegate(this,this.mouseScrollHandler),{timeToAccumulate:50,throttleTime:10,specialKey:this.options.specialKey});
};
b.ScrollToZoom.prototype={mouseScrollHandler:function(f,d){if(this.options.specialKey&&!f[this.options.specialKey]){return false;
}var e=this.getDocPos(f);
var g=this.documentToElementPos(e,this.element);
this.handleZoomScroll(g,d);
},handleZoomScroll:function(g,f){f=this.calculateSpeed(f);
this.currentZoomLevel=this.options.getZoomLevel();
var i=this.calculateNewZoomLevel(f);
var e=this.elementToContentPos(g);
var j=i/this.currentZoomLevel;
var h={x:e.x*j-g.x,y:e.y*j-g.y};
var d=a(this.element);
d.scrollLeft(h.x);
d.scrollTop(h.y);
this.options.onZoom(i);
},documentToElementPos:function(d,e){var f=a(e).offset();
return{x:d.x-f.left,y:d.y-f.top};
},elementToContentPos:function(d){var e=this.getElementScroll(this.element);
return{x:(d.x+e.x),y:(d.y+e.y)};
},setOptions:function(d){this.options=a.extend({getZoomLevel:Function.emptyFunction,maxZoomLevel:400,minZoomLevel:25,onZoom:Function.emptyFunction,speed:10,specialKey:"altKey"},d||{});
},calculateNewZoomLevel:function(d){var e=parseInt(this.options.getZoomLevel(),10);
return Math.min(Math.max(e+d,this.options.minZoomLevel),this.options.maxZoomLevel);
},calculateSpeed:function(d){return this.getDirection(d)*this.options.speed;
},getDirection:function(d){return this._scroller._normalizeDelta(d);
},getDocPos:function(d){return{x:d.clientX,y:d.clientY};
},getElementScroll:function(e){var d=a(e);
return{x:d.scrollLeft(),y:d.scrollTop()};
},dispose:function(){delete this.element;
}};
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.SwapImageOperation=function(d,f,e){b.SwapImageOperation.initializeBase(this);
this._editableImage=d;
this._image=d?d.getImage():null;
this.set_src(f);
this._canUndo=false;
this._originalSrc=this._image.src;
this._editableImageSize={width:d.get_width(),height:d.get_height()};
var g=d.get_zoomLevel()/100;
this._imageSize=e||{width:d.get_width()*g,height:d.get_height()*g};
this._originalWidth=d.get_width();
this._originalImageWidth=this._image.width;
this._originalHeight=d.get_height();
this._originalImageHeight=this._image.height;
};
b.SwapImageOperation.prototype={execute:function(){this._apply(this.get_src());
this._canUndo=true;
},_apply:function(d){this._editableImage.set_imageKey(this.getKeyFromSrc(d));
this._image.src=d;
this._resetCSSPersistZoom();
if(this._imageSize){var e=this._editableImage.get_zoomLevel()/100;
this._editableImage._applySize(this._editableImageSize.width*e,this._editableImageSize.height*e);
this._editableImage._setInternalSize(this._editableImageSize.width,this._editableImageSize.height);
}},undo:function(){if(this.canUndo()){this._apply(this._originalSrc);
this._editableImage._setInternalSize(this._originalWidth,this._originalHeight);
this._editableImage._applySize(this._originalImageWidth,this._originalImageHeight);
this._editableImage._updateCssTransform(this._editableImage._flipH,this._editableImage._flipV,this._editableImage.get_rotationAngle());
this._canUndo=false;
}},toString:function(){return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),src:this.get_src(),key:this.getKeyFromSrc(this.get_src())});
},fromString:function(e){var d=Sys.Serialization.JavaScriptSerializer.deserialize(e);
this.fromData(d);
},fromData:function(d){if(d.name==this.get_name()){this.set_src(d.src);
}},canUndo:function(){return this._canUndo;
},get_name:function(){return"SwapImage";
},get_text:function(){return this.get_name();
},getIsClientOperation:function(){return false;
},get_image:function(){return this._image[0];
},getKeyFromSrc:function(e){var d=e.match(/&key=([^&]+)&?/i);
if(d){return d[1];
}},dispose:function(){delete this._canUndo;
delete this._image;
},_resetCSSPersistZoom:function(){var d=this._editableImage.get_zoomLevel();
this._editableImage._resetCSS();
this._editableImage._zoomLevel=d;
}};
a.registerControlProperties(b.SwapImageOperation,{src:null,key:null});
b.SwapImageOperation.registerClass("Telerik.Web.UI.ImageEditor.SwapImageOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.AddTextOperation=function(d,f,e){b.AddTextOperation.initializeBase(this,[d,f,e]);
};
b.AddTextOperation.prototype={get_name:function(){return"AddText";
},get_text:function(){return"AddText";
},toString:function(){return b.CropOperation.callBaseMethod(this,"toString");
}};
b.AddTextOperation.registerClass("Telerik.Web.UI.ImageEditor.AddTextOperation",b.SwapImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.CropOperation=function(e,f,d){b.CropOperation.initializeBase(this,[e,f]);
this._bounds=d;
};
b.CropOperation.prototype={execute:function(){b.CropOperation.callBaseMethod(this,"execute");
this._finishRedo();
},_finishRedo:function(){var d=this._bounds;
this._editableImage._setInternalSize(d.width,d.height);
var e=this._editableImage.get_zoomLevel()/100;
this._editableImage._applySize(d.width*e,d.height*e);
},undo:function(){if(this.canUndo()){b.CropOperation.callBaseMethod(this,"undo");
this._isRedo=true;
}},get_name:function(){return"Crop";
},get_text:function(){return"Crop";
},toString:function(){return b.CropOperation.callBaseMethod(this,"toString");
}};
b.CropOperation.registerClass("Telerik.Web.UI.ImageEditor.CropOperation",b.SwapImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.FlipOperation=function(e,f,d){b.FlipOperation.initializeBase(this);
this._editableImage=e;
this._image=e?e.getImage():null;
this.set_flipDirection(f);
this._canUndo=false;
this._prevFlipDirection=b.FlipDirection.None;
this._clearPrevFlipDirection=d;
};
b.FlipOperation.prototype={execute:function(){this.flip(this.get_flipDirection());
this._canUndo=true;
},undo:function(){if(this.canUndo()){this._flipV=false;
this._flipH=false;
this.flip(this.get_originalFlipDirection());
this._canUndo=false;
}},toString:function(d){var e=d?d._getAbsFlipDirection():this.get_flipDirection();
return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),direction:e,index:this.get_index()});
},fromString:function(d){},fromData:function(d){},canUndo:function(){return this._canUndo;
},get_name:function(){return"Flip";
},get_text:function(){return this.get_name()+" "+this.get_flipDirectionText();
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_editableImage:function(){return this._editableImage;
},get_flipDirectionText:function(){var d="";
switch(this.get_flipDirection()){case b.FlipDirection.None:d="None";
break;
case b.FlipDirection.Horizontal:d="Horizontal";
break;
case b.FlipDirection.Vertical:d="Vertical";
break;
default:d="Both";
break;
}return d;
},get_flipDirection:function(){return this._flipDirection;
},set_flipDirection:function(d){this._flipDirection=typeof(d)=="undefined"||d==null?b.FlipDirection.None:d;
},get_originalFlipDirection:function(){return this._prevFlipDirection;
},flip:function(d){this._prevFlipDirection=this.get_editableImage().get_flipDirection();
this._updateImage(d);
},_updateImage:function(d){this.get_editableImage()._setFlipDirection(d,this._clearPrevFlipDirection);
},_getFlipDirection:function(d,e){return(d&&e?b.FlipDirection.Both:(d?b.FlipDirection.Horizontal:(e?b.FlipDirection.Vertical:b.FlipDirection.None)));
}};
b.FlipOperation.registerClass("Telerik.Web.UI.ImageEditor.FlipOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.InsertImageOperation=function(e,f,d){b.InsertImageOperation.initializeBase(this,[e,f]);
};
b.InsertImageOperation.prototype={get_name:function(){return"InsertImage";
},get_text:function(){return"Image Inserted";
},toString:function(){return b.InsertImageOperation.callBaseMethod(this,"toString");
}};
b.InsertImageOperation.registerClass("Telerik.Web.UI.ImageEditor.InsertImageOperation",b.SwapImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.OpacityOperation=function(d,e,f){b.OpacityOperation.initializeBase(this);
this._editableImage=d;
this._image=d?d.getCanvas():null;
this._canUndo=false;
this.set_currentOpacity(e);
this._prevOpacity=f;
};
b.OpacityOperation.prototype={execute:function(){this._updateImage(this.get_currentOpacity(),true);
this._canUndo=true;
},undo:function(){if(this.canUndo()){this._updateImage(this.get_originalOpacity(),false);
this._canUndo=false;
}},toString:function(){return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),value:this.get_currentOpacity(),index:this.get_index()});
},fromString:function(e){var d=Sys.Serialization.JavaScriptSerializer.deserialize(e);
this.fromData(d);
},fromData:function(d){if(d.name==this.get_name()){this._opacity=d.value;
}},canUndo:function(){return this._canUndo;
},get_name:function(){return"Opacity";
},get_text:function(){return this.get_name()+" "+this.get_currentOpacity()+"%";
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_currentOpacity:function(){return this._opacity;
},set_currentOpacity:function(d){this._opacity=d;
},get_originalOpacity:function(){return this._prevOpacity;
},_updateImage:function(e,d){if(d&&(typeof(this._prevOpacity)=="undefined")||this._prevOpacity==null){this._prevOpacity=this._editableImage.get_opacity();
}this._editableImage._setOpacity(e);
}};
b.OpacityOperation.registerClass("Telerik.Web.UI.ImageEditor.OpacityOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.ResizeOperation=function(d,f,e){b.ResizeOperation.initializeBase(this);
this._editableImage=d;
this._image=d?d.getImage():null;
this.set_size(f,e);
this._canUndo=false;
this._originalWidth=null;
this._originalHeight=null;
};
b.ResizeOperation.prototype={execute:function(){this.resize(this.get_width(),this.get_height());
this._canUndo=true;
},undo:function(){if(this.canUndo()){this.resize(this.get_originalWidth(),this.get_originalHeight());
this._canUndo=false;
}},toString:function(d){var f=d?d._getWidth():this.get_width();
var e=d?d._getHeight():this.get_height();
return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),width:f,height:e,index:this.get_index()});
},fromString:function(d){},fromData:function(d){},canUndo:function(){return this._canUndo;
},get_name:function(){return"Resize";
},get_text:function(){return this.get_name()+" "+this.get_width()+"x"+this.get_height()+"px";
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_editableImage:function(){return this._editableImage;
},get_width:function(){return this._width;
},get_originalWidth:function(){return this._originalWidth;
},get_height:function(){return this._height;
},get_originalHeight:function(){return this._originalHeight;
},set_size:function(e,d){e=this.parseSize(e);
this._width=isNaN(e)?"":e;
d=this.parseSize(d);
this._height=isNaN(d)?"":d;
},resize:function(e,d){this._updateImage(e,d);
},_updateImage:function(f,e){var d=this.get_editableImage();
this._originalWidth=d.get_width();
this._originalHeight=d.get_height();
if(f==""){f=this._originalWidth;
}if(e==""){e=this._originalHeight;
}if(f!=this._originalWidth||e!=this._originalHeight){d._setSize(f,e);
}},parseSize:function(d){return parseInt(d,10);
}};
b.ResizeOperation.registerClass("Telerik.Web.UI.ImageEditor.ResizeOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,c,b){b.RotateOperation=function(e,f,d){b.RotateOperation.initializeBase(this);
this._editableImage=e;
this._image=e?e.getImage():null;
this.set_rotation(f,d);
this._canUndo=false;
};
b.RotateOperation.prototype={execute:function(){this.rotate(this.get_rotationAngle());
this._canUndo=true;
},undo:function(){if(this.canUndo()){this.rotate(this.get_originalRotationAngle());
this._canUndo=false;
}},toString:function(){return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),degree:this.get_rotationAngle(),index:this.get_index()});
},fromString:function(d){},fromData:function(d){},canUndo:function(){return this._canUndo;
},get_name:function(){return"Rotate";
},get_text:function(){return this.get_name()+" "+this.get_rotationAngle()+" deg";
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_editableImage:function(){return this._editableImage;
},get_rotationAngle:function(){return this._rotationAngle;
},get_originalRotationAngle:function(){return this._prevRotationAngle;
},get_rotation:function(){return this._rotation;
},set_rotation:function(e,d){if(e!=null&&typeof(e)!="undefined"){this._rotation=e;
this._rotationAngle=this._getAngleFromRotation(e);
return;
}else{if(d!=null&&typeof(d)!="undefined"){if(d!=0&&d!=90&&d!=180&&d!=270){d=0;
}this._rotationAngle=d;
return;
}}this._rotationAngle=0;
this._rotation=null;
},rotate:function(d){this._prevRotationAngle=this.get_editableImage().get_rotationAngle();
this._updateImage(d);
},_updateImage:function(d){this.get_editableImage()._setRotationAngle(d);
},_getAngleFromRotation:function(e){var d;
switch(e){case b.Rotation.Rotate90:d=90;
break;
case b.Rotation.Rotate180:d=180;
break;
case b.Rotation.Rotate270:d=270;
break;
default:d=0;
}return d;
}};
b.RotateOperation.registerClass("Telerik.Web.UI.ImageEditor.RotateOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(a,b){b.IToolWidget=function(){};
b.IToolWidget.prototype={updateUI:function(){},get_name:function(){},onOpen:function(){},onClose:function(){},dispose:function(){}};
b.IToolWidget.registerInterface("Telerik.Web.UI.ImageEditor.IToolWidget");
b.ToolWidget=function(c){this._imageEditor=c;
this._parentId="";
this.initialize();
};
b.ToolWidget.prototype={initialize:function(){},dispose:function(){window[this._imageEditor.get_id()+"_dockTitle"]=null;
},onOpen:function(){},onClose:function(){},close:function(){this.get_imageEditor().closeToolsPanel();
},get_imageEditor:function(){return this._imageEditor;
},set_imageEditor:function(c){this._imageEditor=c;
},get_image:function(){return this.get_imageEditor().getImage();
},get_parentId:function(){if(!this._parentId){this._parentId=this.get_imageEditor().get_id()+"_ToolsPanel_C_";
}return this._parentId;
},get_text:function(){var c=window[this._imageEditor.get_id()+"_dockTitle"];
return c?c:this.get_name();
},incrementValue:function(f,d,c){var e=parseInt(f.value,10);
if(c!=null&&typeof(c)!="undefined"){e=e+c;
}else{e++;
}if(e<=d){f.value=e;
return true;
}return false;
},decrementValue:function(f,d,c){var e=parseInt(f.value,10);
if(c!=null&&typeof(c)!="undefined"){e=e-c;
}else{e--;
}if(e>=d){f.value=e;
return true;
}return false;
},checkValue:function(g,e,d,c){var f=parseInt(g.value,10);
if(!isNaN(f)&&f<=d&&f>=e){if(!c){g.value=f;
}return f;
}return false;
},restrictInputValue:function(c,d){var e=parseInt(c.value,10)||d.min;
if(d){e=Math.min(d.max,Math.max(d.min,e));
}c.value=e;
return e;
},isNumeric:function(c){return((c>95&&c<107)||(c>47&&c<59));
},isBackspaceOrDelete:function(c){return(c==8||c==127);
},_getControlFromParent:function(c){return $get(this._getChildId(c));
},_findControlFromParent:function(c){return $find(this._getChildId(c));
},_getChildId:function(c){return this.get_parentId()+c;
},_getInputValueHandler:function(c,f){var e=c.keyCode;
var d=c.target;
if(e==27||e==38||e==40){$telerik.cancelRawEvent(c.rawEvent);
}var h=this._getInputValueByKeyCode(d,e);
var g=this._restrictInputNewValue(d,h,f);
return isNaN(g)?parseInt(d.value,10)||0:g;
},_getInputValueByKeyCode:function(c,d){switch(d){case 38:return this._incrementInputValue(c);
case 40:return this._decrementInputValue(c);
case 27:return;
default:if(this.isNumeric(d)||this.isBackspaceOrDelete(d)){return parseInt(c.value,10);
}}},_incrementInputValue:function(c,d){return parseInt(c.value,10)+1;
},_decrementInputValue:function(c,d){return parseInt(c.value,10)-1;
},_restrictInputNewValue:function(c,e,d){if(d&&(e<d.min||e>d.max)){e=Math.min(d.max,Math.max(d.min,e));
c.value=e;
}return e;
}};
b.ToolWidget.registerClass("Telerik.Web.UI.ImageEditor.ToolWidget",null);
})($telerik.$,Telerik.Web.UI.ImageEditor);
